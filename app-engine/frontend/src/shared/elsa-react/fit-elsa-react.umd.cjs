(function(me,ee){typeof exports=="object"&&typeof module<"u"?ee(exports,require("@fit-elsa/elsa-core"),require("react"),require("react-dom"),require("antd"),require("axios")):typeof define=="function"&&define.amd?define(["exports","@fit-elsa/elsa-core","react","react-dom","antd","axios"],ee):(me=typeof globalThis<"u"?globalThis:me||self,ee(me["elsa-react"]={},me.elsaCore,me.react,me.ReactDOM,me.antd,me.axios))})(this,function(me,ee,k,xn,h,jn){"use strict";function Cn(e){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const t in e)if(t!=="default"){const o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,o.get?o:{enumerable:!0,get:()=>e[t]})}}return n.default=e,Object.freeze(n)}const w=Cn(k),wn=(e,n,t,o)=>{const i=ee.page(e,n,t,o);i.type="jadeFlowPage",i.serializedFields.batchAdd("x","y","scaleX","scaleY"),i.namespace="jadeFlow",i.backgroundGrid="point",i.backgroundGridSize=16,i.backgroundGridMargin=16,i.backColor="#fbfbfc",i.focusBackColor="#fbfbfc",i.gridColor="#e1e1e3",i.disableContextMenu=!0,i.moveAble=!0,i.observableStore=En();const s=i.onLoaded;i.onLoaded=()=>{s.apply(i),i.shapes.forEach(c=>c.onPageLoaded&&c.onPageLoaded())},i.registerObservable=(c,p,g,y,f)=>{i.observableStore.add(c,p,g,y,f)},i.removeObservable=(c,p=null)=>{i.observableStore.remove(c,p)},i.getObservableList=c=>i.observableStore.getObservableList(c),i.observeTo=(c,p,g)=>{i.observableStore.addObserver(c,p,g)},i.stopObserving=(c,p,g)=>{i.observableStore.removeObserver(c,p,g)},i.getObservable=(c,p)=>i.observableStore.getObservable(c,p);const l=i.clear;i.clear=()=>{l.apply(i),i.observableStore.clear()};const r=i.createNew;i.createNew=(c,p,g,y,f,v,m)=>{d.filter(C=>C.type==="before").forEach(C=>C.handle(i,c,p,g,f,v));const b=r.apply(i,[c,p,g,y,f,v,m]);return d.filter(C=>C.type==="after").forEach(C=>C.handle(i,b)),b};const d=[];return i.registerShapeCreationHandler=c=>{d.push(c)},i.getMenuScript=()=>[],i.registerShapeCreationHandler({type:"before",handle:(c,p)=>{if((p==="startNodeStart"||p==="endNodeEnd")&&c.shapes.find(g=>g.type===p))throw new Error("最多只能有一个开始或结束节点.")}}),i},En=()=>{const e={};e.store=new Map,e.add=(t,o,i,s,l)=>{const r=n(e.store,t,()=>new Map),d=n(r,o,()=>({observableId:o,value:null,type:null,observers:[],parentId:l}));d.value=i,d.type=s,d.parentId=l},e.remove=(t,o=null)=>{if(o){const i=e.store.get(t);i&&o&&(i.delete(o),i.size===0&&e.store.delete(t))}else e.store.delete(t)},e.addObserver=(t,o,i)=>{const s=n(e.store,t,()=>new Map);n(s,o,()=>({observableId:o,value:null,observers:[]})).observers.push(i)},e.removeObserver=(t,o,i)=>{const s=e.store.get(t);if(!s)return;const l=s.get(o);if(!l)return;const r=l.observers.findIndex(d=>d===i);r!==-1&&l.observers.splice(r,1)};const n=(t,o,i)=>{let s=t.get(o);return s||(s=i(),t.set(o,s)),s};return e.getObservableList=t=>{const o=e.store.get(t);return o?Array.from(o.values()).map(i=>({nodeId:t,observableId:i.observableId,parentId:i.parentId,value:i.value,type:i.type})):[]},e.getObservable=(t,o)=>{const i=e.store.get(t);return i?i.get(o):null},e.clear=()=>{e.store.clear()},e};let Sn=(e,n,t,o,i,s,l)=>{let r=ee.line(e,n,t,o,i,s,l);r.type="jadeEvent",r.borderWidth=1,r.beginArrow=!1,r.endArrow=!0,r.lineMode=ee.LINEMODE.AUTO_CURVE,r.borderColor="#B1B1B7",r.mouseInBorderColor="#B1B1B7",r.allowSwitchLineMode=!1;const d=r.getIndex;r.getIndex=()=>{let g=d.call(r);return r.index=g-200,r.index},r.onPageLoaded=()=>{r.toShape&&(r.currentToShape=r.page.getShapeById(r.toShape))};const c=r.initConnectors;r.initConnectors=()=>{c.call(r),r.fromConnector.visible=!1,r.toConnector.direction.color="transparent",r.toConnector.strokeStyle="transparent";const g=r.toConnector.release;r.toConnector.release=f=>{const v=r.fromShape,m=r.fromShapeConnector;function b(){return r.page.shapes.filter(C=>C.type==="jadeEvent").count(C=>C.fromShape===v&&C.toShape===r.connectingShape.id&&C.fromShapeConnector===m&&C.toShapeConnector===r.connectingShape.linkingConnector)>1}if(r.isFocused=!1,g.call(r.toConnector,f),b())r.remove();else if(r.toShape==="")r.currentToShape&&r.currentToShape.offConnect(),r.remove();else{const C=r.getToShape();C.onConnect(),r.currentToShape=C}},r.toConnector.radius=4,r.toConnector.moving=(f,v,m,b)=>{let C=r.page.disableReact;r.page.disableReact=!0;const I=r.from();r.resize(m-I.x,b-I.y),r.shapeLinking(r.to().x,r.to().y),r.toMoving=!0,r.page.disableReact=C,r.toConnector.afterMoving()};const y=r.toConnector.afterMoving;r.toConnector.afterMoving=()=>{r.connectingShape&&r.connectingShape.linkingConnector?(r.definedToConnector=r.connectingShape.linkingConnector.direction.key,r.toShape=r.connectingShape.id):(r.definedToConnector="",r.toShape=""),y.apply(r.toConnector)}};const p=r.remove;return r.remove=g=>{const y=r.getToShape(),f=p.apply(r,[g]);return y&&y.offConnect(),f},r.connect=(g,y,f,v)=>{r.fromShape=g,r.definedFromConnector=y,r.toShape=f,r.definedToConnector=v,r.follow()},r.validateLinking=(g,y,f)=>ee.isPointInRect({x:y,y:f},g.getBound()),r.shapeLinking=(g,y)=>{if(!r.linkAble)return;const f=r.page.find(g,y,v=>v.allowLink&&r.validateLinking(v,g,y));r.shapeDelinking(f),r.connectingShape=f,r.connectingShape&&r.connectingShape!==r.page&&(r.connectingShape.linking=!0,r.connectingShape.linkingConnector=r.connectingShape.getClosestConnector(g,y,v=>v.connectable&&v.allowToLink),r.connectingShape.render())},r.needGetToConnector=()=>r.getToShape(),r};function $t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ut={exports:{}},Ae={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vt;function Pn(){if(Vt)return Ae;Vt=1;var e=k,n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(r,d,c){var p,g={},y=null,f=null;c!==void 0&&(y=""+c),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(f=d.ref);for(p in d)o.call(d,p)&&!s.hasOwnProperty(p)&&(g[p]=d[p]);if(r&&r.defaultProps)for(p in d=r.defaultProps,d)g[p]===void 0&&(g[p]=d[p]);return{$$typeof:n,type:r,key:y,ref:f,props:g,_owner:i.current}}return Ae.Fragment=t,Ae.jsx=l,Ae.jsxs=l,Ae}var De={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qt;function On(){return qt||(qt=1,process.env.NODE_ENV!=="production"&&function(){var e=k,n=Symbol.for("react.element"),t=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),r=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),v=Symbol.iterator,m="@@iterator";function b(u){if(u===null||typeof u!="object")return null;var x=v&&u[v]||u[m];return typeof x=="function"?x:null}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function I(u){{for(var x=arguments.length,E=new Array(x>1?x-1:0),N=1;N<x;N++)E[N-1]=arguments[N];$("error",u,E)}}function $(u,x,E){{var N=C.ReactDebugCurrentFrame,H=N.getStackAddendum();H!==""&&(x+="%s",E=E.concat([H]));var Y=E.map(function(W){return String(W)});Y.unshift("Warning: "+x),Function.prototype.apply.call(console[u],console,Y)}}var V=!1,S=!1,xe=!1,He=!1,Ke=!1,ke;ke=Symbol.for("react.module.reference");function Je(u){return!!(typeof u=="string"||typeof u=="function"||u===o||u===s||Ke||u===i||u===c||u===p||He||u===f||V||S||xe||typeof u=="object"&&u!==null&&(u.$$typeof===y||u.$$typeof===g||u.$$typeof===l||u.$$typeof===r||u.$$typeof===d||u.$$typeof===ke||u.getModuleId!==void 0))}function Re(u,x,E){var N=u.displayName;if(N)return N;var H=x.displayName||x.name||"";return H!==""?E+"("+H+")":E}function Te(u){return u.displayName||"Context"}function se(u){if(u==null)return null;if(typeof u.tag=="number"&&I("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case o:return"Fragment";case t:return"Portal";case s:return"Profiler";case i:return"StrictMode";case c:return"Suspense";case p:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case r:var x=u;return Te(x)+".Consumer";case l:var E=u;return Te(E._context)+".Provider";case d:return Re(u,u.render,"ForwardRef");case g:var N=u.displayName||null;return N!==null?N:se(u.type)||"Memo";case y:{var H=u,Y=H._payload,W=H._init;try{return se(W(Y))}catch{return null}}}return null}var oe=Object.assign,je=0,le,ye,Oe,Fe,j,O,A;function M(){}M.__reactDisabledLog=!0;function R(){{if(je===0){le=console.log,ye=console.info,Oe=console.warn,Fe=console.error,j=console.group,O=console.groupCollapsed,A=console.groupEnd;var u={configurable:!0,enumerable:!0,value:M,writable:!0};Object.defineProperties(console,{info:u,log:u,warn:u,error:u,group:u,groupCollapsed:u,groupEnd:u})}je++}}function q(){{if(je--,je===0){var u={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:oe({},u,{value:le}),info:oe({},u,{value:ye}),warn:oe({},u,{value:Oe}),error:oe({},u,{value:Fe}),group:oe({},u,{value:j}),groupCollapsed:oe({},u,{value:O}),groupEnd:oe({},u,{value:A})})}je<0&&I("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var T=C.ReactCurrentDispatcher,F;function D(u,x,E){{if(F===void 0)try{throw Error()}catch(H){var N=H.stack.trim().match(/\n( *(at )?)/);F=N&&N[1]||""}return`
`+F+u}}var U=!1,z;{var ne=typeof WeakMap=="function"?WeakMap:Map;z=new ne}function P(u,x){if(!u||U)return"";{var E=z.get(u);if(E!==void 0)return E}var N;U=!0;var H=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Y;Y=T.current,T.current=null,R();try{if(x){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(Ce){N=Ce}Reflect.construct(u,[],W)}else{try{W.call()}catch(Ce){N=Ce}u.call(W.prototype)}}else{try{throw Error()}catch(Ce){N=Ce}u()}}catch(Ce){if(Ce&&N&&typeof Ce.stack=="string"){for(var B=Ce.stack.split(`
`),ae=N.stack.split(`
`),X=B.length-1,Q=ae.length-1;X>=1&&Q>=0&&B[X]!==ae[Q];)Q--;for(;X>=1&&Q>=0;X--,Q--)if(B[X]!==ae[Q]){if(X!==1||Q!==1)do if(X--,Q--,Q<0||B[X]!==ae[Q]){var pe=`
`+B[X].replace(" at new "," at ");return u.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",u.displayName)),typeof u=="function"&&z.set(u,pe),pe}while(X>=1&&Q>=0);break}}}finally{U=!1,T.current=Y,q(),Error.prepareStackTrace=H}var Me=u?u.displayName||u.name:"",bn=Me?D(Me):"";return typeof u=="function"&&z.set(u,bn),bn}function fe(u,x,E){return P(u,!1)}function _e(u){var x=u.prototype;return!!(x&&x.isReactComponent)}function Ie(u,x,E){if(u==null)return"";if(typeof u=="function")return P(u,_e(u));if(typeof u=="string")return D(u);switch(u){case c:return D("Suspense");case p:return D("SuspenseList")}if(typeof u=="object")switch(u.$$typeof){case d:return fe(u.render);case g:return Ie(u.type,x,E);case y:{var N=u,H=N._payload,Y=N._init;try{return Ie(Y(H),x,E)}catch{}}}return""}var lt=Object.prototype.hasOwnProperty,sn={},ln=C.ReactDebugCurrentFrame;function ct(u){if(u){var x=u._owner,E=Ie(u.type,u._source,x?x.type:null);ln.setExtraStackFrame(E)}else ln.setExtraStackFrame(null)}function Si(u,x,E,N,H){{var Y=Function.call.bind(lt);for(var W in u)if(Y(u,W)){var B=void 0;try{if(typeof u[W]!="function"){var ae=Error((N||"React class")+": "+E+" type `"+W+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof u[W]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw ae.name="Invariant Violation",ae}B=u[W](x,W,N,E,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(X){B=X}B&&!(B instanceof Error)&&(ct(H),I("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",N||"React class",E,W,typeof B),ct(null)),B instanceof Error&&!(B.message in sn)&&(sn[B.message]=!0,ct(H),I("Failed %s type: %s",E,B.message),ct(null))}}}var Pi=Array.isArray;function Mt(u){return Pi(u)}function Oi(u){{var x=typeof Symbol=="function"&&Symbol.toStringTag,E=x&&u[Symbol.toStringTag]||u.constructor.name||"Object";return E}}function Ii(u){try{return cn(u),!1}catch{return!0}}function cn(u){return""+u}function un(u){if(Ii(u))return I("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Oi(u)),cn(u)}var Ye=C.ReactCurrentOwner,Ni={key:!0,ref:!0,__self:!0,__source:!0},dn,fn,At;At={};function ki(u){if(lt.call(u,"ref")){var x=Object.getOwnPropertyDescriptor(u,"ref").get;if(x&&x.isReactWarning)return!1}return u.ref!==void 0}function Ri(u){if(lt.call(u,"key")){var x=Object.getOwnPropertyDescriptor(u,"key").get;if(x&&x.isReactWarning)return!1}return u.key!==void 0}function Ti(u,x){if(typeof u.ref=="string"&&Ye.current&&x&&Ye.current.stateNode!==x){var E=se(Ye.current.type);At[E]||(I('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',se(Ye.current.type),u.ref),At[E]=!0)}}function Fi(u,x){{var E=function(){dn||(dn=!0,I("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",x))};E.isReactWarning=!0,Object.defineProperty(u,"key",{get:E,configurable:!0})}}function _i(u,x){{var E=function(){fn||(fn=!0,I("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",x))};E.isReactWarning=!0,Object.defineProperty(u,"ref",{get:E,configurable:!0})}}var Li=function(u,x,E,N,H,Y,W){var B={$$typeof:n,type:u,key:x,ref:E,props:W,_owner:Y};return B._store={},Object.defineProperty(B._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(B,"_self",{configurable:!1,enumerable:!1,writable:!1,value:N}),Object.defineProperty(B,"_source",{configurable:!1,enumerable:!1,writable:!1,value:H}),Object.freeze&&(Object.freeze(B.props),Object.freeze(B)),B};function Mi(u,x,E,N,H){{var Y,W={},B=null,ae=null;E!==void 0&&(un(E),B=""+E),Ri(x)&&(un(x.key),B=""+x.key),ki(x)&&(ae=x.ref,Ti(x,H));for(Y in x)lt.call(x,Y)&&!Ni.hasOwnProperty(Y)&&(W[Y]=x[Y]);if(u&&u.defaultProps){var X=u.defaultProps;for(Y in X)W[Y]===void 0&&(W[Y]=X[Y])}if(B||ae){var Q=typeof u=="function"?u.displayName||u.name||"Unknown":u;B&&Fi(W,Q),ae&&_i(W,Q)}return Li(u,B,ae,H,N,Ye.current,W)}}var Dt=C.ReactCurrentOwner,pn=C.ReactDebugCurrentFrame;function Le(u){if(u){var x=u._owner,E=Ie(u.type,u._source,x?x.type:null);pn.setExtraStackFrame(E)}else pn.setExtraStackFrame(null)}var zt;zt=!1;function Bt(u){return typeof u=="object"&&u!==null&&u.$$typeof===n}function mn(){{if(Dt.current){var u=se(Dt.current.type);if(u)return`

Check the render method of \``+u+"`."}return""}}function Ai(u){{if(u!==void 0){var x=u.fileName.replace(/^.*[\\\/]/,""),E=u.lineNumber;return`

Check your code at `+x+":"+E+"."}return""}}var hn={};function Di(u){{var x=mn();if(!x){var E=typeof u=="string"?u:u.displayName||u.name;E&&(x=`

Check the top-level render call using <`+E+">.")}return x}}function gn(u,x){{if(!u._store||u._store.validated||u.key!=null)return;u._store.validated=!0;var E=Di(x);if(hn[E])return;hn[E]=!0;var N="";u&&u._owner&&u._owner!==Dt.current&&(N=" It was passed a child from "+se(u._owner.type)+"."),Le(u),I('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',E,N),Le(null)}}function vn(u,x){{if(typeof u!="object")return;if(Mt(u))for(var E=0;E<u.length;E++){var N=u[E];Bt(N)&&gn(N,x)}else if(Bt(u))u._store&&(u._store.validated=!0);else if(u){var H=b(u);if(typeof H=="function"&&H!==u.entries)for(var Y=H.call(u),W;!(W=Y.next()).done;)Bt(W.value)&&gn(W.value,x)}}}function zi(u){{var x=u.type;if(x==null||typeof x=="string")return;var E;if(typeof x=="function")E=x.propTypes;else if(typeof x=="object"&&(x.$$typeof===d||x.$$typeof===g))E=x.propTypes;else return;if(E){var N=se(x);Si(E,u.props,"prop",N,u)}else if(x.PropTypes!==void 0&&!zt){zt=!0;var H=se(x);I("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",H||"Unknown")}typeof x.getDefaultProps=="function"&&!x.getDefaultProps.isReactClassApproved&&I("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Bi(u){{for(var x=Object.keys(u.props),E=0;E<x.length;E++){var N=x[E];if(N!=="children"&&N!=="key"){Le(u),I("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",N),Le(null);break}}u.ref!==null&&(Le(u),I("Invalid attribute `ref` supplied to `React.Fragment`."),Le(null))}}function yn(u,x,E,N,H,Y){{var W=Je(u);if(!W){var B="";(u===void 0||typeof u=="object"&&u!==null&&Object.keys(u).length===0)&&(B+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var ae=Ai(H);ae?B+=ae:B+=mn();var X;u===null?X="null":Mt(u)?X="array":u!==void 0&&u.$$typeof===n?(X="<"+(se(u.type)||"Unknown")+" />",B=" Did you accidentally export a JSX literal instead of a component?"):X=typeof u,I("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",X,B)}var Q=Mi(u,x,E,H,Y);if(Q==null)return Q;if(W){var pe=x.children;if(pe!==void 0)if(N)if(Mt(pe)){for(var Me=0;Me<pe.length;Me++)vn(pe[Me],u);Object.freeze&&Object.freeze(pe)}else I("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else vn(pe,u)}return u===o?Bi(Q):zi(Q),Q}}function $i(u,x,E){return yn(u,x,E,!0)}function Vi(u,x,E){return yn(u,x,E,!1)}var qi=Vi,Wi=$i;De.Fragment=o,De.jsx=qi,De.jsxs=Wi}()),De}process.env.NODE_ENV==="production"?ut.exports=Pn():ut.exports=On();var a=ut.exports,ze={},Be=xn;if(process.env.NODE_ENV==="production")ze.createRoot=Be.createRoot,ze.hydrateRoot=Be.hydrateRoot;else{var Ze=Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;ze.createRoot=function(e,n){Ze.usingClientEntryPoint=!0;try{return Be.createRoot(e,n)}finally{Ze.usingClientEntryPoint=!1}},ze.hydrateRoot=function(e,n,t){Ze.usingClientEntryPoint=!0;try{return Be.hydrateRoot(e,n,t)}finally{Ze.usingClientEntryPoint=!1}}}const In=({shape:e})=>{const[n,t]=k.useState(!1),o=k.useRef(null);k.useEffect(()=>{o.current&&o.current.focus({cursor:"end"})});const i=()=>{o.current.input.value!==""&&(e.text=o.current.input.value,t(!1))},s=d=>{e.toolMenus.find(p=>p.key===d.key).action(t)},l=()=>n?a.jsx(a.Fragment,{children:a.jsx(h.Form,{initialValues:{title:e.text},children:a.jsx(h.Form.Item,{name:"title",rules:[{required:!0,message:"请输入名称"}],children:a.jsx(h.Input,{onBlur:d=>i(),ref:o,placeholder:"请输入名称",style:{height:"24px",borderColor:e.focusBorderColor}})})})}):a.jsx("p",{style:{margin:0},children:a.jsx("span",{children:e.text})}),r=()=>{if(e.toolMenus&&e.toolMenus.length>0){const d=e.toolMenus.map(c=>({key:c.key,label:c.label}));return a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx(h.Dropdown,{menu:{items:d,onClick:c=>s(c)},placement:"bottomRight",children:a.jsx(h.Button,{type:"text",size:"small",style:{margin:0,padding:0,width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",children:a.jsx("path",{fill:"#1C1D23",fillOpacity:"0.8",d:"M3.667 7.833a1.167 1.167 0 1 1-2.334 0 1.167 1.167 0 0 1 2.334 0ZM9.15 7.833a1.167 1.167 0 1 1-2.333 0 1.167 1.167 0 0 1 2.333 0ZM14.667 7.833a1.167 1.167 0 1 1-2.334 0 1.167 1.167 0 0 1 2.334 0Z"})})})})})})}return a.jsx(a.Fragment,{})};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"react-node-header",children:[a.jsxs("div",{className:"react-node-toolbar",style:{alignItems:"center"},children:[a.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.getHeaderIcon()}),a.jsx("div",{className:"react-node-toolbar-name",children:l()}),r()]}),a.jsx("span",{className:"react-node-header-description",children:e.description})]})})},Wt=k.createContext(null),Ut=k.createContext(null),Ht=k.createContext(null),Nn=({shape:e,component:n})=>{const[t,o]=k.useReducer(n.reducers,n.getJadeConfig()),i="react-root-"+e.id;return e.getLatestJadeConfig=()=>JSON.parse(JSON.stringify(t)),k.useEffect(()=>{e.observe()},[]),k.useEffect(()=>{e.graph.onChangeCallback&&e.graph.onChangeCallback()},[t]),a.jsx(a.Fragment,{children:a.jsxs("div",{id:i,style:{display:"block"},children:[a.jsx(In,{shape:e}),a.jsx(Ut.Provider,{value:e,children:a.jsx(Wt.Provider,{value:t,children:a.jsx(Ht.Provider,{value:o,children:a.jsx("div",{className:"react-node-content",style:{borderRadius:e.borderRadius+"px"},children:n.getReactComponents()})})})})]})})};function Z(){return k.useContext(Wt)}function te(){return k.useContext(Ut)}function G(){return k.useContext(Ht)}const ce=(e,n,t,o,i,s,l)=>{const r=ee.node(e,n,t,o,i,s,!1,l||Rn);r.type="jadeNode",r.serializedFields.batchAdd("toolConfigs","componentName","flowMeta"),r.eventType="jadeEvent",r.hideText=!0,r.autoHeight=!0,r.width=360,r.borderColor="rgba(28,31,35,.08)",r.mouseInBorderColor="rgba(28,31,35,.08)",r.shadow="0 2px 4px 0 rgba(0,0,0,.1)",r.focusShadow="0 0 1px rgba(0,0,0,.3),0 4px 14px rgba(0,0,0,.1)",r.borderWidth=1,r.focusBorderWidth=2,r.dashWidth=0,r.backColor="white",r.focusBackColor="white",r.borderRadius=8,r.cornerRadius=8,r.enableAnimation=!1,r.modeRegion.visible=!1,r.flowMeta={triggerMode:"auto",jober:{type:"general_jober",name:"",fitables:[],converter:{type:"mapping_converter"}}};const d=[];r.toolMenus=[{key:"1",label:"复制",action:()=>{r.duplicate()}},{key:"2",label:"删除",action:()=>{r.remove()}},{key:"3",label:"重命名",action:f=>{f(!0)}}];const c=r.initConnectors;r.initConnectors=()=>{c.apply(r),r.connectors.remove(f=>f.direction.key===ee.DIRECTION.S.key||f.direction.key===ee.DIRECTION.N.key||f.direction.key==="ROTATE"),r.connectors.forEach(f=>{f.isSolid=!0,f.direction.key===ee.DIRECTION.W.key&&(f.allowFromLink=!1),f.direction.key===ee.DIRECTION.E.key&&(f.allowToLink=!1)})},r.getPreNodeInfos=()=>{if(!r.allowToLink)return[];const f=r.page.shapes.filter(C=>C.type==="jadeEvent"),v=[],m=new Set,b=C=>{if(m.has(C))return;m.add(C);const I=r.page.getShapeById(C);if(!I)return;v.push({id:I.id,node:I,name:I.text,observableList:I.page.getObservableList(I.id)});const $=f.filter(V=>V.toShape===C);for(const V of $)b(V.fromShape)};return b(r.id),v.shift(),v},r.observe=()=>{r.drawer.observe()},r.getComponent=()=>r.graph.plugins[r.componentName](r.flowMeta.jober.converter.entity),r.emit=(f,v)=>{const m=r.page.getObservable(r.id,f);m&&(m.observers.forEach(b=>{b.status==="enable"&&b.observe(v||m.value)}),v&&(m.value=v))};const p=r.remove;r.remove=f=>{const m=r.page.shapes.filter(C=>C.isTypeof("jadeEvent")).filter(C=>C.fromShape===r.id||C.toShape===r.id).flatMap(C=>C.remove()),b=p.apply(r,[f]);return r.cleanObservables(),[...b,...m]},r.duplicate=()=>{const f=JSON.stringify([r.serialize()]);ee.CopyPasteHelpers.pasteShapes(f,"",r.page)};const g=r.serialize;r.serialize=()=>(r.getLatestJadeConfig&&r.serializerJadeConfig(),g.apply(r)),r.serializerJadeConfig=()=>{r.flowMeta.jober.converter.entity=r.getLatestJadeConfig()},r.addDetection(["componentName"],(f,v,m)=>{v!==m&&(r.drawer.unmountReact(),r.invalidateAlone())}),r.getHeaderIcon=()=>{},r.observeTo=(f,v,m)=>{const b=r.getPreNodeInfos(),C=new Set(b.map(V=>V.id)),I=kn(f,v,m);I.status=C.has(f)?"enable":"disable",d.push(I),r.page.observeTo(f,v,I);const $=r.page.getObservable(f,v);return I.observe($.value),()=>{const V=d.findIndex(S=>S===I);d.splice(V,1),r.page.stopObserving(f,v,I)}},r.offConnect=()=>{const f=r.getPreNodeInfos(),v=new Set(f.map(b=>b.id));d.filter(b=>b.status==="enable").filter(b=>!v.has(b.nodeId)).forEach(b=>{b.observe(null),b.status="disable"});const m=y();m.length>0&&m.forEach(b=>b.offConnect())},r.onConnect=()=>{const f=r.getPreNodeInfos(),v=new Set(f.map(b=>b.id));d.filter(b=>b.status==="disable").filter(b=>v.has(b.nodeId)).forEach(b=>{b.status="enable";const C=r.page.getObservable(b.nodeId,b.observableId);b.observe(C.value)});const m=y();m.length>0&&m.forEach(b=>b.onConnect())},r.cleanObservables=()=>{r.page.removeObservable(r.id),d.forEach(f=>r.page.stopObserving(f.nodeId,f.observableId,f))};const y=()=>{const f=r.page.shapes.filter(v=>v.type==="jadeEvent").filter(v=>v.fromShape===r.id);return!f||f.length===0?[]:r.page.shapes.filter(v=>v.type!=="jadeEvent").filter(v=>f.some(m=>m.toShape===v.id))};return r.validate=()=>{const f=r.getPreNodeInfos(),v=new Set(f.map(m=>m.id));d.forEach(m=>{const b=r.page.getShapeById(m.nodeId);if(!b)throw new Error("节点["+m.nodeId+"]不存在.");if(!v.has(m.nodeId))throw new Error("节点["+b.text+"]和节点["+r.text+"]未连接.")})},r},kn=(e,n,t)=>{const o={};return o.nodeId=e,o.observableId=n,o.status="enable",o.origin=t,o.observe=i=>{o.status==="enable"&&o.origin(i)},o},Rn=(e,n,t,o)=>{const i=ee.rectangleDrawer(e,n,t,o);i.reactContainer=null;const s=i.initialize;i.initialize=()=>{s.apply(i),i.reactContainer=document.createElement("div"),i.reactContainer.id="react-container-"+e.id,i.reactContainer.style.padding="12px",i.reactContainer.style.width="100%",i.reactContainer.style.borderRadius=e.borderRadius+"px",i.parent.appendChild(i.reactContainer),i.parent.style.pointerEvents="auto"},i.unmountReact=()=>{i.root&&(i.root.unmount(),i.root=null)},i.drawStatic=()=>{!e.componentName||i.root||(i.root=ze.createRoot(i.reactContainer),i.root.render(a.jsx(Nn,{shape:e,component:e.getComponent()})))},i.drawFocusFrame=()=>{};const l=i.drawBorder;i.drawBorder=()=>{l.apply(i),e.isFocused?(i.parent.style.border="",i.parent.style.border=e.borderWidth+"px solid "+e.borderColor,i.parent.style.outline=e.focusBorderWidth+"px solid "+e.getBorderColor()):i.parent.style.outline=""};const r=i.beforeRemove;i.beforeRemove=()=>{r.apply(i),i.unmountReact()};let d=0;return i.observe=()=>{new ResizeObserver(c=>{d!==i.parent.offsetHeight&&e.container!==""&&(e.resize(e.width,i.parent.offsetHeight),d=i.parent.offsetHeight)}).observe(i.parent)},i};function Tn(){const e=Z();return a.jsx("ul",{children:e.map(n=>a.jsx("li",{children:a.jsx(Fn,{task:n})},n.id))})}function Fn({task:e}){const[n,t]=k.useState(!1),o=G();let i;return n?i=a.jsxs(a.Fragment,{children:[a.jsx("input",{value:e.text,onChange:s=>{o({type:"changed",task:{...e,text:s.target.value}})}}),a.jsx("button",{onClick:()=>t(!1),children:"Save"})]}):i=a.jsxs(a.Fragment,{children:[e.text,a.jsx("button",{onClick:()=>t(!0),children:"Edit"})]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:e.done,onChange:s=>{o({type:"changed",task:{...e,done:s.target.checked}})}}),i,a.jsx("button",{onClick:()=>{o({type:"deleted",id:e.id})},children:"Delete"})]})}function _n(){const[e,n]=k.useState(""),t=G(),o=te();return a.jsxs(a.Fragment,{children:[a.jsx("input",{placeholder:"Add task",value:e,onChange:i=>n(i.target.value)}),a.jsx("button",{onClick:()=>{n(""),console.log(o.serialize()),t({type:"added",id:Ln++,text:e})},children:"Add"})]})}let Ln=3;var Mn=k.createContext({});const Kt=Mn;function we(){return we=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},we.apply(this,arguments)}function An(e){if(Array.isArray(e))return e}function Dn(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var o,i,s,l,r=[],d=!0,c=!1;try{if(s=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;d=!1}else for(;!(d=(o=s.call(t)).done)&&(r.push(o.value),r.length!==n);d=!0);}catch(p){c=!0,i=p}finally{try{if(!d&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw i}}return r}}function Jt(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function zn(e,n){if(e){if(typeof e=="string")return Jt(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Jt(e,n)}}function Bn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yt(e,n){return An(e)||Dn(e,n)||zn(e,n)||Bn()}function Se(e){"@babel/helpers - typeof";return Se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Se(e)}function $n(e,n){if(Se(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var o=t.call(e,n||"default");if(Se(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Vn(e){var n=$n(e,"string");return Se(n)=="symbol"?n:n+""}function dt(e,n,t){return n=Vn(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function qn(e,n){if(e==null)return{};var t={},o=Object.keys(e),i,s;for(s=0;s<o.length;s++)i=o[s],!(n.indexOf(i)>=0)&&(t[i]=e[i]);return t}function Zt(e,n){if(e==null)return{};var t=qn(e,n),o,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)o=s[i],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(t[o]=e[o])}return t}var Gt={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var s="",l=0;l<arguments.length;l++){var r=arguments[l];r&&(s=i(s,o(r)))}return s}function o(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var l="";for(var r in s)n.call(s,r)&&s[r]&&(l=i(l,r));return l}function i(s,l){return l?s?s+" "+l:s+l:s}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(Gt);var Wn=Gt.exports;const Un=$t(Wn);function ue(e,n){Hn(e)&&(e="100%");var t=Kn(e);return e=n===360?e:Math.min(n,Math.max(0,parseFloat(e))),t&&(e=parseInt(String(e*n),10)/100),Math.abs(e-n)<1e-6?1:(n===360?e=(e<0?e%n+n:e%n)/parseFloat(String(n)):e=e%n/parseFloat(String(n)),e)}function Hn(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function Kn(e){return typeof e=="string"&&e.indexOf("%")!==-1}function Jn(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Ge(e){return e<=1?"".concat(Number(e)*100,"%"):e}function ft(e){return e.length===1?"0"+e:String(e)}function Yn(e,n,t){return{r:ue(e,255)*255,g:ue(n,255)*255,b:ue(t,255)*255}}function pt(e,n,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(n-e)*(6*t):t<1/2?n:t<2/3?e+(n-e)*(2/3-t)*6:e}function Zn(e,n,t){var o,i,s;if(e=ue(e,360),n=ue(n,100),t=ue(t,100),n===0)i=t,s=t,o=t;else{var l=t<.5?t*(1+n):t+n-t*n,r=2*t-l;o=pt(r,l,e+1/3),i=pt(r,l,e),s=pt(r,l,e-1/3)}return{r:o*255,g:i*255,b:s*255}}function Gn(e,n,t){e=ue(e,255),n=ue(n,255),t=ue(t,255);var o=Math.max(e,n,t),i=Math.min(e,n,t),s=0,l=o,r=o-i,d=o===0?0:r/o;if(o===i)s=0;else{switch(o){case e:s=(n-t)/r+(n<t?6:0);break;case n:s=(t-e)/r+2;break;case t:s=(e-n)/r+4;break}s/=6}return{h:s,s:d,v:l}}function Xn(e,n,t){e=ue(e,360)*6,n=ue(n,100),t=ue(t,100);var o=Math.floor(e),i=e-o,s=t*(1-n),l=t*(1-i*n),r=t*(1-(1-i)*n),d=o%6,c=[t,l,s,s,r,t][d],p=[r,t,t,l,s,s][d],g=[s,s,r,t,t,l][d];return{r:c*255,g:p*255,b:g*255}}function Qn(e,n,t,o){var i=[ft(Math.round(e).toString(16)),ft(Math.round(n).toString(16)),ft(Math.round(t).toString(16))];return o&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function Xt(e){return ie(e)/255}function ie(e){return parseInt(e,16)}var Qt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function $e(e){var n={r:0,g:0,b:0},t=1,o=null,i=null,s=null,l=!1,r=!1;return typeof e=="string"&&(e=ra(e)),typeof e=="object"&&(be(e.r)&&be(e.g)&&be(e.b)?(n=Yn(e.r,e.g,e.b),l=!0,r=String(e.r).substr(-1)==="%"?"prgb":"rgb"):be(e.h)&&be(e.s)&&be(e.v)?(o=Ge(e.s),i=Ge(e.v),n=Xn(e.h,o,i),l=!0,r="hsv"):be(e.h)&&be(e.s)&&be(e.l)&&(o=Ge(e.s),s=Ge(e.l),n=Zn(e.h,o,s),l=!0,r="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(t=e.a)),t=Jn(t),{ok:l,format:e.format||r,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:t}}var ea="[-\\+]?\\d+%?",ta="[-\\+]?\\d*\\.\\d+%?",Ee="(?:".concat(ta,")|(?:").concat(ea,")"),mt="[\\s|\\(]+(".concat(Ee,")[,|\\s]+(").concat(Ee,")[,|\\s]+(").concat(Ee,")\\s*\\)?"),ht="[\\s|\\(]+(".concat(Ee,")[,|\\s]+(").concat(Ee,")[,|\\s]+(").concat(Ee,")[,|\\s]+(").concat(Ee,")\\s*\\)?"),he={CSS_UNIT:new RegExp(Ee),rgb:new RegExp("rgb"+mt),rgba:new RegExp("rgba"+ht),hsl:new RegExp("hsl"+mt),hsla:new RegExp("hsla"+ht),hsv:new RegExp("hsv"+mt),hsva:new RegExp("hsva"+ht),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function ra(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var n=!1;if(Qt[e])e=Qt[e],n=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t=he.rgb.exec(e);return t?{r:t[1],g:t[2],b:t[3]}:(t=he.rgba.exec(e),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=he.hsl.exec(e),t?{h:t[1],s:t[2],l:t[3]}:(t=he.hsla.exec(e),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=he.hsv.exec(e),t?{h:t[1],s:t[2],v:t[3]}:(t=he.hsva.exec(e),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=he.hex8.exec(e),t?{r:ie(t[1]),g:ie(t[2]),b:ie(t[3]),a:Xt(t[4]),format:n?"name":"hex8"}:(t=he.hex6.exec(e),t?{r:ie(t[1]),g:ie(t[2]),b:ie(t[3]),format:n?"name":"hex"}:(t=he.hex4.exec(e),t?{r:ie(t[1]+t[1]),g:ie(t[2]+t[2]),b:ie(t[3]+t[3]),a:Xt(t[4]+t[4]),format:n?"name":"hex8"}:(t=he.hex3.exec(e),t?{r:ie(t[1]+t[1]),g:ie(t[2]+t[2]),b:ie(t[3]+t[3]),format:n?"name":"hex"}:!1)))))))))}function be(e){return!!he.CSS_UNIT.exec(String(e))}var Xe=2,er=.16,na=.05,aa=.05,oa=.15,tr=5,rr=4,ia=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function nr(e){var n=e.r,t=e.g,o=e.b,i=Gn(n,t,o);return{h:i.h*360,s:i.s,v:i.v}}function Qe(e){var n=e.r,t=e.g,o=e.b;return"#".concat(Qn(n,t,o,!1))}function sa(e,n,t){var o=t/100,i={r:(n.r-e.r)*o+e.r,g:(n.g-e.g)*o+e.g,b:(n.b-e.b)*o+e.b};return i}function ar(e,n,t){var o;return Math.round(e.h)>=60&&Math.round(e.h)<=240?o=t?Math.round(e.h)-Xe*n:Math.round(e.h)+Xe*n:o=t?Math.round(e.h)+Xe*n:Math.round(e.h)-Xe*n,o<0?o+=360:o>=360&&(o-=360),o}function or(e,n,t){if(e.h===0&&e.s===0)return e.s;var o;return t?o=e.s-er*n:n===rr?o=e.s+er:o=e.s+na*n,o>1&&(o=1),t&&n===tr&&o>.1&&(o=.1),o<.06&&(o=.06),Number(o.toFixed(2))}function ir(e,n,t){var o;return t?o=e.v+aa*n:o=e.v-oa*n,o>1&&(o=1),Number(o.toFixed(2))}function gt(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],o=$e(e),i=tr;i>0;i-=1){var s=nr(o),l=Qe($e({h:ar(s,i,!0),s:or(s,i,!0),v:ir(s,i,!0)}));t.push(l)}t.push(Qe(o));for(var r=1;r<=rr;r+=1){var d=nr(o),c=Qe($e({h:ar(d,r),s:or(d,r),v:ir(d,r)}));t.push(c)}return n.theme==="dark"?ia.map(function(p){var g=p.index,y=p.opacity,f=Qe(sa($e(n.backgroundColor||"#141414"),$e(t[g]),y*100));return f}):t}var vt={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},et={},yt={};Object.keys(vt).forEach(function(e){et[e]=gt(vt[e]),et[e].primary=et[e][5],yt[e]=gt(vt[e],{theme:"dark",backgroundColor:"#141414"}),yt[e].primary=yt[e][5]});var la=et.blue;function sr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,o)}return t}function ge(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?sr(Object(t),!0).forEach(function(o){dt(e,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sr(Object(t)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))})}return e}function ca(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function ua(e,n){if(!e)return!1;if(e.contains)return e.contains(n);for(var t=n;t;){if(t===e)return!0;t=t.parentNode}return!1}var lr="data-rc-order",cr="data-rc-priority",da="rc-util-key",bt=new Map;function ur(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.mark;return n?n.startsWith("data-")?n:"data-".concat(n):da}function xt(e){if(e.attachTo)return e.attachTo;var n=document.querySelector("head");return n||document.body}function fa(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function jt(e){return Array.from((bt.get(e)||e).children).filter(function(n){return n.tagName==="STYLE"})}function dr(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ca())return null;var t=n.csp,o=n.prepend,i=n.priority,s=i===void 0?0:i,l=fa(o),r=l==="prependQueue",d=document.createElement("style");d.setAttribute(lr,l),r&&s&&d.setAttribute(cr,"".concat(s)),t!=null&&t.nonce&&(d.nonce=t==null?void 0:t.nonce),d.innerHTML=e;var c=xt(n),p=c.firstChild;if(o){if(r){var g=(n.styles||jt(c)).filter(function(y){if(!["prepend","prependQueue"].includes(y.getAttribute(lr)))return!1;var f=Number(y.getAttribute(cr)||0);return s>=f});if(g.length)return c.insertBefore(d,g[g.length-1].nextSibling),d}c.insertBefore(d,p)}else c.appendChild(d);return d}function pa(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=xt(n);return(n.styles||jt(t)).find(function(o){return o.getAttribute(ur(n))===e})}function ma(e,n){var t=bt.get(e);if(!t||!ua(document,t)){var o=dr("",n),i=o.parentNode;bt.set(e,i),e.removeChild(o)}}function ha(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=xt(t),i=jt(o),s=ge(ge({},t),{},{styles:i});ma(o,s);var l=pa(n,s);if(l){var r,d;if((r=s.csp)!==null&&r!==void 0&&r.nonce&&l.nonce!==((d=s.csp)===null||d===void 0?void 0:d.nonce)){var c;l.nonce=(c=s.csp)===null||c===void 0?void 0:c.nonce}return l.innerHTML!==e&&(l.innerHTML=e),l}var p=dr(e,s);return p.setAttribute(ur(s),n),p}function fr(e){var n;return e==null||(n=e.getRootNode)===null||n===void 0?void 0:n.call(e)}function ga(e){return fr(e)instanceof ShadowRoot}function va(e){return ga(e)?fr(e):null}var Ct={},wt=[],ya=function(n){wt.push(n)};function ba(e,n){if(process.env.NODE_ENV!=="production"&&!e&&console!==void 0){var t=wt.reduce(function(o,i){return i(o??"","warning")},n);t&&console.error("Warning: ".concat(t))}}function xa(e,n){if(process.env.NODE_ENV!=="production"&&!e&&console!==void 0){var t=wt.reduce(function(o,i){return i(o??"","note")},n);t&&console.warn("Note: ".concat(t))}}function ja(){Ct={}}function pr(e,n,t){!n&&!Ct[t]&&(e(!1,t),Ct[t]=!0)}function tt(e,n){pr(ba,e,n)}function Ca(e,n){pr(xa,e,n)}tt.preMessage=ya,tt.resetWarned=ja,tt.noteOnce=Ca;function wa(e){return e.replace(/-(.)/g,function(n,t){return t.toUpperCase()})}function Ea(e,n){tt(e,"[@ant-design/icons] ".concat(n))}function mr(e){return Se(e)==="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(Se(e.icon)==="object"||typeof e.icon=="function")}function hr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(n,t){var o=e[t];switch(t){case"class":n.className=o,delete n.class;break;default:delete n[t],n[wa(t)]=o}return n},{})}function Et(e,n,t){return t?k.createElement(e.tag,ge(ge({key:n},hr(e.attrs)),t),(e.children||[]).map(function(o,i){return Et(o,"".concat(n,"-").concat(e.tag,"-").concat(i))})):k.createElement(e.tag,ge({key:n},hr(e.attrs)),(e.children||[]).map(function(o,i){return Et(o,"".concat(n,"-").concat(e.tag,"-").concat(i))}))}function gr(e){return gt(e)[0]}function vr(e){return e?Array.isArray(e)?e:[e]:[]}var Sa=`
.anticon {
  display: inline-flex;
  alignItems: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Pa=function(n){var t=k.useContext(Kt),o=t.csp,i=t.prefixCls,s=Sa;i&&(s=s.replace(/anticon/g,i)),k.useEffect(function(){var l=n.current,r=va(l);ha(s,"@ant-design-icons",{prepend:!0,csp:o,attachTo:r})},[])},Oa=["icon","className","onClick","style","primaryColor","secondaryColor"],Ve={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function Ia(e){var n=e.primaryColor,t=e.secondaryColor;Ve.primaryColor=n,Ve.secondaryColor=t||gr(n),Ve.calculated=!!t}function Na(){return ge({},Ve)}var rt=function(n){var t=n.icon,o=n.className,i=n.onClick,s=n.style,l=n.primaryColor,r=n.secondaryColor,d=Zt(n,Oa),c=w.useRef(),p=Ve;if(l&&(p={primaryColor:l,secondaryColor:r||gr(l)}),Pa(c),Ea(mr(t),"icon should be icon definiton, but got ".concat(t)),!mr(t))return null;var g=t;return g&&typeof g.icon=="function"&&(g=ge(ge({},g),{},{icon:g.icon(p.primaryColor,p.secondaryColor)})),Et(g.icon,"svg-".concat(g.name),ge(ge({className:o,onClick:i,style:s,"data-icon":g.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},d),{},{ref:c}))};rt.displayName="IconReact",rt.getTwoToneColors=Na,rt.setTwoToneColors=Ia;const St=rt;function yr(e){var n=vr(e),t=Yt(n,2),o=t[0],i=t[1];return St.setTwoToneColors({primaryColor:o,secondaryColor:i})}function ka(){var e=St.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}var Ra=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];yr(la.primary);var nt=w.forwardRef(function(e,n){var t=e.className,o=e.icon,i=e.spin,s=e.rotate,l=e.tabIndex,r=e.onClick,d=e.twoToneColor,c=Zt(e,Ra),p=w.useContext(Kt),g=p.prefixCls,y=g===void 0?"anticon":g,f=p.rootClassName,v=Un(f,y,dt(dt({},"".concat(y,"-").concat(o.name),!!o.name),"".concat(y,"-spin"),!!i||o.name==="loading"),t),m=l;m===void 0&&r&&(m=-1);var b=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,C=vr(d),I=Yt(C,2),$=I[0],V=I[1];return w.createElement("span",we({role:"img","aria-label":o.name},c,{ref:n,tabIndex:m,onClick:r,className:v}),w.createElement(St,{icon:o,primaryColor:$,secondaryColor:V,style:b}))});nt.displayName="AntdIcon",nt.getTwoToneColor=ka,nt.setTwoToneColor=yr;const qe=nt;var Ta={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}},{tag:"path",attrs:{d:"M376.9 656.4c1.8-33.5 15.7-64.7 39.5-88.6 25.4-25.5 60-39.8 96-39.8 36.2 0 70.3 14.1 96 39.8 1.4 1.4 2.7 2.8 4.1 4.3l-25 19.6a8 8 0 003 14.1l98.2 24c5 1.2 9.9-2.6 9.9-7.7l.5-101.3c0-6.7-7.6-10.5-12.9-6.3L663 532.7c-36.6-42-90.4-68.6-150.5-68.6-107.4 0-195 85.1-199.4 191.7-.2 4.5 3.4 8.3 8 8.3H369c4.2-.1 7.7-3.4 7.9-7.7zM703 664h-47.9c-4.2 0-7.7 3.3-8 7.6-1.8 33.5-15.7 64.7-39.5 88.6-25.4 25.5-60 39.8-96 39.8-36.2 0-70.3-14.1-96-39.8-1.4-1.4-2.7-2.8-4.1-4.3l25-19.6a8 8 0 00-3-14.1l-98.2-24c-5-1.2-9.9 2.6-9.9 7.7l-.4 101.4c0 6.7 7.6 10.5 12.9 6.3l23.2-18.2c36.6 42 90.4 68.6 150.5 68.6 107.4 0 195-85.1 199.4-191.7.2-4.5-3.4-8.3-8-8.3z"}}]},name:"cloud-sync",theme:"outlined"};const Fa=Ta;var _a=function(n,t){return w.createElement(qe,we({},n,{ref:t,icon:Fa}))},br=w.forwardRef(_a);process.env.NODE_ENV!=="production"&&(br.displayName="CloudSyncOutlined");const Ne=br;var La={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};const Ma=La;var Aa=function(n,t){return w.createElement(qe,we({},n,{ref:t,icon:Ma}))},xr=w.forwardRef(Aa);process.env.NODE_ENV!=="production"&&(xr.displayName="DeleteOutlined");const Da=xr;var za={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};const Ba=za;var $a=function(n,t){return w.createElement(qe,we({},n,{ref:t,icon:Ba}))},jr=w.forwardRef($a);process.env.NODE_ENV!=="production"&&(jr.displayName="InfoCircleOutlined");const ve=jr;var Va={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};const qa=Va;var Wa=function(n,t){return w.createElement(qe,we({},n,{ref:t,icon:qa}))},Cr=w.forwardRef(Wa);process.env.NODE_ENV!=="production"&&(Cr.displayName="MinusCircleOutlined");const wr=Cr;var Ua={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"};const Ha=Ua;var Ka=function(n,t){return w.createElement(qe,we({},n,{ref:t,icon:Ha}))},Er=w.forwardRef(Ka);process.env.NODE_ENV!=="production"&&(Er.displayName="PlusOutlined");const at=Er,Ja=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="taskNode",r.text="LLM",r.width=700,r.jadeConfig=[{id:0,text:"Philosopher’s Path",done:!0},{id:1,text:"Visit the temple",done:!1},{id:2,text:"Drink matcha",done:!1}],r.getReactComponents=()=>a.jsxs(a.Fragment,{children:[a.jsx("h1",{children:"Day off in Kyoto"}),a.jsx(_n,{}),a.jsx(Tn,{})]}),r.getHeaderIcon=()=>a.jsx(Ne,{}),r.reducers=(d,c)=>{switch(c.type){case"added":return[...d,{id:c.id,text:c.text,done:!1}];case"changed":return d.map(p=>p.id===c.task.id?c.task:p);case"deleted":return d.filter(p=>p.id!==c.id);default:throw Error("Unknown action: "+c.type)}},r},Ya=e=>w.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},w.createElement("desc",null,`
			Created with Pixso.
	`),w.createElement("defs",null,w.createElement("clipPath",{id:"clip4_13285"},w.createElement("rect",{id:"\\u56FE\\u6807/16/\\u5F00\\u59CB\\uFF0C\\u8D77\\u70B9\\uFF0C\\u7AEF\\u70B9",width:16,height:16,transform:"matrix(-1 0 0 1 20 4)",fill:"white",fillOpacity:0}))),w.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,transform:"matrix(-1 0 0 1 24 0)",fill:"#5E7CE0",fillOpacity:1}),w.createElement("g",{clipPath:"url(#clip4_13285)"},w.createElement("path",{id:"path",d:"M7.41 11.52L5.83 11.52L5.83 6.31L12.53 6.31C15.64 6.37 18.16 8.89 18.16 11.99C18.16 15.1 15.64 17.62 12.53 17.67L5.83 17.67L5.83 12.46L10.92 12.46L10.92 13.52L13.91 13.52L13.91 10.47L10.92 10.47L10.92 11.53L7.41 11.53L7.41 11.52Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),Za=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);r.type="endNodeEnd",r.backColor="white",r.pointerEvents="auto",r.text="结束",r.componentName="endComponent",r.deletable=!1,r.flowMeta={triggerMode:"auto",callback:{type:"general_callback",name:"通知回调",fitables:["com.huawei.fit.jober.aipp.fitable.AippFlowEndCallback"],converter:{type:"mapping_converter"}}},r.toolMenus=[{key:"1",label:"重命名",action:c=>{c(!0)}}];const d=r.initConnectors;return r.initConnectors=()=>{d.apply(r),r.connectors.remove(c=>c.direction.key===ee.DIRECTION.E.key)},r.serializerJadeConfig=()=>{r.flowMeta.callback.converter.entity=r.getLatestJadeConfig()},r.getComponent=()=>r.graph.plugins[r.componentName](r.flowMeta.callback.converter.entity),r.getHeaderIcon=()=>a.jsx(h.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:a.jsx(Ya,{})}),r},We=({reference:e,onReferencedValueChange:n,onReferencedKeyChange:t,...o})=>{const i=te(),s=k.useRef(null),[l,r]=k.useState([]),d=g=>{if(!g)return;s.current&&s.current();const y=new Map(l.map(m=>[m.id,m])),f=y.get(g),v=c(y,f);s.current=i.observeTo(f.nId,f.value,n),t({referenceNode:f.nId,referenceId:f.value,value:v})},c=(g,y)=>{const f=[];f.unshift(y.title);let v=y.pId;for(;v;){const m=g.get(v);if(!m||m.pId===0)break;f.unshift(m.title),v=m.pId}return f},p=()=>{const y=i.getPreNodeInfos().map(f=>{const v=[];return v.push({id:f.id,pId:0,value:f.id,title:f.name,selectable:!1}),f.observableList.forEach(m=>{m.parentId||(m.parentId=f.id);const b={nId:f.id,id:m.observableId,pId:m.parentId,value:m.observableId,title:m.value};v.push(b)}),v}).flatMap(f=>f);r(y)};return k.useEffect(()=>(e.referenceNode&&e.referenceId&&(s.current=i.observeTo(e.referenceNode,e.referenceId,n)),()=>{s.current&&s.current()}),[]),a.jsx(a.Fragment,{children:a.jsx(h.TreeSelect,{...o,treeDataSimpleMode:!0,style:{fontSize:"12px",width:"100%"},value:e.referenceKey,dropdownStyle:{maxHeight:400,overflow:"auto",minWidth:250},placeholder:"请选择",onChange:d,treeData:l,onDropdownVisibleChange:p,treeDefaultExpandAll:!1})})};function Ga({item:e,handleItemChange:n}){const t=o=>{switch(o){case"Reference":return a.jsx(We,{reference:e,onReferencedValueChange:i=>{n(e.id,[{key:"referenceKey",value:i}])},onReferencedKeyChange:i=>{n(e.id,[{key:"referenceNode",value:i.referenceNode},{key:"referenceId",value:i.referenceId},{key:"value",value:i.value}])},style:{fontSize:"12px"},placeholder:"请选择",onMouseDown:i=>i.stopPropagation(),showSearch:!0,className:"value-custom jade-select",dropdownStyle:{maxHeight:400,overflow:"auto"},value:e.value});case"String":return a.jsx(h.Input,{className:"value-custom jade-input",style:{fontSize:"12px"},placeholder:"请输入",value:e.value,onChange:i=>n(e.id,[{key:"value",value:i.target.value}])});default:return null}};return a.jsxs(h.Row,{gutter:16,children:[a.jsx(h.Col,{span:8,style:{alignItems:"center",display:"flex"},children:a.jsx("span",{className:"jade-font-size",style:{marginBottom:"8px"},children:"finalOutput"})}),a.jsx(h.Col,{span:6,style:{paddingRight:0},children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},id:`valueSource-${e.id}`,initialValue:"Reference",children:a.jsx(h.Select,{onMouseDown:o=>o.stopPropagation(),id:`valueSource-select-${e.id}`,className:"value-source-custom jade-select",style:{width:"100%"},onChange:o=>{let i=[{key:"from",value:o},{key:"value",value:""}];o==="String"&&(i=[{key:"from",value:o},{key:"value",value:""},{key:"referenceNode",value:""},{key:"referenceId",value:""},{key:"referenceKey",value:""}]),n(e.id,i)},options:[{value:"Reference",label:"引用"},{value:"String",label:"输入"}],value:e.from})})}),a.jsx(h.Col,{span:10,style:{paddingLeft:0},children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},id:`value-${e.id}`,children:t(e.from)})})]},`output-variable-${e.id}`)}const{Panel:Xa}=h.Collapse;function Qa(){const e=G(),n=Z(),t=te(),o=()=>n&&n.inputParams,i=(l,r)=>{e({type:"editOutputVariable",id:l,changes:r})},s=a.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[a.jsx("p",{children:"这些变量将在机器人完成工作流调用后输出。"}),a.jsx("p",{children:"在“返回变量”模式下，这些变量将由机器人汇总并回复给用户；"}),a.jsx("p",{children:"在“直接回答”模式下，机器人将只回复配置卡时可以使用的变量"})]});return a.jsx("div",{children:a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",style:{marginTop:"10px",marginBottom:8,borderRadius:"8px",width:"100%"},defaultActiveKey:["Output variable"],children:a.jsx(Xa,{style:{marginBottom:8,borderRadius:"8px",width:"100%"},header:a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[a.jsx("span",{className:"jade-panel-header-font",children:"输出"}),a.jsx(h.Popover,{content:s,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:a.jsxs(h.Form,{name:`Output variable_${t.id}`,layout:"vertical",className:"jade-form",children:[a.jsxs(h.Row,{gutter:16,children:[a.jsx(h.Col,{span:8,children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},children:a.jsx("span",{className:"jade-font-size jade-font-color",children:"字段名称"})})}),a.jsx(h.Col,{span:16,children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},children:a.jsx("span",{className:"jade-font-size jade-font-color",children:"字段值"})})})]}),a.jsx(Ga,{item:o()[0],handleItemChange:i})]})},"Output variable")})})}function eo(){return a.jsx("div",{style:{backgroundColor:"white"},children:a.jsx(Qa,{})})}let ot;const to=new Uint8Array(16);function ro(){if(!ot&&(ot=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ot))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ot(to)}const re=[];for(let e=0;e<256;++e)re.push((e+256).toString(16).slice(1));function no(e,n=0){return re[e[n+0]]+re[e[n+1]]+re[e[n+2]]+re[e[n+3]]+"-"+re[e[n+4]]+re[e[n+5]]+"-"+re[e[n+6]]+re[e[n+7]]+"-"+re[e[n+8]]+re[e[n+9]]+"-"+re[e[n+10]]+re[e[n+11]]+re[e[n+12]]+re[e[n+13]]+re[e[n+14]]+re[e[n+15]]}const Sr={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function _(e,n,t){if(Sr.randomUUID&&!n&&!e)return Sr.randomUUID();e=e||{};const o=e.random||(e.rng||ro)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,n){t=t||0;for(let i=0;i<16;++i)n[t+i]=o[i];return n}return no(o)}const ao=e=>{const n={};return n.getJadeConfig=()=>e||{inputParams:[{id:_(),name:"finalOutput",type:"String",from:"Reference",referenceNode:"",referenceId:"",referenceKey:"",value:[]}],outputParams:[{}]},n.getReactComponents=()=>a.jsx(eo,{}),n.reducers=(t,o)=>{const i=()=>{const l=s.inputParams.find(r=>r.name==="finalOutput");o.changes.forEach(r=>{l[r.key]=r.value})},s={...t};switch(o.type){case"editOutputVariable":return i(),s;default:throw Error("Unknown action: "+o.type)}},n},oo=e=>w.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},w.createElement("desc",null,`
			Created with Pixso.
	`),w.createElement("defs",null,w.createElement("clipPath",{id:"clip4_13287"},w.createElement("rect",{id:"\\u56FE\\u6807/16/\\u6570\\u636E\\u68C0\\u7D22\\uFF0C\\u67E5\\u627E",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),w.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#50D4AB",fillOpacity:1}),w.createElement("g",{clipPath:"url(#clip4_13287)"},w.createElement("path",{id:"path",d:"M12.11 10.24C15.33 10.24 18.03 9.02 18.03 7.62C18.03 6.14 15.42 5.01 12.11 5.01C8.8 5.01 6.19 6.23 6.19 7.62C6.19 9.1 8.8 10.24 12.11 10.24ZM12.11 13.02L12.37 13.02C12.89 11.8 14.11 11.02 15.59 11.02C16.29 11.02 16.9 11.19 17.51 11.54C17.86 11.19 18.12 10.85 18.12 10.41L18.12 8.32C18.12 9.8 15.51 10.93 12.2 10.93C8.97 10.93 6.27 9.71 6.27 8.32L6.27 10.32C6.19 11.8 8.8 13.02 12.11 13.02ZM12.11 15.72L12.28 15.72C12.11 15.38 12.02 14.94 12.02 14.5C12.02 14.24 12.02 13.98 12.11 13.72C8.89 13.72 6.19 12.5 6.19 11.11L6.19 13.11C6.19 14.59 8.8 15.72 12.11 15.72ZM14.55 17.81C13.77 17.55 13.07 17.12 12.63 16.42L12.11 16.42C8.89 16.42 6.19 15.2 6.19 13.81L6.19 15.81C6.19 17.29 8.8 18.42 12.11 18.42C12.98 18.42 13.85 18.34 14.64 18.16C14.55 18.08 14.55 17.99 14.55 17.81ZM19.69 17.9L17.86 16.07L17.77 15.99C18.03 15.55 18.21 15.03 18.21 14.42C18.21 12.85 16.9 11.54 15.33 11.54C13.77 11.54 12.46 12.85 12.46 14.42C12.46 15.99 13.77 17.29 15.33 17.29C15.86 17.29 16.29 17.12 16.73 16.94C16.73 16.94 16.73 17.03 16.81 17.03L18.64 18.86C18.82 19.03 19.25 19.03 19.52 18.77C19.86 18.42 19.86 18.08 19.69 17.9ZM13.33 14.42C13.33 13.28 14.29 12.33 15.42 12.33C16.55 12.33 17.51 13.28 17.51 14.42C17.51 15.55 16.55 16.51 15.42 16.51C14.2 16.51 13.33 15.55 13.33 14.42Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),de=e=>{const{onMouseDown:n,...t}=e,o=i=>{n&&n(i),i.stopPropagation()};return a.jsx(a.Fragment,{children:a.jsx(h.Select,{onMouseDown:i=>o(i),...t})})},{Panel:io}=h.Collapse;function Pr(){const e=G(),n=Z(),t=te(),o=n&&n.inputParams.find(r=>r.name==="query"),i=(r,d)=>{e({type:"editInput",id:r,changes:d})},s=r=>{switch(r.from){case"Reference":return a.jsx(h.Form.Item,{children:a.jsx(We,{reference:r,onReferencedValueChange:d=>{i(r.id,[{key:"referenceKey",value:d}])},onReferencedKeyChange:d=>{i(r.id,[{key:"referenceNode",value:d.referenceNode},{key:"referenceId",value:d.referenceId},{key:"value",value:d.value}])},style:{fontSize:"12px"},placeholder:"请选择",onMouseDown:d=>d.stopPropagation(),showSearch:!0,className:"value-custom jade-select",dropdownStyle:{maxHeight:400,overflow:"auto"},value:r.value})});case"Input":return a.jsx(h.Form.Item,{id:`input-${r.id}`,name:`input-${r.id}`,rules:[{required:!0,message:"字段值不能为空"},{pattern:/^[^\s]*$/,message:"禁止输入空格"}],initialValue:r.value,children:a.jsx(h.Input,{className:"value-custom jade-input",placeholder:"清输入",value:r.value,onChange:d=>i(r.id,[{key:"value",value:d.target.value}])})});default:return null}},l=a.jsx("div",{className:"jade-font-size",children:a.jsx("p",{children:"输入需要从知识库中匹配的关键信息"})});return a.jsx("div",{children:a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",style:{marginTop:"10px",marginBottom:8,borderRadius:"8px",width:"100%"},defaultActiveKey:["Input"],children:a.jsx(io,{style:{marginBottom:8,borderRadius:"8px",width:"100%"},header:a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[a.jsx("span",{className:"jade-panel-header-font",children:"输入"}),a.jsx(h.Popover,{content:l,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:a.jsxs(h.Form,{name:`inputForm-${t.id}`,layout:"vertical",className:"jade-form",children:[a.jsxs(h.Row,{children:[a.jsx(h.Col,{span:8,children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},children:a.jsx("span",{className:"jade-font-size jade-font-color",children:"字段名称"})})}),a.jsx(h.Col,{span:16,children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},children:a.jsx("span",{className:"jade-font-size jade-font-color",children:"字段值"})})})]}),a.jsxs(h.Row,{className:"jade-row",children:[a.jsx(h.Col,{span:8,children:a.jsx("span",{className:"starred-text",children:"query"})}),a.jsx(h.Col,{span:8,style:{paddingRight:0},children:a.jsx(h.Form.Item,{id:"valueSource",initialValue:"Reference",children:a.jsx(de,{id:`valueSource-select-${o.id}`,className:"value-source-custom jade-select",style:{width:"100%"},onMouseDown:r=>r.stopPropagation(),onChange:r=>{let d=[{key:"from",value:r},{key:"value",value:""}];r==="Input"&&(d=[{key:"from",value:r},{key:"value",value:""},{key:"referenceNode",value:""},{key:"referenceId",value:""},{key:"referenceKey",value:""}]),i(o.id,d)},options:[{value:"Reference",label:"引用"},{value:"Input",label:"输入"}],value:o.from})})}),a.jsx(h.Col,{span:8,style:{paddingLeft:0},children:a.jsxs(h.Form.Item,{id:`value-${o.id}`,rules:[{required:!0,message:"参数不能为空!"}],children:[s(o)," "]})})]})]})},"Input")})})}function so(){const e=G(),n=Z(),t=n&&n.inputParams.find(s=>s.name==="maximum").value,o=a.jsx("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:a.jsx("p",{children:"从知识返回到模型的最大段落数。数字越大，返回的内容越多。"})}),i={1:"1",3:"默认",10:"10"};return a.jsxs(h.Row,{className:"jade-row",children:[a.jsx(h.Col,{span:12,className:"jade-column",children:a.jsxs(h.Form.Item,{children:[a.jsx("span",{style:{fontSize:"12px",fontFamily:"SF Pro Display",letterSpacing:"0.12px",lineHeight:"16px",alignItems:"center",userSelect:"none",marginRight:"4px",color:"rgba(28, 29, 35, 0.35)"},children:"返回最大值"}),a.jsx(h.Popover,{content:o,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})})]})}),a.jsx(h.Col,{span:12,children:a.jsx(h.Form.Item,{style:{marginBottom:"0"},id:"valueSource",initialValue:"Reference",children:a.jsx(h.Slider,{className:"jade-slider",style:{width:"90%"},min:1,max:10,step:1,marks:i,defaultValue:3,value:t,onChange:s=>e({type:"changeMaximum",key:"maximum",value:s})})})})]})}const lo=(e={})=>{const n=jn.create({withCredentials:!0,timeout:1e4,headers:{"Content-Type":"application/json",...e}});return n.interceptors.request.use(t=>t,t=>Promise.reject(t)),n.interceptors.response.use(t=>t.data,t=>Promise.reject(t)),n},it=(e,n,t,o,i=()=>{},s=()=>{})=>{lo(t).request({method:e,url:n,data:o}).then(r=>{i(r)}).catch(r=>{s(r)})},Pe={get:(e,n=new Map,t,o)=>{it("Get",e,n,{},t,o)},post:(e,n,t=new Map,o,i)=>{it("Post",e,t,n,o,i)},put:(e,n,t=new Map,o,i)=>{it("Put",e,t,n,o,i)},del:(e,n=new Map,t,o)=>{it("Delete",e,n,{},t,o)}};function Pt(e){const[n,t]=k.useState([]),[o,i]=k.useState(!1),[s,l]=k.useState(1),{buildUrl:r,onChange:d,getOptions:c,disabled:p,dealResponse:g,...y}=e,f=r(s),v=async C=>{C&&n.length===0&&(i(!0),Pe.get(f,void 0,I=>{const $=g(I);$&&t($),i(!1)},I=>{console.error("Error fetching options:",I),i(!1)}))},m=async C=>{const{target:I}=C;if(I.scrollTop+I.clientHeight!==I.scrollHeight)return;console.log("Scroll to bottom. Loading new page...");const $=s;l(s+1),i(!0),Pe.get(f,void 0,V=>{const S=V.data;S&&t([...n,...S]),i(!1)},V=>{console.error("Error fetching options:",V),i(!1),l($)})},b=C=>{d(C,n)};return a.jsx(de,{className:"jade-select",style:{width:"100%"},onPopupScroll:m,onDropdownVisibleChange:v,onChange:b,disabled:p||!1,options:c(n),loading:o,mode:"single",...y})}const{Panel:co}=h.Collapse;function Or(){const e=G(),n=Z(),t=te(),o=n&&[...n.inputParams.find(m=>m.name==="knowledge").value],i=t.graph.configs&&t.graph.configs.find(m=>m.node==="knowledgeState").urls.knowledgeUrl,s=m=>i+"?pageNum="+m+"&pageSize=10",l=()=>o.length<=1,r=m=>{e({type:"addKnowledge",id:_()}),m.stopPropagation()},d=(m,b,C,I)=>{e({type:"editKnowledge",id:m,key:b,value:I.find($=>$.id===C)})},c=m=>{e({type:"clearKnowledge",id:m})},p=m=>{e({type:"deleteKnowledge",id:m})},g=m=>m.data.items,y=m=>m.map(b=>({value:b.id,label:b.name})),f=m=>m.value&&m.value.length!==0?m.value.find(b=>b.name==="name").value:"",v=a.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[a.jsx("p",{children:"选择需要匹配的知识范围，"}),a.jsx("p",{children:"仅从所选知识中调出信息"})]});return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",style:{marginTop:"10px",marginBottom:8,borderRadius:"8px",width:"100%"},defaultActiveKey:["Knowledge"],children:a.jsx(co,{style:{marginBottom:8,borderRadius:"8px",width:"100%"},header:a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsx("span",{className:"jade-panel-header-font",children:"知识库"}),a.jsx(h.Popover,{content:v,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})}),a.jsx(h.Button,{type:"text",className:"icon-button",onClick:m=>r(m),style:{height:"22px",marginLeft:"auto"},children:a.jsx(at,{})})]}),className:"jade-panel",children:a.jsxs(h.Form,{name:`knowledgeForm-${t.id}`,layout:"vertical",className:"jade-form",children:[o.map(m=>a.jsxs(h.Row,{gutter:16,children:[a.jsx(h.Col,{span:22,children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},id:`from-${m.id}`,initialValue:"Reference",children:a.jsx(Pt,{allowClear:!0,placeholder:"选择知识库",id:`valueSource-select-${m.id}`,onClear:()=>c(m.id),onChange:(b,C)=>d(m.id,"value",b,C),buildUrl:s,disabled:!1,getOptions:y,dealResponse:g,value:f(m)})},`from-${m.id}`)}),a.jsx(h.Col,{span:2,style:{paddingLeft:"2px"},children:a.jsx(h.Form.Item,{style:{marginBottom:"8px"},children:a.jsx(h.Button,{disabled:l(),type:"text",className:"icon-button",style:{alignItems:"center",marginLeft:"auto"},onClick:()=>p(m.id),children:a.jsx(wr,{})})},`button-${m.id}`)})]},`knowledgeRow-${m.id}`)),a.jsx(so,{})]})},"Knowledge")})}const Ue=({data:e})=>{if(!Array.isArray(e))throw new Error("data must be array.");const[n,t]=k.useState(null),o=te();k.useEffect(()=>{const r=e.map(d=>s(d,null));return t(r),()=>{r&&i(r,d=>{o.page.removeObservable(o.id,d.key)})}},[]);const i=(r,d)=>{r.forEach(c=>{c.children&&i(c.children,d),d(c)})},s=(r,d)=>(o.page.registerObservable(o.id,r.id,r.name,r.type,d?d.id:null),r.type==="Object"?{title:r.name,type:r.type,key:r.id,children:r.value.map(c=>s(c,r))}:{title:r.name,type:r.type,key:r.id,isLeaf:!0}),l=r=>a.jsx(a.Fragment,{children:a.jsx("div",{className:"jade-observable-tree-node-div",children:a.jsxs("div",{style:{display:"flex"},children:[a.jsx("span",{className:"jade-observable-tree-node-title",children:r.title}),a.jsx("div",{className:"jade-observable-tree-node-type-div",children:a.jsx("span",{className:"jade-observable-tree-node-type-name",children:r.type})})]})})});return a.jsx(a.Fragment,{children:a.jsx(h.Tree,{treeData:n,titleRender:r=>l(r),showLine:!0,selectable:!1})})},{Panel:uo}=h.Collapse;function Ir(){const e=Z(),n=te(),t=e&&e.outputParams,o=a.jsx("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:a.jsx("p",{children:"输出列表是与输入参数最匹配的信息，从所有选定的知识库中调用"})});return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",style:{marginTop:"10px",marginBottom:8,borderRadius:"8px",width:"100%"},defaultActiveKey:["Output"],children:a.jsx(uo,{header:a.jsxs("div",{style:{display:"flex",alignItems:"center",paddingLeft:"-16px"},children:[a.jsx("span",{className:"jade-panel-header-font",children:"输出"}),a.jsx(h.Popover,{content:o,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:a.jsx(h.Form,{name:`outputForm-${n.id}`,layout:"vertical",className:"jade-form",children:a.jsx(Ue,{data:t})})},"Output")})}const fo=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="retrievalNodeState",r.backColor="white",r.pointerEvents="auto",r.text="普通检索",r.componentName="retrievalComponent",r.flowMeta.jober.fitables.push("com.huawei.fit.jober.aipp.fitable.NaiveRAGComponent"),r.flowMeta.triggerMode="auto",r.getReactComponents=()=>a.jsxs(a.Fragment,{children:[a.jsx(Pr,{}),a.jsx(Or,{}),a.jsx(Ir,{})]}),r.getHeaderIcon=()=>a.jsx(h.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:a.jsx(oo,{})}),r},po=e=>{const n={};return n.getJadeConfig=()=>e||{inputParams:[{id:"query_"+_(),name:"query",type:"String",from:"Reference",referenceNode:"",referenceId:"",referenceKey:"",value:[]},{id:"knowledge_"+_(),name:"knowledge",type:"Array",from:"Expand",value:[{id:_(),type:"Object",from:"Expand",value:[]}]},{id:"maximum_"+_(),name:"maximum",type:"Integer",from:"Input",value:3}],outputParams:[{id:"output_"+_(),name:"output",type:"Object",from:"Expand",value:[{id:_(),name:"retrievalOutput",type:"String",from:"Input",value:"String"}]}]},n.getReactComponents=()=>a.jsxs(a.Fragment,{children:[a.jsx(Pr,{}),a.jsx(Or,{}),a.jsx(Ir,{})]}),n.reducers=(t,o)=>{const i=()=>{const y=g.inputParams.find(f=>f.name==="query");o.changes.map(f=>{y[f.key]=f.value})},s=()=>{c().push({id:o.id,name:"",type:"Object",from:"Expand",value:[]})},l=()=>{const y=c(),f=y.findIndex(v=>v.id===o.id);f!==-1&&y.splice(f,1)},r=()=>{if(!o.value)return;const y=o.value.id,f=o.value.name,v=c().find(m=>m.id===o.id).value;v.length===0?(v.push({id:_(),name:"id",from:"Input",type:"String",value:y}),v.push({id:_(),name:"name",from:"Input",type:"String",value:f})):v.forEach(m=>{m.name==="id"&&(m.value=y),m.name==="name"&&(m.value=f)})},d=()=>{g.inputParams.filter(y=>y.name==="maximum").forEach(y=>{y.value=o.value})},c=()=>g.inputParams.find(y=>y.name==="knowledge").value,p=()=>{c().find(y=>y.id===o.id).value=[]};let g={...t};switch(o.type){case"editInput":return i(),g;case"addKnowledge":return s(),g;case"deleteKnowledge":return l(),g;case"editKnowledge":return r(),g;case"changeMaximum":return d(),g;case"clearKnowledge":return p(),g;default:throw Error("Unknown action: "+o.type)}},n},mo=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="listener1Node",r.text="被监听者",r.componentName="listener1Component",r.getHeaderIcon=()=>a.jsx(Ne,{}),r},Ot=e=>{const{onChange:n,...t}=e;if(!t.id)throw new Error("JadeObservableInput requires an id property.");const o=te();if(!o)throw new Error("JadeObservableInput must be wrapped by ShapeContext.");const i=s=>{n&&n(s),o.emit(t.id,s.target.value)};return k.useEffect(()=>(o.page.registerObservable(o.id,t.id,t.value,t.type,t.parent),()=>{o.page.removeObservable(o.id,t.id)}),[]),k.useEffect(()=>{o.page.registerObservable(o.id,t.id,t.value,t.type,t.parent)},[t.type]),a.jsx(a.Fragment,{children:a.jsx(h.Input,{...t,onChange:s=>i(s)})})},ho=e=>{const n={};return n.getJadeConfig=()=>e||[{id:"listener1-name",name:"name",type:"String",value:"请输入一个名字"},{id:"listener1-firstName",name:"firstName",type:"String",value:"请输入第一名字"}],n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(go,{})}),n.reducers=(t,o)=>{switch(o.type){case"updateName":return t.map(i=>i.id===o.id?{...i,name:o.name}:i);default:throw Error("Unknown action: "+o.type)}},n},go=()=>{const e=Z(),n=G(),t=(o,i)=>{n({type:"updateName",id:o,name:i.target.value})};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ot,{id:e[0].id,value:e[0].name,onChange:o=>t(e[0].id,o)}),a.jsx(Ot,{id:e[1].id,parent:e[0].id,value:e[1].name,onChange:o=>t(e[1].id,o)})]})})},vo=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="listener2Node",r.text="监听者",r.componentName="listener2Component",r.getHeaderIcon=()=>a.jsx(Ne,{}),r},yo=e=>{const n={};return n.getJadeConfig=()=>e||[{id:"123456",name:"zzzzz",type:"Reference",value:[],referenceNode:"",referenceId:"",referenceKey:""}],n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(bo,{})}),n.reducers=(t,o)=>{switch(o.type){case"updateValue":return t.map(i=>i.id===o.id?{...i,referenceKey:o.referenceKey}:i);case"update":return t.map(i=>i.id===o.id?{...i,referenceNode:o.referenceNode,referenceId:o.referenceId,value:o.value}:i);default:throw Error("Unknown action: "+o.type)}},n},bo=()=>{const e=G(),n=Z();return a.jsx(a.Fragment,{children:a.jsx(We,{reference:n[0],onReferencedValueChange:t=>{e({type:"updateValue",id:n[0].id,referenceKey:t})},onReferencedKeyChange:t=>{e({type:"update",id:n[0].id,referenceNode:t.referenceNode,referenceId:t.referenceId,value:t.value})}})})},xo=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="listener3Node",r.text="被监听者",r.componentName="listener3Component",r.getHeaderIcon=()=>a.jsx(Ne,{}),r},jo=e=>{const n={};return n.getJadeConfig=()=>e||{output:[{id:"uuid1",name:"person",type:"Object",value:[{id:"uuid2",name:"name",type:"String"},{id:"uuid3",name:"age",type:"Integer"}]}]},n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(Co,{})}),n.reducers=()=>{},n},Co=()=>{const e=Z();return a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx(Ue,{data:e.output})})})},wo=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="jadeInputTreeNode",r.text="被监听者",r.componentName="jadeInputTreeComponent",r.width=360,r.getHeaderIcon=()=>a.jsx(Ne,{}),r};var It={exports:{}},st={exports:{}},K={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nr;function Eo(){if(Nr)return K;Nr=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,r=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,y=e?Symbol.for("react.suspense_list"):60120,f=e?Symbol.for("react.memo"):60115,v=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,C=e?Symbol.for("react.responder"):60118,I=e?Symbol.for("react.scope"):60119;function $(S){if(typeof S=="object"&&S!==null){var xe=S.$$typeof;switch(xe){case n:switch(S=S.type,S){case d:case c:case o:case s:case i:case g:return S;default:switch(S=S&&S.$$typeof,S){case r:case p:case v:case f:case l:return S;default:return xe}}case t:return xe}}}function V(S){return $(S)===c}return K.AsyncMode=d,K.ConcurrentMode=c,K.ContextConsumer=r,K.ContextProvider=l,K.Element=n,K.ForwardRef=p,K.Fragment=o,K.Lazy=v,K.Memo=f,K.Portal=t,K.Profiler=s,K.StrictMode=i,K.Suspense=g,K.isAsyncMode=function(S){return V(S)||$(S)===d},K.isConcurrentMode=V,K.isContextConsumer=function(S){return $(S)===r},K.isContextProvider=function(S){return $(S)===l},K.isElement=function(S){return typeof S=="object"&&S!==null&&S.$$typeof===n},K.isForwardRef=function(S){return $(S)===p},K.isFragment=function(S){return $(S)===o},K.isLazy=function(S){return $(S)===v},K.isMemo=function(S){return $(S)===f},K.isPortal=function(S){return $(S)===t},K.isProfiler=function(S){return $(S)===s},K.isStrictMode=function(S){return $(S)===i},K.isSuspense=function(S){return $(S)===g},K.isValidElementType=function(S){return typeof S=="string"||typeof S=="function"||S===o||S===c||S===s||S===i||S===g||S===y||typeof S=="object"&&S!==null&&(S.$$typeof===v||S.$$typeof===f||S.$$typeof===l||S.$$typeof===r||S.$$typeof===p||S.$$typeof===b||S.$$typeof===C||S.$$typeof===I||S.$$typeof===m)},K.typeOf=$,K}var J={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kr;function So(){return kr||(kr=1,process.env.NODE_ENV!=="production"&&function(){var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,r=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,y=e?Symbol.for("react.suspense_list"):60120,f=e?Symbol.for("react.memo"):60115,v=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,C=e?Symbol.for("react.responder"):60118,I=e?Symbol.for("react.scope"):60119;function $(P){return typeof P=="string"||typeof P=="function"||P===o||P===c||P===s||P===i||P===g||P===y||typeof P=="object"&&P!==null&&(P.$$typeof===v||P.$$typeof===f||P.$$typeof===l||P.$$typeof===r||P.$$typeof===p||P.$$typeof===b||P.$$typeof===C||P.$$typeof===I||P.$$typeof===m)}function V(P){if(typeof P=="object"&&P!==null){var fe=P.$$typeof;switch(fe){case n:var _e=P.type;switch(_e){case d:case c:case o:case s:case i:case g:return _e;default:var Ie=_e&&_e.$$typeof;switch(Ie){case r:case p:case v:case f:case l:return Ie;default:return fe}}case t:return fe}}}var S=d,xe=c,He=r,Ke=l,ke=n,Je=p,Re=o,Te=v,se=f,oe=t,je=s,le=i,ye=g,Oe=!1;function Fe(P){return Oe||(Oe=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),j(P)||V(P)===d}function j(P){return V(P)===c}function O(P){return V(P)===r}function A(P){return V(P)===l}function M(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function R(P){return V(P)===p}function q(P){return V(P)===o}function T(P){return V(P)===v}function F(P){return V(P)===f}function D(P){return V(P)===t}function U(P){return V(P)===s}function z(P){return V(P)===i}function ne(P){return V(P)===g}J.AsyncMode=S,J.ConcurrentMode=xe,J.ContextConsumer=He,J.ContextProvider=Ke,J.Element=ke,J.ForwardRef=Je,J.Fragment=Re,J.Lazy=Te,J.Memo=se,J.Portal=oe,J.Profiler=je,J.StrictMode=le,J.Suspense=ye,J.isAsyncMode=Fe,J.isConcurrentMode=j,J.isContextConsumer=O,J.isContextProvider=A,J.isElement=M,J.isForwardRef=R,J.isFragment=q,J.isLazy=T,J.isMemo=F,J.isPortal=D,J.isProfiler=U,J.isStrictMode=z,J.isSuspense=ne,J.isValidElementType=$,J.typeOf=V}()),J}var Rr;function Tr(){return Rr||(Rr=1,process.env.NODE_ENV==="production"?st.exports=Eo():st.exports=So()),st.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Nt,Fr;function Po(){if(Fr)return Nt;Fr=1;var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function o(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}function i(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var l={},r=0;r<10;r++)l["_"+String.fromCharCode(r)]=r;var d=Object.getOwnPropertyNames(l).map(function(p){return l[p]});if(d.join("")!=="0123456789")return!1;var c={};return"abcdefghijklmnopqrst".split("").forEach(function(p){c[p]=p}),Object.keys(Object.assign({},c)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return Nt=i()?Object.assign:function(s,l){for(var r,d=o(s),c,p=1;p<arguments.length;p++){r=Object(arguments[p]);for(var g in r)n.call(r,g)&&(d[g]=r[g]);if(e){c=e(r);for(var y=0;y<c.length;y++)t.call(r,c[y])&&(d[c[y]]=r[c[y]])}}return d},Nt}var kt,_r;function Rt(){if(_r)return kt;_r=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return kt=e,kt}var Tt,Lr;function Mr(){return Lr||(Lr=1,Tt=Function.call.bind(Object.prototype.hasOwnProperty)),Tt}var Ft,Ar;function Oo(){if(Ar)return Ft;Ar=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var n=Rt(),t={},o=Mr();e=function(s){var l="Warning: "+s;typeof console<"u"&&console.error(l);try{throw new Error(l)}catch{}}}function i(s,l,r,d,c){if(process.env.NODE_ENV!=="production"){for(var p in s)if(o(s,p)){var g;try{if(typeof s[p]!="function"){var y=Error((d||"React class")+": "+r+" type `"+p+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof s[p]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw y.name="Invariant Violation",y}g=s[p](l,p,d,r,null,n)}catch(v){g=v}if(g&&!(g instanceof Error)&&e((d||"React class")+": type specification of "+r+" `"+p+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof g+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),g instanceof Error&&!(g.message in t)){t[g.message]=!0;var f=c?c():"";e("Failed "+r+" type: "+g.message+(f??""))}}}}return i.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(t={})},Ft=i,Ft}var _t,Dr;function Io(){if(Dr)return _t;Dr=1;var e=Tr(),n=Po(),t=Rt(),o=Mr(),i=Oo(),s=function(){};process.env.NODE_ENV!=="production"&&(s=function(r){var d="Warning: "+r;typeof console<"u"&&console.error(d);try{throw new Error(d)}catch{}});function l(){return null}return _t=function(r,d){var c=typeof Symbol=="function"&&Symbol.iterator,p="@@iterator";function g(j){var O=j&&(c&&j[c]||j[p]);if(typeof O=="function")return O}var y="<<anonymous>>",f={array:C("array"),bigint:C("bigint"),bool:C("boolean"),func:C("function"),number:C("number"),object:C("object"),string:C("string"),symbol:C("symbol"),any:I(),arrayOf:$,element:V(),elementType:S(),instanceOf:xe,node:Je(),objectOf:Ke,oneOf:He,oneOfType:ke,shape:Te,exact:se};function v(j,O){return j===O?j!==0||1/j===1/O:j!==j&&O!==O}function m(j,O){this.message=j,this.data=O&&typeof O=="object"?O:{},this.stack=""}m.prototype=Error.prototype;function b(j){if(process.env.NODE_ENV!=="production")var O={},A=0;function M(q,T,F,D,U,z,ne){if(D=D||y,z=z||F,ne!==t){if(d){var P=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw P.name="Invariant Violation",P}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var fe=D+":"+F;!O[fe]&&A<3&&(s("You are manually calling a React.PropTypes validation function for the `"+z+"` prop on `"+D+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),O[fe]=!0,A++)}}return T[F]==null?q?T[F]===null?new m("The "+U+" `"+z+"` is marked as required "+("in `"+D+"`, but its value is `null`.")):new m("The "+U+" `"+z+"` is marked as required in "+("`"+D+"`, but its value is `undefined`.")):null:j(T,F,D,U,z)}var R=M.bind(null,!1);return R.isRequired=M.bind(null,!0),R}function C(j){function O(A,M,R,q,T,F){var D=A[M],U=le(D);if(U!==j){var z=ye(D);return new m("Invalid "+q+" `"+T+"` of type "+("`"+z+"` supplied to `"+R+"`, expected ")+("`"+j+"`."),{expectedType:j})}return null}return b(O)}function I(){return b(l)}function $(j){function O(A,M,R,q,T){if(typeof j!="function")return new m("Property `"+T+"` of component `"+R+"` has invalid PropType notation inside arrayOf.");var F=A[M];if(!Array.isArray(F)){var D=le(F);return new m("Invalid "+q+" `"+T+"` of type "+("`"+D+"` supplied to `"+R+"`, expected an array."))}for(var U=0;U<F.length;U++){var z=j(F,U,R,q,T+"["+U+"]",t);if(z instanceof Error)return z}return null}return b(O)}function V(){function j(O,A,M,R,q){var T=O[A];if(!r(T)){var F=le(T);return new m("Invalid "+R+" `"+q+"` of type "+("`"+F+"` supplied to `"+M+"`, expected a single ReactElement."))}return null}return b(j)}function S(){function j(O,A,M,R,q){var T=O[A];if(!e.isValidElementType(T)){var F=le(T);return new m("Invalid "+R+" `"+q+"` of type "+("`"+F+"` supplied to `"+M+"`, expected a single ReactElement type."))}return null}return b(j)}function xe(j){function O(A,M,R,q,T){if(!(A[M]instanceof j)){var F=j.name||y,D=Fe(A[M]);return new m("Invalid "+q+" `"+T+"` of type "+("`"+D+"` supplied to `"+R+"`, expected ")+("instance of `"+F+"`."))}return null}return b(O)}function He(j){if(!Array.isArray(j))return process.env.NODE_ENV!=="production"&&(arguments.length>1?s("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):s("Invalid argument supplied to oneOf, expected an array.")),l;function O(A,M,R,q,T){for(var F=A[M],D=0;D<j.length;D++)if(v(F,j[D]))return null;var U=JSON.stringify(j,function(ne,P){var fe=ye(P);return fe==="symbol"?String(P):P});return new m("Invalid "+q+" `"+T+"` of value `"+String(F)+"` "+("supplied to `"+R+"`, expected one of "+U+"."))}return b(O)}function Ke(j){function O(A,M,R,q,T){if(typeof j!="function")return new m("Property `"+T+"` of component `"+R+"` has invalid PropType notation inside objectOf.");var F=A[M],D=le(F);if(D!=="object")return new m("Invalid "+q+" `"+T+"` of type "+("`"+D+"` supplied to `"+R+"`, expected an object."));for(var U in F)if(o(F,U)){var z=j(F,U,R,q,T+"."+U,t);if(z instanceof Error)return z}return null}return b(O)}function ke(j){if(!Array.isArray(j))return process.env.NODE_ENV!=="production"&&s("Invalid argument supplied to oneOfType, expected an instance of array."),l;for(var O=0;O<j.length;O++){var A=j[O];if(typeof A!="function")return s("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+Oe(A)+" at index "+O+"."),l}function M(R,q,T,F,D){for(var U=[],z=0;z<j.length;z++){var ne=j[z],P=ne(R,q,T,F,D,t);if(P==null)return null;P.data&&o(P.data,"expectedType")&&U.push(P.data.expectedType)}var fe=U.length>0?", expected one of type ["+U.join(", ")+"]":"";return new m("Invalid "+F+" `"+D+"` supplied to "+("`"+T+"`"+fe+"."))}return b(M)}function Je(){function j(O,A,M,R,q){return oe(O[A])?null:new m("Invalid "+R+" `"+q+"` supplied to "+("`"+M+"`, expected a ReactNode."))}return b(j)}function Re(j,O,A,M,R){return new m((j||"React class")+": "+O+" type `"+A+"."+M+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+R+"`.")}function Te(j){function O(A,M,R,q,T){var F=A[M],D=le(F);if(D!=="object")return new m("Invalid "+q+" `"+T+"` of type `"+D+"` "+("supplied to `"+R+"`, expected `object`."));for(var U in j){var z=j[U];if(typeof z!="function")return Re(R,q,T,U,ye(z));var ne=z(F,U,R,q,T+"."+U,t);if(ne)return ne}return null}return b(O)}function se(j){function O(A,M,R,q,T){var F=A[M],D=le(F);if(D!=="object")return new m("Invalid "+q+" `"+T+"` of type `"+D+"` "+("supplied to `"+R+"`, expected `object`."));var U=n({},A[M],j);for(var z in U){var ne=j[z];if(o(j,z)&&typeof ne!="function")return Re(R,q,T,z,ye(ne));if(!ne)return new m("Invalid "+q+" `"+T+"` key `"+z+"` supplied to `"+R+"`.\nBad object: "+JSON.stringify(A[M],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(j),null,"  "));var P=ne(F,z,R,q,T+"."+z,t);if(P)return P}return null}return b(O)}function oe(j){switch(typeof j){case"number":case"string":case"undefined":return!0;case"boolean":return!j;case"object":if(Array.isArray(j))return j.every(oe);if(j===null||r(j))return!0;var O=g(j);if(O){var A=O.call(j),M;if(O!==j.entries){for(;!(M=A.next()).done;)if(!oe(M.value))return!1}else for(;!(M=A.next()).done;){var R=M.value;if(R&&!oe(R[1]))return!1}}else return!1;return!0;default:return!1}}function je(j,O){return j==="symbol"?!0:O?O["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&O instanceof Symbol:!1}function le(j){var O=typeof j;return Array.isArray(j)?"array":j instanceof RegExp?"object":je(O,j)?"symbol":O}function ye(j){if(typeof j>"u"||j===null)return""+j;var O=le(j);if(O==="object"){if(j instanceof Date)return"date";if(j instanceof RegExp)return"regexp"}return O}function Oe(j){var O=ye(j);switch(O){case"array":case"object":return"an "+O;case"boolean":case"date":case"regexp":return"a "+O;default:return O}}function Fe(j){return!j.constructor||!j.constructor.name?y:j.constructor.name}return f.checkPropTypes=i,f.resetWarningCache=i.resetWarningCache,f.PropTypes=f,f},_t}var Lt,zr;function No(){if(zr)return Lt;zr=1;var e=Rt();function n(){}function t(){}return t.resetWarningCache=n,Lt=function(){function o(l,r,d,c,p,g){if(g!==e){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}o.isRequired=o;function i(){return o}var s={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:i,element:o,elementType:o,instanceOf:i,node:o,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:n};return s.PropTypes=s,s},Lt}if(process.env.NODE_ENV!=="production"){var ko=Tr(),Ro=!0;It.exports=Io()(ko.isElement,Ro)}else It.exports=No()();var To=It.exports;const L=$t(To),Br=(e,n)=>{if(e.from==="Expand")return{id:e.id,title:e.name,type:e.type,key:e.id,level:n,from:e.from,children:e.value.map(t=>Br(t,n+1))};{const t={id:e.id,title:e.name,type:e.type,key:e.id,level:n,value:e.value,from:e.from,referenceKey:e.referenceKey,referenceNode:e.referenceNode,referenceId:e.referenceId,isLeaf:!0};return e.type==="Object"&&(t.props=e.props),t}};$r.propTypes={data:L.array.isRequired,updateItem:L.func.isRequired};const Fo=110,_o=24;function $r({data:e,updateItem:n}){const t=e.map(c=>Br(c,0)),o=(c,p,g)=>{n(c,[{key:p,value:g.target.value}])},i=(c,p)=>{n(c,[{key:"referenceKey",value:p}])},s=(c,p)=>{n(c,[{key:"referenceNode",value:p.referenceNode},{key:"referenceId",value:p.referenceId},{key:"value",value:p.value}])},l=c=>c.from==="Input"?a.jsx(h.Input,{className:"jade-input",style:{borderRadius:"0px 8px 8px 0px"},placeholder:"请输入",value:c.value,onChange:p=>o(c.id,"value",p)}):c.from==="Reference"?a.jsx(We,{className:"jade-input-tree-title-tree-select jade-select",reference:c,onReferencedKeyChange:p=>s(c.id,p),onReferencedValueChange:p=>i(c.id,p)}):null,r=c=>{switch(c.type){case"Object":return[{value:"Reference",label:"引用"},{value:"Expand",label:"展开"}];case"Array":return[{value:"Reference",label:"引用"}];default:return[{value:"Reference",label:"引用"}]}},d=c=>{const p=Fo-c.level*_o;return a.jsx(a.Fragment,{children:a.jsx("div",{className:"jade-input-tree-title",children:a.jsxs(h.Row,{wrap:!1,children:[a.jsx(h.Col,{flex:"0 0 "+p+"px",children:a.jsx("div",{className:"jade-input-tree-title-child",style:{display:"flex",alignItems:"center"},children:a.jsx("span",{children:c.title})})}),a.jsx(h.Col,{flex:"0 0 70px",style:{paddingRight:0},children:a.jsx("div",{className:"jade-input-tree-title-child",children:a.jsx(Lo,{node:c,options:r(c),updateItem:n})})}),a.jsx(h.Col,{flex:"1 1 auto",children:a.jsx("div",{className:"jade-input-tree-title-child",children:l(c)})})]})})})};return a.jsx(a.Fragment,{children:a.jsx(h.ConfigProvider,{theme:{components:{Tree:{nodeSelectedBg:"transparent",nodeHoverBg:"transparent"}}},children:a.jsx(h.Tree,{blockNode:!0,treeData:t,className:"jade-ant-tree",titleRender:d,showLine:!0})})})}const Lo=({node:e,options:n,updateItem:t})=>{const o=i=>{i==="Expand"?t(e.id,[{key:"from",value:i},{key:"referenceNode",value:null},{key:"referenceId",value:null},{key:"referenceKey",value:null},{key:"value",value:e.props}]):i==="Input"?t(e.id,[{key:"from",value:i},{key:"referenceNode",value:null},{key:"referenceId",value:null},{key:"referenceKey",value:null},{key:"value",value:null}]):t(e.id,[{key:"from",value:i}])};return a.jsx(a.Fragment,{children:a.jsx(de,{style:{background:"#f7f7f7",width:"100%"},placeholder:"请选择",defaultValue:e.from,className:"jade-input-tree-title-select jade-select",onChange:o,options:n})})},{Panel:Mo}=h.Collapse;function Vr({data:e,updateItem:n}){return a.jsx(a.Fragment,{children:a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["jadeInputTreePanel"],children:a.jsx(Mo,{header:a.jsx("div",{children:a.jsx("span",{className:"jade-panel-header-font",children:"输入"})}),className:"jade-panel",children:a.jsx($r,{data:e,updateItem:n})},"jadeInputTreePanel")})})}const Ao=e=>{const n={};n.getJadeConfig=()=>e||{input:[{id:"uuid1",name:"person",type:"Object",from:"Expand",value:[{id:"uuid2",name:"name",type:"Object",from:"Expand",value:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}],props:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}]}],props:[{id:"uuid2",name:"name",type:"Object",from:"Expand",value:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}],props:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}]}]},{id:"uuid4",name:"school",type:"Object",from:"Reference",value:[],props:[{id:"uuid5",name:"schoolName",type:"String",value:"绵阳中学",from:"Input"}]}]},n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(Do,{})});const t=(o,i,s)=>o.map(l=>{const r={...l};return l.id===i?(s.forEach(d=>{r[d.key]=d.value}),r):(r.type==="Object"&&Array.isArray(r.value)&&(r.value=t(r.value,i,s)),r)});return n.reducers=(o,i)=>{switch(i.type){case"update":return{input:t(o.input,i.id,i.changes)};default:throw Error("Unknown action: "+i.type)}},n},Do=()=>{const e=Z(),n=G(),t=(o,i)=>{n({type:"update",id:o,changes:i})};return a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx(Vr,{data:e.input,updateItem:t})})})},zo=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="testNode",r.text="测试组件",r.componentName="testComponent",r.getHeaderIcon=()=>a.jsx(Ne,{}),r},Bo=e=>{const n={};return n.getJadeConfig=()=>e||[{name:"description",type:"String",value:"这是一个测试"}],n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx($o,{})}),n.reducers=(t,o)=>{if(o.type==="update")return[{...t[0],value:o.value}]},n},$o=e=>{const n=k.useRef(null),t=Z(),o=G(),i=()=>{o({type:"update",value:n.current.input.value})};return a.jsxs(a.Fragment,{children:[a.jsx("div",{children:a.jsx(h.Input,{ref:n,value:t[0].value,placeholder:"Basic usage",onChange:()=>i()})}),a.jsx(Vo,{...e})]})},Vo=e=>a.jsxs(a.Fragment,{children:[a.jsx("span",{children:e.a}),a.jsx("span",{children:e.b}),a.jsx("span",{children:e.c})]}),qo=e=>{const n={};return n.getJadeConfig=()=>e||[{name:"description",type:"String",value:"替换之前的输入框"}],n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(Wo,{})}),n.reducers=(t,o)=>{if(o.type==="update")return[{...t[0],value:o.value}]},n},Wo=()=>{const e=k.useRef(null),n=Z(),t=G(),o=()=>{t({type:"update",value:e.current.input.value})};return a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx(h.Input,{ref:e,value:n[0].value,placeholder:"Basic usage",onChange:()=>o()})})})},Uo=e=>w.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},w.createElement("desc",null,`
			Created with Pixso.
	`),w.createElement("defs",null,w.createElement("clipPath",{id:"clip4_13280"},w.createElement("rect",{id:"\\u56FE\\u6807/16/\\u5F00\\u59CB\\uFF0C\\u8D77\\u70B9\\uFF0C\\u7AEF\\u70B9",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),w.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#5E7CE0",fillOpacity:1}),w.createElement("g",{clipPath:"url(#clip4_13280)"},w.createElement("path",{id:"path",d:"M16.58 11.52L18.16 11.52L18.16 6.31L11.46 6.31C8.35 6.37 5.83 8.89 5.83 11.99C5.83 15.1 8.35 17.62 11.46 17.67L18.16 17.67L18.16 12.46L13.07 12.46L13.07 13.52L10.08 13.52L10.08 10.47L13.07 10.47L13.07 11.53L16.58 11.53L16.58 11.52Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),Ho=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);r.type="startNodeStart",r.text="开始",r.pointerEvents="auto",r.componentName="startComponent",r.deletable=!1,r.toolMenus=[{key:"1",label:"重命名",action:c=>{c(!0)}}],delete r.flowMeta.jober;const d=r.initConnectors;return r.initConnectors=()=>{d.apply(r),r.connectors.remove(c=>c.direction.key===ee.DIRECTION.W.key)},r.getComponent=()=>r.graph.plugins[r.componentName](r.flowMeta.inputParams),r.serializerJadeConfig=()=>{r.flowMeta.inputParams=r.getLatestJadeConfig()},r.getHeaderIcon=()=>a.jsx(h.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:a.jsx(Uo,{})}),r};qr.propTypes={itemId:L.string.isRequired,propValue:L.string.isRequired,onChange:L.func.isRequired};function qr({itemId:e,propValue:n,type:t,onChange:o}){return a.jsx(h.Form.Item,{className:"jade-form-item",label:"字段名称",name:"name",rules:[{required:!0,message:"参数名称不能为空"},{pattern:/^[^\s]*$/,message:"禁止输入空格"}],initialValue:n,children:a.jsx(Ot,{className:"jade-input",id:e,value:n,type:t,placeholder:"请输入字段名称",showCount:!0,maxLength:20,onChange:i=>o("name",i.target.value)})})}Wr.propTypes={propValue:L.string.isRequired,onChange:L.func.isRequired};function Wr({propValue:e,onChange:n}){const t=i=>{i.stopPropagation()},o=i=>{n("type",i),document.activeElement.blur()};return a.jsx(h.Form.Item,{className:"jade-form-item",label:"字段类型",name:"type",initialValue:e,children:a.jsx(de,{className:"jade-select",value:e,style:{width:"100%"},onClick:t,onChange:o,options:[{value:"String",label:"String"},{value:"Integer",label:"Integer"},{value:"Boolean",label:"Boolean"},{value:"Number",label:"Number"}]})})}const{TextArea:Ko}=h.Input;Ur.propTypes={propValue:L.string.isRequired,onChange:L.func.isRequired};function Ur({propValue:e,onChange:n}){return a.jsx(h.Form.Item,{className:"jade-form-item",label:"字段描述",name:"description",initialValue:e,children:a.jsx(Ko,{className:"jade-input",value:e,onChange:t=>n("description",t.target.value),placeholder:"请输入字段描述",autoSize:{minRows:4,maxRows:4}})})}Hr.propTypes={item:L.shape({id:L.string.isRequired,name:L.string.isRequired,type:L.string.isRequired,description:L.string.isRequired,from:L.string.isRequired,value:L.string.isRequired}).isRequired,formName:L.string.isRequired};function Hr({item:e,formName:n}){const t=G(),o=e.id,i=(s,l)=>{t({actionType:"changeInputParam",id:o,type:s,value:l})};return a.jsx(a.Fragment,{children:a.jsxs(h.Form,{name:n,labelCol:{span:8},wrapperCol:{span:24},style:{paddingTop:"8px",maxWidth:600},layout:"vertical",autoComplete:"off",children:[a.jsx(qr,{itemId:e.id,propValue:e.name,type:e.type,onChange:i}),a.jsx(Wr,{propValue:e.type,onChange:i}),a.jsx(Ur,{propValue:e.description,onChange:i})]})})}Kr.propTypes={propValue:L.string.isRequired,onValueChange:L.func.isRequired};function Kr({propValue:e,onValueChange:n}){const t=parseInt(e),o={1:"1",3:"默认",10:"10"};return a.jsx("div",{style:{display:"flex",alignItems:"center"},children:a.jsx(h.Slider,{style:{width:"95%"},min:1,max:10,defaultValue:3,marks:o,step:1,onChange:i=>n("Integer",i.toString()),value:isNaN(t)?3:t})})}Jr.propTypes={propValue:L.string.isRequired,onValueChange:L.func.isRequired};function Jr({propValue:e,onValueChange:n}){const t=parseFloat(e);return a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsx(h.Slider,{style:{width:"90%"},min:1,max:100,defaultValue:20,step:1,onChange:o=>n("Integer",o.toString()),value:isNaN(t)?20:t}),a.jsx("span",{style:{marginLeft:"8px"},children:t})]})}Yr.propTypes={propValue:L.string.isRequired,onValueChange:L.func.isRequired};function Yr({propValue:e,onValueChange:n}){const t=parseInt(e),o=i=>{const s=Math.floor(i);n("Integer",s.toString())};return a.jsx("div",{style:{display:"flex",alignItems:"center"},children:a.jsx(h.InputNumber,{style:{width:"100%"},min:1,max:1e4,step:100,onChange:o,stringMode:!0,value:isNaN(t)?1e3:t})})}Zr.propTypes={propValue:L.string.isRequired,onValueChange:L.func.isRequired};function Zr({propValue:e,onValueChange:n}){const t=e,o=l=>{l.stopPropagation()},i=(l,r)=>((r==null?void 0:r.label)??"").toLowerCase().includes(l.toLowerCase()),s=l=>{n("String",l),document.activeElement.blur()};return a.jsx(a.Fragment,{children:a.jsx(de,{showSearch:!0,className:"jade-select",style:{width:"100%"},onClick:o,onChange:s,filterOption:i,options:[{value:"oneHour",label:"近1小时"},{value:"sixHour",label:"近6小时"},{value:"twelveHour",label:"近12小时"},{value:"oneDay",label:"近1天"},{value:"twoDays",label:"近2天"},{value:"oneWeek",label:"近1周"}],value:t})})}Gr.propTypes={propValue:L.oneOfType([L.string,L.oneOf([null])]),onValueChange:L.func.isRequired,config:L.object.isRequired};function Gr({propValue:e,onValueChange:n,config:t}){const o=e,[i,s]=k.useState([]),l=c=>{c.stopPropagation()},r=(c,p)=>((p==null?void 0:p.label)??"").toLowerCase().includes(c.toLowerCase()),d=c=>{n("String",c),document.activeElement.blur()};return k.useEffect(()=>{Pe.get(t.urls.customHistoryUrl,{},c=>s(c.data.map(p=>({value:p.fitableId,label:p.name}))))},[]),a.jsx(a.Fragment,{children:a.jsx(de,{allowClear:!0,showSearch:!0,className:"jade-select",style:{width:"100%"},onClick:l,onChange:d,filterOption:r,placeholder:"选择合适的获取历史记录服务",options:i,value:o})})}Xr.propTypes={config:L.object.isRequired};function Xr({config:e}){const n=G(),t=Z(),o=t.find(c=>c.name==="memory").value.find(c=>c.name==="type").value,i=t.find(c=>c.name==="memory").value.find(c=>c.name==="value").value,s=c=>{c.stopPropagation()},l=(c,p)=>{n({actionType:"changeMemory",memoryType:o,memoryValueType:c,memoryValue:p})},r=()=>{switch(o){case"ByConversationTurn":return a.jsx(Kr,{propValue:i,onValueChange:l});case"ByNumber":return a.jsx(Jr,{propValue:i,onValueChange:l});case"ByTokenSize":return a.jsx(Yr,{propValue:i,onValueChange:l});case"ByTime":return a.jsx(Zr,{propValue:i,onValueChange:l});case"Customizing":return a.jsx(Gr,{propValue:i,onValueChange:l,config:e});case"UserSelect":return null;case"NotUseMemory":return null;default:return null}},d=c=>{let p="",g=null;switch(c){case"ByConversationTurn":p="Integer",g="3";break;case"ByNumber":p="Integer",g="20";break;case"ByTokenSize":p="Integer",g="1000";break;case"ByTime":p="String",g="oneHour";break;case"Customizing":p="String";break}n({actionType:"changeMemory",memoryType:c,memoryValueType:p,memoryValue:g}),document.activeElement.blur()};return a.jsxs(a.Fragment,{children:[a.jsx(de,{className:"jade-select",defaultValue:o,style:{width:"100%",marginBottom:"8px",marginTop:"8px"},onClick:s,onChange:c=>d(c),options:[{value:"ByConversationTurn",label:"按对话轮次"},{value:"Customizing",label:"自定义"},{value:"UserSelect",label:"用户自勾选"},{value:"NotUseMemory",label:"不使用历史记录"}]}),r()," "]})}const{Panel:Qr}=h.Collapse;function Jo(){const e=G(),n=Z(),t=te().graph.configs.find(p=>p.node==="startNodeStart"),i=n.find(p=>p.name==="input").value,[s,l]=k.useState(()=>i.map(p=>p.id)),r=()=>{const p="input_"+_();l([...s,p]),e({actionType:"addInputParam",id:p})},d=p=>{const g=s.filter(y=>y!==p);l(g),e({actionType:"deleteInputParam",id:p})},c=a.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[a.jsx("p",{children:"定义启动工作流所需的输入参数，这些内容将由"}),a.jsx("p",{children:"大模型在机器人对话过程中读取，允许大模型"}),a.jsx("p",{children:"在适当的时间启动工作流并填写正确的信息。"})]});return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px",paddingLeft:"8px",paddingRight:"4px"},children:[a.jsx("div",{className:"jade-panel-header-font",children:"输入"}),a.jsx(h.Popover,{content:c,children:a.jsx(ve,{className:"jade-top-header-popover-content"})}),a.jsx(h.Button,{type:"text",className:"icon-button",onClick:r,style:{height:"32px",marginLeft:"76%"},children:a.jsx(at,{})})]}),a.jsx(h.Collapse,{bordered:!1,activeKey:s,onChange:p=>l(p),className:"jade-collapse-custom-background-color",children:i.map(p=>a.jsx(Qr,{header:a.jsxs("div",{className:"panel-header",children:[a.jsx("span",{className:"jade-panel-header-font",children:p.name})," ",a.jsx(h.Button,{type:"text",className:"icon-button",style:{height:"22px",marginLeft:"auto"},onClick:()=>d(p.id),children:a.jsx(Da,{})})]}),className:"jade-panel",style:{marginBottom:8,borderRadius:"8px",width:"100%"},children:a.jsx(Hr,{item:p,formName:"startForm"+p.id})},p.id))}),a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["historicalRecordsPanel"],children:a.jsx(Qr,{header:a.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:a.jsx("span",{className:"jade-panel-header-font",children:"历史记录"})}),className:"jade-panel",style:{width:"100%"},children:a.jsx(Xr,{config:t})},"historicalRecordsPanel")})]})}const Yo=e=>{const n={};return n.getJadeConfig=()=>e||[{id:_(),name:"input",type:"Object",from:"Expand",value:[{id:"input_"+_(),name:"Question",type:"String",from:"Input",description:"",value:""}]},{id:_(),name:"memory",type:"Object",from:"Expand",value:[{id:_(),name:"type",type:"String",from:"Input",value:"ByConversationTurn"},{id:_(),name:"value",type:"Integer",from:"Input",value:"3"}]}],n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(Zo,{})}),n.reducers=(t,o)=>{function i(){return t.map(d=>d.name==="input"?{...d,value:[...d.value,{id:o.id,name:"",type:"string",from:"init",description:"",value:""}]}:d)}function s(){return t.map(d=>d.name==="input"?{...d,value:d.value.map(c=>c.id===o.id?{...c,[o.type]:o.value}:c)}:d)}function l(){return t.map(d=>d.name==="memory"?{...d,value:d.value.map(c=>c.name==="type"?{...c,value:o.memoryType}:c.name==="value"?{...c,type:o.memoryValueType,value:o.memoryValue}:c)}:d)}function r(){return t.map(d=>d.name==="input"?{...d,value:d.value.filter(c=>c.id!==o.id)}:d)}switch(o.actionType){case"addInputParam":return i();case"changeInputParam":return s();case"changeMemory":return l();case"deleteInputParam":return r();default:throw Error("Unknown action: "+o.type)}},n},Zo=()=>a.jsx(a.Fragment,{children:a.jsx(Jo,{})}),Go=e=>w.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},w.createElement("desc",null,`
			Created with Pixso.
	`),w.createElement("defs",null,w.createElement("clipPath",{id:"clip4_13238"},w.createElement("rect",{id:"\\u56FE\\u6807/16/\\u5927\\u6A21\\u578B",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),w.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#047BFC",fillOpacity:1}),w.createElement("g",{clipPath:"url(#clip4_13238)"},w.createElement("path",{id:"path",d:"M12 4.66L18.33 8.33L18.33 15.66L11.99 19.33L5.66 15.66L5.66 8.33L12 4.66ZM8.33 10.64L11.33 12.38L11.33 15.75L12.66 15.75L12.66 12.38L15.66 10.64L15 9.49L12 11.23L9 9.49L8.33 10.64Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),Xo=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="llmNodeState",r.text="大模型",r.pointerEvents="auto",r.componentName="llmComponent",r.flowMeta.jober.fitables.push("com.huawei.fit.jober.aipp.fitable.LLMComponent"),r.flowMeta.jober.isAsync="true",r.getHeaderIcon=()=>a.jsx(h.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:a.jsx(Go,{})}),r},{TextArea:Qo}=h.Input,{Panel:ei}=h.Collapse;en.propTypes={modelOptions:L.array.isRequired};function en({modelOptions:e}){const n=te(),t=Z(),o=G(),i=t.inputParams.find(p=>p.name==="model"),s=t.inputParams.find(p=>p.name==="temperature"),l=t.inputParams.filter(p=>p.name==="prompt").flatMap(p=>p.value).find(p=>p.name==="template"),r=p=>{p.stopPropagation()},d=a.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[a.jsx("p",{children:"用于控制生成文本的大型模型的随机性。"}),a.jsx("p",{children:"当设置较高时，模型将生成更多样化的文本，增加不确定性；"}),a.jsx("p",{children:"当设置较低时，模型将生成高概率词，减少不确定性。"})]}),c=a.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[a.jsx("p",{children:"编辑大模型的提示词，实现相应的功能。"}),a.jsxs("p",{children:["可以使用","{{变量名}}","从输入参数中引入变量。"]})]});return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["modelPanel"],children:a.jsx(ei,{header:a.jsx("div",{className:"panel-header",children:a.jsx("span",{className:"jade-panel-header-font",children:"大模型"})}),className:"jade-panel",children:a.jsxs(h.Form,{name:`modelForm-${n.id}`,layout:"vertical",className:"jade-form",children:[a.jsxs(h.Row,{gutter:16,children:[a.jsx(h.Col,{span:12,children:a.jsx(h.Form.Item,{className:"jade-form-item",name:"model",label:"模型",initialValue:i.value,children:a.jsx(de,{className:"jade-select",onClick:r,onChange:p=>o({actionType:"changeConfig",id:i.id,value:p}),options:e})})}),a.jsx(h.Col,{span:12,children:a.jsx(h.Form.Item,{className:"jade-form-item",name:"temperature",label:a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsx("span",{className:"jade-second-title",children:"温度"}),a.jsx(h.Popover,{content:d,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})})]}),rules:[{required:!0,message:"请输入0-1之间的参数!"}],initialValue:s.value,children:a.jsx(h.InputNumber,{className:"jade-input",style:{width:"100%"},min:0,max:1,step:.1,onChange:p=>o({actionType:"changeConfig",id:s.id,value:p}),stringMode:!0})})})]}),a.jsx(h.Row,{gutter:16,children:a.jsx(h.Col,{span:24,children:a.jsx(h.Form.Item,{className:"jade-form-item",name:"propmt",label:a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsx("span",{className:"jade-second-title",children:"提示词模板"}),a.jsx(h.Popover,{content:[c],children:a.jsx(ve,{className:"jade-panel-header-popover-content"})})]}),rules:[{required:!0,message:"参数不能为空"}],initialValue:l.value,children:a.jsx(Qo,{className:"jade-input jade-font-size",onChange:p=>o({actionType:"changePrompt",id:l.id,value:p.target.value}),placeholder:"你可以用{{variable name}}来关联输入中的变量名",autoSize:{minRows:4,maxRows:4}})})})})]})},"modelPanel")})}const{Panel:ti}=h.Collapse;tn.propTypes={items:L.array.isRequired,addItem:L.func.isRequired,updateItem:L.func.isRequired,deleteItem:L.func.isRequired};function tn({items:e,addItem:n,updateItem:t,deleteItem:o}){const i=te(),s=()=>{n(_())},l=(f,v,m)=>{const b=[{key:f,value:v}];f==="from"&&(b.push({key:"value",value:""}),b.push({key:"referenceNode",value:""}),b.push({key:"referenceId",value:""}),b.push({key:"referenceKey",value:""}),document.activeElement.blur()),t(m,b)},r=(f,v)=>{t(f.id,[{key:"referenceKey",value:v}])},d=(f,v)=>{t(f.id,[{key:"referenceNode",value:v.referenceNode},{key:"referenceId",value:v.referenceId},{key:"value",value:v.value}])},c=f=>{o(f)},p=a.jsx("div",{children:a.jsx("p",{children:"输入需要添加到提示词模板中的信息，可被提示词模板引用"})}),g=f=>{f.stopPropagation()},y=f=>{switch(f.from){case"Reference":return a.jsx(h.Form.Item,{id:`value-${f.id}`,children:a.jsx(We,{className:"value-custom jade-select",reference:f,onReferencedValueChange:v=>r(f,v),onReferencedKeyChange:v=>d(f,v)})});case"Input":return a.jsx(h.Form.Item,{id:`value-${f.id}`,name:`value-${f.id}`,rules:[{required:!0,message:"字段值不能为空"},{pattern:/^[^\s]*$/,message:"禁止输入空格"}],initialValue:f.value,children:a.jsx(h.Input,{className:"value-custom jade-input",value:f.value,onChange:v=>l("value",v.target.value,f.id)})});default:return a.jsx(a.Fragment,{})}};return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["inputPanel"],children:a.jsx(ti,{header:a.jsxs("div",{className:"panel-header",children:[a.jsx("span",{className:"jade-panel-header-font",children:"输入"}),a.jsx(h.Popover,{content:p,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})}),a.jsx(h.Button,{type:"text",className:"icon-button",style:{height:"22px",marginLeft:"76%",marginRight:"0"},onClick:f=>{s(),g(f)},children:a.jsx(at,{})})]}),className:"jade-panel",children:a.jsxs(h.Form,{name:`inputForm-${i.id}`,layout:"vertical",className:"jade-form",children:[a.jsxs(h.Row,{gutter:16,children:[a.jsx(h.Col,{span:8,children:a.jsx(h.Form.Item,{children:a.jsx("span",{className:"jade-font-size jade-font-color",children:"字段名称"})})}),a.jsx(h.Col,{span:16,children:a.jsx(h.Form.Item,{children:a.jsx("span",{className:"jade-font-size jade-font-color",children:"字段值"})})})]}),e.map(f=>a.jsxs(h.Row,{gutter:16,children:[a.jsx(h.Col,{span:8,children:a.jsx(h.Form.Item,{id:`name-${f.id}`,name:`name-${f.id}`,rules:[{pattern:/^[a-zA-Z_][a-zA-Z0-9_]*$/,message:"只能包含字母、数字或下划线，且必须以字母或下划线开头"}],initialValue:f.name,children:a.jsx(h.Input,{className:"jade-input",style:{paddingRight:"12px"},value:f.name,onChange:v=>l("name",v.target.value,f.id)})})}),a.jsx(h.Col,{span:6,style:{paddingRight:0},children:a.jsx(h.Form.Item,{id:`from-${f.id}`,initialValue:"Reference",children:a.jsx(de,{id:`from-select-${f.id}`,className:"value-source-custom jade-select",style:{width:"100%"},onChange:v=>l("from",v,f.id),options:[{value:"Reference",label:"引用"},{value:"Input",label:"输入"}],value:f.from})})}),a.jsxs(h.Col,{span:8,style:{paddingLeft:0},children:[y(f)," "]}),a.jsx(h.Col,{span:2,style:{paddingLeft:0},children:a.jsx(h.Form.Item,{children:a.jsx(h.Button,{type:"text",className:"icon-button",style:{height:"100%"},onClick:()=>c(f.id),children:a.jsx(wr,{})})})})]},f.id))]})},"inputPanel")})}const{Panel:ri}=h.Collapse;function ni(){const e=te(),n=Z(),o=n.outputParams,i=a.jsx("div",{className:"jade-font-size",children:a.jsx("p",{children:"大模型运行完成后生成的内容。"})});return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["outputPanel"],children:a.jsx(ri,{header:a.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[a.jsx("span",{className:"jade-panel-header-font",children:"输出"}),a.jsx(h.Popover,{content:i,children:a.jsx(ve,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:a.jsx(h.Form,{name:`outputForm-${e.id}`,layout:"vertical",className:"jade-form",children:a.jsx(Ue,{data:o})})},"outputPanel")})}const{Panel:ai}=h.Collapse;rn.propTypes={toolOptions:L.array.isRequired,workflowOptions:L.array.isRequired,config:L.object.isRequired};function rn({toolOptions:e,workflowOptions:n,config:t}){const o=te(),i=Z(),s=G(),l=i.inputParams.find(g=>g.name==="tools"),r=i.inputParams.find(g=>g.name==="workflows"),d=g=>{!t||!t.params||!t.params.tenantId||!t.params.appId?console.error("Cannot get config.params.tenantId or config.params.appId."):(window.open("/aipp/"+t.params.tenantId+"/addFlow/"+t.params.appId,"_blank"),g.stopPropagation())},c=(g,y)=>((y==null?void 0:y.label)??"").toLowerCase().includes(g.toLowerCase()),p=(g,y)=>{s({actionType:"changeSkillConfig",id:g,value:y})};return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["skillPanel"],children:a.jsx(ai,{header:a.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:a.jsx("span",{className:"jade-panel-header-font",children:"技能"})}),className:"jade-panel",children:a.jsxs(h.Form,{name:`skillForm-${o.id}`,layout:"vertical",className:"jade-form",children:[a.jsx(h.Row,{gutter:16,style:{marginBottom:"6px",marginRight:0,marginLeft:"-3%"},children:a.jsx(h.Col,{span:21,children:a.jsx("span",{className:"jade-font-size jade-font-color",style:{marginLeft:"6px"},children:"工具"})})}),a.jsx(h.Form.Item,{children:a.jsx(de,{mode:"multiple",showSearch:!0,allowClear:!0,className:"jade-select",placeholder:"选择合适的工具",filterOption:c,optionFilterProp:"label",value:l.value,onMouseDown:g=>g.stopPropagation(),onChange:g=>p(l.id,g),options:[{value:"tool1",label:"查天气"},{value:"tool2",label:"查新闻"},{value:"tool3",label:"查电影"}]})}),a.jsxs(h.Row,{gutter:16,style:{marginBottom:"6px",marginRight:0,marginLeft:"-3%"},children:[a.jsx(h.Col,{span:22,children:a.jsx("span",{className:"jade-font-size jade-font-color",style:{marginLeft:"6px"},children:"工具流"})}),a.jsx(h.Col,{span:2,style:{paddingLeft:"3%"},children:a.jsx(h.Button,{type:"text",className:"icon-button",style:{height:"22px"},onClick:g=>{d(g)},children:a.jsx(at,{})})})]}),a.jsx(h.Form.Item,{children:a.jsx(de,{mode:"multiple",showSearch:!0,allowClear:!0,className:"jade-select",placeholder:"选择合适的工具流",filterOption:c,optionFilterProp:"label",value:r.value,onChange:g=>p(r.id,g),options:[{value:"flow1",label:"撰写经营分析报告"},{value:"flow2",label:"发送邮件"},{value:"flow3",label:"面试问题"},{value:"flow4",label:"面试总结"},{value:"flow5",label:"文件提取"}]})})]})},"skillPanel")})}function oi(){const e=G(),n=Z(),t=te();let o;!t||!t.graph||!t.graph.configs?console.error("Cannot get shape.graph.configs."):o=t.graph.configs.find(v=>v.node==="llmNodeState");const[i,s]=k.useState([]),[l,r]=k.useState([]),[d,c]=k.useState([]),p=()=>n.inputParams.filter(v=>v.name==="prompt").flatMap(v=>v.value).filter(v=>v.name==="variables").flatMap(v=>v.value),g=v=>{e({actionType:"addInputParam",id:v})},y=(v,m)=>{e({actionType:"changeInputParams",id:v,updateParams:m})},f=v=>{e({actionType:"deleteInputParam",id:v})};return k.useEffect(()=>{!o||!o.urls?console.error("Cannot get config.urls."):(o.urls.llmModelEndpoint?Pe.get(o.urls.llmModelEndpoint+"/model-gateway/v1/models",{},v=>s(v.data.map(m=>({value:m.id,label:m.id})))):console.error("Cannot get config.urls.llmModelEndpoint."),o.urls.toolListEndpoint?Pe.get(o.urls.toolListEndpoint+"/queryToolGroupsInfo?category=App&tag=Tool&offset=0&limit=10",{},v=>r(v.map(m=>({value:m.hash,label:m.name})))):console.error("Cannot get config.urls.toolListEndpoint."),o.urls.workflowListEndpoint?Pe.get(o.urls.workflowListEndpoint+"/queryToolGroupsInfo?category=App&tag=Workflow&offset=0&limit=10",{},v=>c(v.map(m=>({value:m.hash,label:m.name})))):console.error("Cannot get config.urls.workflowListEndpoint."))},[]),a.jsxs("div",{children:[a.jsx(tn,{items:p(),addItem:g,updateItem:y,deleteItem:f}),a.jsx(en,{modelOptions:i}),a.jsx(rn,{toolOptions:l,workflowOptions:d,config:o}),a.jsx(ni,{})]})}const ii=e=>{const n={};return n.getJadeConfig=()=>e||{inputParams:[{id:_(),name:"model",type:"String",from:"Input",value:""},{id:_(),name:"temperature",type:"Number",from:"Input",value:"0.3"},{id:_(),name:"prompt",type:"Object",from:"Expand",value:[{id:_(),name:"template",type:"String",from:"Input",value:""},{id:_(),name:"variables",type:"Object",from:"Expand",value:[{id:_(),name:"",type:"String",from:"Reference",value:"",referenceNode:"",referenceId:"",referenceKey:""}]}]},{id:_(),name:"tools",type:"Array",from:"Input",value:[]},{id:_(),name:"workflows",type:"Array",from:"Input",value:[]},{id:_(),name:"systemPrompt",type:"String",from:"Input",value:""}],outputParams:[{id:_(),name:"output",type:"Object",from:"Expand",value:[{id:_(),name:"llmOutput",type:"string",from:"Input",description:"",value:""}]}]},n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(si,{})}),n.reducers=(t,o)=>{function i(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="inputParams"?y[f]=v.map(m=>m.name==="prompt"?{...m,value:m.value.map(b=>b.name==="variables"?{...b,value:[...b.value,{id:o.id,name:"",type:"String",from:"Reference",value:""}]}:b)}:m):y[f]=v}),y}function s(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="outputParams"?y[f]=v.map(m=>m.name==="output"?{...m,value:[...m.value,{id:o.id,name:"",type:"string",from:"Input",description:"",value:""}]}:m):y[f]=v}),y}function l(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="inputParams"?y[f]=v.map(m=>m.name==="prompt"?{...m,value:m.value.map(b=>b.name==="variables"?{...b,value:b.value.map(C=>{if(C.id===o.id){let I={...C};return o.updateParams.map($=>{I[$.key]=$.value}),I}else return C})}:b)}:m):y[f]=v}),y}function r(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="inputParams"?y[f]=v.map(m=>m.name==="prompt"?{...m,value:m.value.map(b=>o.id===b.id&&b.name==="template"?{...b,value:o.value}:b)}:m):y[f]=v}),y}function d(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="outputParams"?y[f]=v.map(m=>m.name==="output"?{...m,value:m.value.map(b=>b.id===o.id?{...b,[o.type]:o.value}:b)}:m):y[f]=v}),y}function c(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="inputParams"?y[f]=v.map(m=>m.id===o.id?{...m,value:o.value}:m):y[f]=v}),y}function p(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="inputParams"?y[f]=v.map(m=>m.id===o.id?{...m,value:o.value.map(b=>({id:_(),type:"String",from:"Input",value:b}))}:m):y[f]=v}),y}function g(){const y={};return Object.entries(t).forEach(([f,v])=>{f==="inputParams"?y[f]=v.map(m=>m.name==="prompt"?{...m,value:m.value.map(b=>b.name==="variables"?{...b,value:b.value.filter(C=>C.id!==o.id)}:b)}:m):y[f]=v}),y}switch(o.actionType){case"addInputParam":return i();case"addOutputParam":return s();case"changeInputParams":return l();case"changeOutputParam":return d();case"changeConfig":return c();case"changeSkillConfig":return p();case"changePrompt":return r();case"deleteInputParam":return g();case"deleteOutputParam":return t.filter(y=>y.id!==o.id);default:throw Error("Unknown action: "+o.type)}},n},si=()=>a.jsx(a.Fragment,{children:a.jsx(oi,{})}),li=e=>w.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},w.createElement("desc",null,`
			Created with Pixso.
	`),w.createElement("defs",null,w.createElement("clipPath",{id:"clip4_13297"},w.createElement("rect",{id:"\\u56FE\\u6807/16/\\u68C0\\u67E5\\u5217\\u8868",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),w.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#A97AF8",fillOpacity:1}),w.createElement("g",{clipPath:"url(#clip4_13297)"},w.createElement("path",{id:"path",d:"M15 7.68L14.98 7.68C14.78 7.48 14.78 7.17 14.98 6.97C15.17 6.78 15.48 6.78 15.68 6.97L15.68 7L15 7.68ZM18.32 9.64L18.35 9.64C18.55 9.84 18.55 10.15 18.35 10.35C18.15 10.55 17.84 10.55 17.64 10.35L17.64 10.32L18.32 9.64Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M15.33 7.33L18 10",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),w.createElement("path",{id:"path",d:"M15.68 10.32L15.68 10.35C15.48 10.55 15.17 10.55 14.98 10.35C14.78 10.15 14.78 9.84 14.98 9.64L15 9.64L15.68 10.32ZM17.64 7L17.64 6.97C17.84 6.78 18.15 6.78 18.35 6.97C18.55 7.17 18.55 7.48 18.35 7.68L18.32 7.68L17.64 7Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M15.33 10L18 7.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),w.createElement("path",{id:"path",d:"M18.29 13.69L18.29 13.67C18.47 13.46 18.78 13.43 18.99 13.62C19.2 13.8 19.22 14.11 19.04 14.32L19.01 14.33L18.29 13.69ZM14.67 15.68L14.64 15.68C14.44 15.48 14.44 15.17 14.64 14.97C14.84 14.78 15.15 14.78 15.35 14.97L15.35 15L14.67 15.68Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M18.66 14L16.33 16.66L15 15.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),w.createElement("path",{id:"path",d:"M12.66 7.33L5.33 7.33L5.33 10L12.66 10L12.66 7.33Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M5.33 7.33L5.33 10L12.66 10L12.66 7.33L5.33 7.33Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}),w.createElement("path",{id:"path",d:"M12.66 14L5.33 14L5.33 16.66L12.66 16.66L12.66 14Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M5.33 14L5.33 16.66L12.66 16.66L12.66 14L5.33 14Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}))),ci=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);return r.type="manualCheckNodeState",r.text="人工检查",r.pointerEvents="auto",r.componentName="manualCheckComponent",r.flowMeta.triggerMode="manual",r.getHeaderIcon=()=>a.jsx(h.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:a.jsx(li,{})}),r};function ui(){return a.jsx(a.Fragment,{children:a.jsx(h.Empty,{image:h.Empty.PRESENTED_IMAGE_DEFAULT})})}const{Panel:nn}=h.Collapse;function di(){const e=te(),n=G(),t=Z(),o=te().graph.configs.find(g=>g.node==="manualCheckNodeState"),i=t.inputParams.find(g=>g.name==="formName").value,s=t.outputParams,[l,r]=k.useState([]);k.useEffect(()=>{Pe.get(o.urls.runtimeFormUrl,{},g=>r(g.data.map(y=>({value:y.name,label:y.name}))))},[]);const d=()=>i&&i.length>0?e.graph.plugins[i]().getReactComponents():a.jsx(ui,{}),c=g=>{let y="";g&&g.length>0&&(y=e.graph.plugins[g]().getJadeConfig()),n({actionType:"changeFormAndSetOutput",formName:g,formOutput:y})},p=()=>!s||!Array.isArray(s)||!s.length>0?null:a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["manualCheckOutputPanel"],children:a.jsx(nn,{header:a.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:a.jsx("span",{className:"jade-panel-header-font",children:"输出"})}),className:"jade-panel",children:a.jsx(Ue,{data:s})},"manualCheckOutputPanel")});return a.jsxs("div",{children:[a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["manualCheckFormPanel"],children:a.jsx(nn,{header:a.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:a.jsx("span",{className:"jade-panel-header-font",children:"表单"})}),className:"jade-panel",style:{marginBottom:8,borderRadius:"8px",width:"100%"},children:a.jsx(h.Form,{name:`manualCheckForm-${e.id}`,layout:"vertical",className:"jade-form",children:a.jsxs(h.Form.Item,{children:[a.jsx(de,{allowClear:!0,className:"jade-select",defaultValue:i,style:{width:"100%",marginBottom:"8px"},onChange:g=>c(g),options:l}),d()," "]})})},"manualCheckFormPanel")}),p()]})}const fi=e=>{const n={};return n.getJadeConfig=()=>e||{inputParams:[{id:_(),name:"formName",type:"Object",from:"Input",value:""}],outputParams:[]},n.getReactComponents=()=>a.jsx(a.Fragment,{children:a.jsx(pi,{})}),n.reducers=(t,o)=>{function i(){return{...t,inputParams:t.inputParams.map(s=>s.name==="formName"?{...s,value:o.formName}:s),outputParams:o.formOutput}}switch(o.actionType){case"changeFormAndSetOutput":return i();default:throw Error("Unknown action: "+o.type)}},n},pi=()=>a.jsx(a.Fragment,{children:a.jsx(di,{})}),mi=e=>w.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},w.createElement("desc",null,`
			Created with Pixso.
	`),w.createElement("defs",null,w.createElement("clipPath",{id:"clip4_13318"},w.createElement("rect",{id:"\\u56FE\\u6807/16/API \\u63A5\\u53E3",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),w.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#FA9941",fillOpacity:1}),w.createElement("g",{clipPath:"url(#clip4_13318)"},w.createElement("path",{id:"path",d:"M16.33 11.33L15.33 12.33L11.66 8.66L12.66 7.66C13.16 7.16 14.99 6.33 16.33 7.66C17.66 9 16.83 10.83 16.33 11.33Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M15.33 12.33L11.66 8.66L12.66 7.66C13.16 7.16 14.99 6.33 16.33 7.66C17.66 9 16.83 10.83 16.33 11.33L15.33 12.33Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}),w.createElement("path",{id:"path",d:"M16.68 7.99L16.68 8.02C16.48 8.21 16.17 8.21 15.98 8.02C15.78 7.82 15.78 7.51 15.98 7.31L16 7.31L16.68 7.99ZM17.64 5.67L17.64 5.64C17.84 5.44 18.15 5.44 18.35 5.64C18.55 5.84 18.55 6.15 18.35 6.35L18.32 6.35L17.64 5.67Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M16.33 7.66L18 5.99",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),w.createElement("path",{id:"path",d:"M7.66 12.66L8.66 11.66L12.33 15.33L11.33 16.33C10.83 16.83 9 17.66 7.66 16.33C6.33 15 7.16 13.16 7.66 12.66Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M8.66 11.66L12.33 15.33L11.33 16.33C10.83 16.83 9 17.66 7.66 16.33C6.33 15 7.16 13.16 7.66 12.66L8.66 11.66Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}),w.createElement("path",{id:"path",d:"M12.01 14.99L12.01 15.02C11.82 15.21 11.51 15.21 11.31 15.02C11.11 14.82 11.11 14.51 11.31 14.31L11.34 14.31L12.01 14.99ZM12.64 13L12.64 12.97C12.84 12.78 13.15 12.78 13.35 12.97C13.55 13.17 13.55 13.48 13.35 13.68L13.32 13.68L12.64 13Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M11.66 14.66L12.99 13.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),w.createElement("path",{id:"path",d:"M6.35 18.32L6.35 18.35C6.15 18.55 5.84 18.55 5.64 18.35C5.44 18.15 5.44 17.84 5.64 17.64L5.67 17.64L6.35 18.32ZM7.31 16L7.31 15.97C7.51 15.78 7.82 15.78 8.02 15.97C8.21 16.17 8.21 16.48 8.02 16.68L7.99 16.68L7.31 16Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M6 18L7.66 16.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),w.createElement("path",{id:"path",d:"M9.68 12.65L9.68 12.68C9.48 12.88 9.17 12.88 8.98 12.68C8.78 12.48 8.78 12.17 8.98 11.97L9 11.97L9.68 12.65ZM10.31 10.67L10.31 10.64C10.51 10.44 10.82 10.44 11.02 10.64C11.21 10.84 11.21 11.15 11.02 11.35L10.99 11.35L10.31 10.67Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),w.createElement("path",{id:"path",d:"M9.33 12.33L10.66 11",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}))),hi=(e,n,t,o,i,s,l)=>{const r=ce(e,n,t,o,i,s,l);r.type="fitInvokeNodeState",r.width=360,r.backColor="white",r.pointerEvents="auto",r.text="FIT调用",r.componentName="fitInvokeComponent",r.flowMeta.triggerMode="auto",r.flowMeta.jober.type="GENERICABLE_JOBER";const d={genericable:{id:"",params:[]}},c=r.serializerJadeConfig;return r.serializerJadeConfig=()=>{c.apply(r);const p=r.flowMeta.jober.converter.entity.fitable.value.find(g=>g.name==="id").value;p&&(r.flowMeta.jober.fitables=[p]),d.genericable.params=r.flowMeta.jober.converter.entity.inputParams.map(g=>({name:g.name})),d.genericable.id=r.flowMeta.jober.converter.entity.genericable.value.find(g=>g.name==="id").value,r.flowMeta.jober.entity=d},r.getHeaderIcon=()=>a.jsx(h.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:a.jsx(mi,{})}),r};function gi(){const e=G(),n=Z(),t=n&&n.inputParams,o=(i,s)=>{e({type:"update",id:i,changes:s})};return a.jsx(Vr,{data:t,updateItem:o})}function vi(){const e=G(),n=te(),t=n.graph.configs&&n.graph.configs.find(l=>l.node==="fitInvokeState").urls.serviceListEndpoint,o=l=>t+"?pageNum="+l+"&pageSize=10",i=(l,r)=>{e({type:"selectGenericable",value:l})},s=l=>l.map(r=>({value:r,label:r}));return a.jsx(h.Form.Item,{name:"必选",label:a.jsx("span",{style:{color:"red"}}),rules:[{required:!0,message:"请选择一个服务"}],colon:!1,children:a.jsx(Pt,{className:"jade-select-genericable",placeholder:"请选择一个服务",onChange:i,buildUrl:o,disabled:!1,getOptions:s,dealResponse:l=>l.data})})}function yi(){const e=G(),n=Z(),t=te(),o=n&&n.genericable.value,i=t.graph.configs.find(c=>c.node==="fitInvokeState").urls.fitableMetaInfoUrl,s=o.find(c=>c.name==="id").value==="",l=c=>i+o+"?pageNum="+c+"pageSize=10",r=(c,p)=>{e({type:"selectFitable",value:p.find(g=>g.name===c)})},d=c=>c.map(p=>({value:p.name,label:p.name}));return a.jsx(h.Form.Item,{name:"必选",label:a.jsx("span",{style:{color:"red"}}),rules:[{required:!0,message:"请选择一个服务，再选择实现"}],colon:!1,children:a.jsx(Pt,{className:"jade-select-tool",placeholder:"请选择一个服务，再选择实现",onChange:r,buildUrl:l,disabled:s,getOptions:d,dealResponse:c=>c.data})})}const{Panel:bi}=h.Collapse;function xi(){return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["FitInvokeService"],children:a.jsxs(bi,{className:"jade-panel",header:a.jsx("div",{style:{display:"flex",alignItems:"center"},children:a.jsx("span",{className:"title",children:"FIT服务"})}),children:[a.jsx("div",{style:{marginTop:"8px"},children:a.jsx("span",{className:"select-genericable",children:"选择服务"})}),a.jsx(vi,{}),a.jsx("div",{style:{marginTop:"8px"},children:a.jsx("span",{className:"select-fitable",children:"选择实现"})}),a.jsx(yi,{})]},"FitInvokeService")})}const{Panel:ji}=h.Collapse;function Ci(){const e=Z(),n=e&&e.outputParams;return a.jsx(h.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["FitInvokeOutput"],children:a.jsx(ji,{className:"jade-panel",header:a.jsx("div",{style:{display:"flex",alignItems:"center"},children:a.jsx("span",{className:"title",children:"输出"})}),children:a.jsx(Ue,{data:n})},"FitInvokeOutput")})}const wi=e=>{const n={};n.getJadeConfig=()=>e||{inputParams:[],genericable:{id:"genericable_"+_(),name:"genericable",type:"Object",from:"Expand",value:[{id:_(),name:"id",type:"String",from:"Input",value:""}]},fitable:{id:"fitable_"+_(),name:"fitable",type:"Object",from:"Expand",value:[{id:_(),name:"id",type:"String",from:"Input",value:""}]},outputParams:[]},n.getReactComponents=()=>a.jsxs(a.Fragment,{children:[a.jsx(gi,{}),a.jsx(xi,{}),a.jsx(Ci,{})]});const t=s=>{const l={id:"output_"+_(),name:"output",type:"",value:[]};if(s.return.type==="object"){l.type="Object";const r=s.return.properties;for(const d in r){const c=r[d];c.type==="object"?l.value.push(...o(d,c)):l.value.push({id:_(),name:d,type:c.type.capitalize(),value:c.type.capitalize()})}}else l.type=s.return.type.capitalize();return l};function o(s,l){const r=[];if(l.type==="object")for(const d in l.properties){const c=l.properties[d];c.type==="object"?r.push(...o(d,c)):r.push({id:_(),name:d,type:c.type.capitalize(),value:c.type.capitalize()})}return[{id:"output_"+_(),name:s,type:"Object",value:r}]}const i=s=>{const l={id:s.name+"_"+_(),name:s.name,type:s.parameter.type==="object"?"Object":s.parameter.type.capitalize(),from:s.parameter.type==="object"?"Expand":"Reference",referenceNode:"",referenceId:"",referenceKey:"",value:[]};if(s.parameter.type==="object"){const r=s.parameter.properties;l.value=Object.keys(r).map(d=>i({name:d,parameter:r[d]})),l.props=[...l.value]}return l};return n.reducers=(s,l)=>{const r=(f,v,m)=>f.map(b=>{const C={...b};return b.id===v?(m.forEach(I=>{C[I.key]=I.value}),C):(C.type==="Object"&&Array.isArray(C.value)&&C.from!=="Reference"&&(C.value=r(C.value,v,m)),C)}),d=()=>{y.genericable.value.find(f=>f.name==="id").value=l.value,y.fitable.value.find(f=>f.name==="id").value=""},c=()=>{y.fitable.value.find(f=>f.name==="id").value=l.value.schema.parameters.fitableId},p=()=>{const f=l.value,v=t(f.schema);delete y.outputParams,y.outputParams=v},g=()=>{const f=l.value,v=Object.keys(f.schema.parameters.properties).map(m=>i({name:m,parameter:f.schema.parameters.properties[m]}));delete y.inputParams,y.inputParams=v};let y={...s};switch(l.type){case"generateInput":return g(),y;case"selectGenericable":return d(),y;case"selectFitable":return c(),g(),p(),y;case"update":return y.inputParams=r(s.inputParams,l.id,l.changes),y;default:throw Error("Unknown action: "+l.type)}},n},an=(e,n)=>{const t=ee.defaultGraph(e,n);t.type="jadeFlowGraph",t.pageType="jadeFlowPage",t.enableText=!1,t.flowMeta={exceptionFitables:["com.huawei.fit.jober.aipp.fitable.AippFlowExceptionHandler"]},t.setting.borderColor="#047bfc",t.setting.focusBorderColor="#047bfc",t.setting.mouseInBorderColor="#047bfc";const o=t.serialize;t.serialize=()=>{const l=o.apply(t);return l.flowMeta=t.flowMeta,l};const i=t.initialize;t.initialize=async()=>(t.registerPlugin("jadeFlowPage",wn),t.registerPlugin("jadeEvent",Sn),t.registerPlugin("taskNode",Ja),t.registerPlugin("endNodeEnd",Za),t.registerPlugin("endComponent",ao),t.registerPlugin("retrievalNodeState",fo),t.registerPlugin("retrievalComponent",po),t.registerPlugin("listener1Node",mo),t.registerPlugin("listener1Component",ho),t.registerPlugin("listener2Node",vo),t.registerPlugin("listener2Component",yo),t.registerPlugin("listener3Node",xo),t.registerPlugin("listener3Component",jo),t.registerPlugin("jadeInputTreeNode",wo),t.registerPlugin("jadeInputTreeComponent",Ao),t.registerPlugin("testNode",zo),t.registerPlugin("testComponent",Bo),t.registerPlugin("replaceComponent",qo),t.registerPlugin("startNodeStart",Ho),t.registerPlugin("startComponent",Yo),t.registerPlugin("llmNodeState",Xo),t.registerPlugin("llmComponent",ii),t.registerPlugin("manualCheckNodeState",ci),t.registerPlugin("manualCheckComponent",fi),t.registerPlugin("fitInvokeNodeState",hi),t.registerPlugin("fitInvokeComponent",wi),i.apply(t)),t.registerPlugin=(l,r,d=null)=>{d?t.plugins[`${d}.${l}`]=r:t.plugins[l]=r};const s=t.dirtied;return t.dirtied=(l,r)=>{s.call(t,l,r),t.onChangeCallback&&t.onChangeCallback()},t},on=e=>{const n={};return n.graph=e,n.want=(t,o)=>{e.activePage.want(t,o)},n.import=t=>n.graph.staticImport(t),n.serialize=()=>(e.activePage.serialize(),e.serialize()),n.getAvailableNodes=()=>[{type:"retrievalNodeState",name:"数据检索"},{type:"llmNodeState",name:"大模型"},{type:"manualCheckNodeState",name:"人工检查"},{type:"fitInvokeNodeState",name:"FIT调用"}],n.createNode=(t,o)=>{console.log("call createNode...");const i=e.activePage.calculatePosition(o);e.activePage.createNew(t,i.x,i.y)},n.createNodeByPosition=(t,o)=>{console.log("call createNodeByPosition..."),e.activePage.createNew(t,o.x,o.y)},n.onChange=t=>{e.onChangeCallback=t},n.getNodeConfigs=()=>e.activePage.shapes.filter(t=>t.isTypeof("jadeNode")).map(t=>({[t.id]:t.getLatestJadeConfig()})),n.validate=()=>{e.activePage.shapes.filter(t=>t.isTypeof("jadeNode")).forEach(t=>t.validate())},n},Ei=(()=>{const e={};return e.new=async(n,t)=>{const o=an(n,"jadeFlow");o.configs=t,o.collaboration.mute=!0,await o.initialize();const i=o.addPage("newFlowPage"),s=i.createShape("startNodeStart",100,100),l=i.createShape("endNodeEnd",s.x+s.width+200,100),r=i.createNew("jadeEvent",0,0);return i.reset(),r.connect(s.id,"E",l.id,"W"),i.fillScreen(),on(o)},e.edit=async(n,t,o)=>{const i=an(n,"jadeFlow");i.configs=o,i.collaboration.mute=!0,await i.initialize(),i.addPage("newFlowPage"),i.deSerialize(t);const s=i.getPageData(0);return await i.edit(0,n,s.id),on(i)},e})();me.JadeFlow=Ei,Object.defineProperty(me,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=fit-elsa-react.umd.cjs.map
