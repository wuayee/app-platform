(function(be,ne){typeof exports=="object"&&typeof module<"u"?ne(exports,require("@fit-elsa/elsa-core"),require("react"),require("react-dom"),require("antd"),require("axios")):typeof define=="function"&&define.amd?define(["exports","@fit-elsa/elsa-core","react","react-dom","antd","axios"],ne):(be=typeof globalThis<"u"?globalThis:be||self,ne(be["elsa-react"]={},be.elsaCore,be.react,be.ReactDOM,be.antd,be.axios))})(this,function(be,ne,L,Rr,v,Tr){"use strict";function Fr(e){const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const t in e)if(t!=="default"){const o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(a,t,o.get?o:{enumerable:!0,get:()=>e[t]})}}return a.default=e,Object.freeze(a)}const E=Fr(L),Lr=(e,a,t,o)=>{const i=ne.page(e,a,t,o);i.type="jadeFlowPage",i.serializedFields.batchAdd("x","y","scaleX","scaleY"),i.namespace="jadeFlow",i.backgroundGrid="point",i.backgroundGridSize=16,i.backgroundGridMargin=16,i.backColor="#fbfbfc",i.focusBackColor="#fbfbfc",i.gridColor="#e1e1e3",i.disableContextMenu=!0,i.moveAble=!0,i.observableStore=Mr();const s=i.onLoaded;i.onLoaded=()=>{s.apply(i),i.shapes.forEach(c=>c.onPageLoaded&&c.onPageLoaded())};const l=i.onCopy;i.onCopy=c=>{const f=c.filter(g=>!g.isUnique&&!g.isTypeof("jadeEvent"));return l.apply(i,[f])},i.registerObservable=(c,f,g,y,h)=>{i.observableStore.add(c,f,g,y,h)},i.removeObservable=(c,f=null)=>{i.observableStore.remove(c,f)},i.getObservableList=c=>i.observableStore.getObservableList(c),i.observeTo=(c,f,g)=>{i.observableStore.addObserver(c,f,g)},i.stopObserving=(c,f,g)=>{i.observableStore.removeObserver(c,f,g)},i.getObservable=(c,f)=>i.observableStore.getObservable(c,f);const n=i.clear;i.clear=()=>{n.apply(i),i.observableStore.clear()};const d=c=>(c==null||c===""?c="jade"+ne.uuid():c.startsWith("jade")||(c="jade"+c),c),u=i.createNew;i.createNew=(c,f,g,y,h,b,x,j)=>{m.filter(R=>R.type==="before").forEach(R=>R.handle(i,c,f,g,h,b));const N=u.apply(i,[c,f,g,y,h,b,x,j]);return m.filter(R=>R.type==="after").forEach(R=>R.handle(i,N)),N};const m=[];return i.registerShapeCreationHandler=c=>{m.push(c)},i.getMenuScript=()=>[],i.registerShapeCreationHandler({type:"before",handle:(c,f)=>{if(f==="startNodeStart"&&c.shapes.find(g=>g.type===f))throw new Error("最多只能有一个开始或结束节点.")}}),i.registerShapeCreationHandler({type:"after",handle:(c,f)=>{const g=c.shapes.filter(x=>x.isTypeof("jadeNode")),y=g.map(x=>x.text);if(!y.find(x=>x===f.text))return;const h="_";if(g.filter(x=>x.type===f.type).length<=1)return;let b=1;for(;;){const x=f.text.lastIndexOf(h),j=f.text.substring(x+1,f.text.length);if(isNaN(parseInt(j))?f.text=f.text+h+b:f.text=f.text.substring(0,x)+h+b,!y.includes(f.text))return;b++}}}),i.registerShapeCreationHandler({type:"after",handle:(c,f)=>{f.type!=="jadeEvent"&&(f.id=d(f.id))}}),i},Mr=()=>{const e={};e.store=new Map,e.add=(t,o,i,s,l)=>{const n=a(e.store,t,()=>new Map),d=a(n,o,()=>({observableId:o,value:null,type:null,observers:[],parentId:l}));d.value=i,d.type=s,d.parentId=l,d.observers.length>0&&d.observers.forEach(u=>u.observe({value:i,type:s}))},e.remove=(t,o=null)=>{if(o){const i=e.store.get(t);i&&o&&(i.delete(o),i.size===0&&e.store.delete(t))}else e.store.delete(t)},e.addObserver=(t,o,i)=>{const s=a(e.store,t,()=>new Map);a(s,o,()=>({observableId:o,value:null,observers:[]})).observers.push(i)},e.removeObserver=(t,o,i)=>{const s=e.store.get(t);if(!s)return;const l=s.get(o);if(!l)return;const n=l.observers.findIndex(d=>d===i);n!==-1&&l.observers.splice(n,1)};const a=(t,o,i)=>{let s=t.get(o);return s||(s=i(),t.set(o,s)),s};return e.getObservableList=t=>{const o=e.store.get(t);return o?Array.from(o.values()).map(i=>({nodeId:t,observableId:i.observableId,parentId:i.parentId,value:i.value,type:i.type})):[]},e.getObservable=(t,o)=>{const i=e.store.get(t);return i?i.get(o):null},e.clear=()=>{e.store.clear()},e};let _r=(e,a,t,o,i,s,l)=>{let n=ne.line(e,a,t,o,i,s,l);n.type="jadeEvent",n.borderWidth=1,n.beginArrow=!1,n.endArrow=!0,n.lineMode=ne.LINEMODE.AUTO_CURVE,n.borderColor="#B1B1B7",n.mouseInBorderColor="#B1B1B7",n.allowSwitchLineMode=!1;const d=n.getIndex;n.getIndex=()=>{let c=d.call(n);return n.index=c-200,n.index},n.onPageLoaded=()=>{n.toShape&&(n.currentToShape=n.page.getShapeById(n.toShape))};const u=n.initConnectors;n.initConnectors=()=>{u.call(n),n.fromConnector.visible=!1,n.toConnector.direction.color="transparent",n.toConnector.strokeStyle="transparent";const c=n.toConnector.release;n.toConnector.release=g=>{const y=n.fromShape,h=n.fromShapeConnector;function b(){return n.page.shapes.filter(x=>x.type==="jadeEvent").count(x=>x.fromShape===y&&x.toShape===n.connectingShape.id&&x.fromShapeConnector===h&&x.toShapeConnector===n.connectingShape.linkingConnector)>1}if(n.isFocused=!1,c.call(n.toConnector,g),b())n.remove();else if(n.toShape==="")n.currentToShape&&n.currentToShape.offConnect(),n.remove();else{const x=n.getToShape();x.onConnect(),n.currentToShape=x}},n.toConnector.radius=4,n.toConnector.moving=(g,y,h,b)=>{let x=n.page.disableReact;n.page.disableReact=!0;const j=n.from();n.resize(h-j.x,b-j.y),n.shapeLinking(n.to().x,n.to().y),n.toMoving=!0,n.page.disableReact=x,n.toConnector.afterMoving()};const f=n.toConnector.afterMoving;n.toConnector.afterMoving=()=>{n.connectingShape&&n.connectingShape.linkingConnector?(n.definedToConnector=n.connectingShape.linkingConnector.direction.key,n.toShape=n.connectingShape.id):(n.definedToConnector="",n.toShape=""),f.apply(n.toConnector)}};const m=n.remove;return n.remove=c=>{const f=n.getToShape(),g=m.apply(n,[c]);return f&&f.offConnect(),g},n.connect=(c,f,g,y)=>{n.fromShape=c,n.definedFromConnector=f,n.toShape=g,n.definedToConnector=y,n.follow()},n.validateLinking=(c,f,g)=>ne.isPointInRect({x:f,y:g},c.getBound()),n.shapeLinking=(c,f)=>{if(!n.linkAble)return;const g=n.page.find(c,f,y=>y.allowLink&&n.validateLinking(y,c,f));n.shapeDelinking(g),n.connectingShape=g,n.connectingShape&&n.connectingShape!==n.page&&(n.connectingShape.linking=!0,n.connectingShape.linkingConnector=n.connectingShape.getClosestConnector(c,f,y=>y.connectable&&y.allowToLink),n.connectingShape.render())},n.needGetToConnector=()=>n.getToShape(),n};function Wt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pt={exports:{}},Ue={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ht;function Ar(){if(Ht)return Ue;Ht=1;var e=L,a=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(n,d,u){var m,c={},f=null,g=null;u!==void 0&&(f=""+u),d.key!==void 0&&(f=""+d.key),d.ref!==void 0&&(g=d.ref);for(m in d)o.call(d,m)&&!s.hasOwnProperty(m)&&(c[m]=d[m]);if(n&&n.defaultProps)for(m in d=n.defaultProps,d)c[m]===void 0&&(c[m]=d[m]);return{$$typeof:a,type:n,key:f,ref:g,props:c,_owner:i.current}}return Ue.Fragment=t,Ue.jsx=l,Ue.jsxs=l,Ue}var We={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kt;function Br(){return Kt||(Kt=1,process.env.NODE_ENV!=="production"&&function(){var e=L,a=Symbol.for("react.element"),t=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),n=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),y=Symbol.iterator,h="@@iterator";function b(p){if(p===null||typeof p!="object")return null;var C=y&&p[y]||p[h];return typeof C=="function"?C:null}var x=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function j(p){{for(var C=arguments.length,P=new Array(C>1?C-1:0),M=1;M<C;M++)P[M-1]=arguments[M];N("error",p,P)}}function N(p,C,P){{var M=x.ReactDebugCurrentFrame,Z=M.getStackAddendum();Z!==""&&(C+="%s",P=P.concat([Z]));var Q=P.map(function(J){return String(J)});Q.unshift("Warning: "+C),Function.prototype.apply.call(console[p],console,Q)}}var R=!1,w=!1,ae=!1,he=!1,Fe=!1,Ie;Ie=Symbol.for("react.module.reference");function Le(p){return!!(typeof p=="string"||typeof p=="function"||p===o||p===s||Fe||p===i||p===u||p===m||he||p===g||R||w||ae||typeof p=="object"&&p!==null&&(p.$$typeof===f||p.$$typeof===c||p.$$typeof===l||p.$$typeof===n||p.$$typeof===d||p.$$typeof===Ie||p.getModuleId!==void 0))}function Pe(p,C,P){var M=p.displayName;if(M)return M;var Z=C.displayName||C.name||"";return Z!==""?P+"("+Z+")":P}function ke(p){return p.displayName||"Context"}function I(p){if(p==null)return null;if(typeof p.tag=="number"&&j("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case o:return"Fragment";case t:return"Portal";case s:return"Profiler";case i:return"StrictMode";case u:return"Suspense";case m:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case n:var C=p;return ke(C)+".Consumer";case l:var P=p;return ke(P._context)+".Provider";case d:return Pe(p,p.render,"ForwardRef");case c:var M=p.displayName||null;return M!==null?M:I(p.type)||"Memo";case f:{var Z=p,Q=Z._payload,J=Z._init;try{return I(J(Q))}catch{return null}}}return null}var T=Object.assign,_=0,$,ee,se,De,S,O,q;function V(){}V.__reactDisabledLog=!0;function B(){{if(_===0){$=console.log,ee=console.info,se=console.warn,De=console.error,S=console.group,O=console.groupCollapsed,q=console.groupEnd;var p={configurable:!0,enumerable:!0,value:V,writable:!0};Object.defineProperties(console,{info:p,log:p,warn:p,error:p,group:p,groupCollapsed:p,groupEnd:p})}_++}}function K(){{if(_--,_===0){var p={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:T({},p,{value:$}),info:T({},p,{value:ee}),warn:T({},p,{value:se}),error:T({},p,{value:De}),group:T({},p,{value:S}),groupCollapsed:T({},p,{value:O}),groupEnd:T({},p,{value:q})})}_<0&&j("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var D=x.ReactCurrentDispatcher,z;function U(p,C,P){{if(z===void 0)try{throw Error()}catch(Z){var M=Z.stack.trim().match(/\n( *(at )?)/);z=M&&M[1]||""}return`
`+z+p}}var Y=!1,W;{var ce=typeof WeakMap=="function"?WeakMap:Map;W=new ce}function k(p,C){if(!p||Y)return"";{var P=W.get(p);if(P!==void 0)return P}var M;Y=!0;var Z=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Q;Q=D.current,D.current=null,B();try{if(C){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(Ee){M=Ee}Reflect.construct(p,[],J)}else{try{J.call()}catch(Ee){M=Ee}p.call(J.prototype)}}else{try{throw Error()}catch(Ee){M=Ee}p()}}catch(Ee){if(Ee&&M&&typeof Ee.stack=="string"){for(var H=Ee.stack.split(`
`),fe=M.stack.split(`
`),oe=H.length-1,ie=fe.length-1;oe>=1&&ie>=0&&H[oe]!==fe[ie];)ie--;for(;oe>=1&&ie>=0;oe--,ie--)if(H[oe]!==fe[ie]){if(oe!==1||ie!==1)do if(oe--,ie--,ie<0||H[oe]!==fe[ie]){var ye=`
`+H[oe].replace(" at new "," at ");return p.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",p.displayName)),typeof p=="function"&&W.set(p,ye),ye}while(oe>=1&&ie>=0);break}}}finally{Y=!1,D.current=Q,K(),Error.prepareStackTrace=Z}var qe=p?p.displayName||p.name:"",Or=qe?U(qe):"";return typeof p=="function"&&W.set(p,Or),Or}function ve(p,C,P){return k(p,!1)}function ze(p){var C=p.prototype;return!!(C&&C.isReactComponent)}function Me(p,C,P){if(p==null)return"";if(typeof p=="function")return k(p,ze(p));if(typeof p=="string")return U(p);switch(p){case u:return U("Suspense");case m:return U("SuspenseList")}if(typeof p=="object")switch(p.$$typeof){case d:return ve(p.render);case c:return Me(p.type,C,P);case f:{var M=p,Z=M._payload,Q=M._init;try{return Me(Q(Z),C,P)}catch{}}}return""}var dt=Object.prototype.hasOwnProperty,yr={},br=x.ReactDebugCurrentFrame;function ft(p){if(p){var C=p._owner,P=Me(p.type,p._source,C?C.type:null);br.setExtraStackFrame(P)}else br.setExtraStackFrame(null)}function Hi(p,C,P,M,Z){{var Q=Function.call.bind(dt);for(var J in p)if(Q(p,J)){var H=void 0;try{if(typeof p[J]!="function"){var fe=Error((M||"React class")+": "+P+" type `"+J+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof p[J]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw fe.name="Invariant Violation",fe}H=p[J](C,J,M,P,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(oe){H=oe}H&&!(H instanceof Error)&&(ft(Z),j("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",M||"React class",P,J,typeof H),ft(null)),H instanceof Error&&!(H.message in yr)&&(yr[H.message]=!0,ft(Z),j("Failed %s type: %s",P,H.message),ft(null))}}}var Ki=Array.isArray;function Dt(p){return Ki(p)}function Ji(p){{var C=typeof Symbol=="function"&&Symbol.toStringTag,P=C&&p[Symbol.toStringTag]||p.constructor.name||"Object";return P}}function Yi(p){try{return xr(p),!1}catch{return!0}}function xr(p){return""+p}function jr(p){if(Yi(p))return j("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Ji(p)),xr(p)}var Xe=x.ReactCurrentOwner,Zi={key:!0,ref:!0,__self:!0,__source:!0},Cr,wr,zt;zt={};function Gi(p){if(dt.call(p,"ref")){var C=Object.getOwnPropertyDescriptor(p,"ref").get;if(C&&C.isReactWarning)return!1}return p.ref!==void 0}function Xi(p){if(dt.call(p,"key")){var C=Object.getOwnPropertyDescriptor(p,"key").get;if(C&&C.isReactWarning)return!1}return p.key!==void 0}function Qi(p,C){if(typeof p.ref=="string"&&Xe.current&&C&&Xe.current.stateNode!==C){var P=I(Xe.current.type);zt[P]||(j('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',I(Xe.current.type),p.ref),zt[P]=!0)}}function es(p,C){{var P=function(){Cr||(Cr=!0,j("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",C))};P.isReactWarning=!0,Object.defineProperty(p,"key",{get:P,configurable:!0})}}function ts(p,C){{var P=function(){wr||(wr=!0,j("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",C))};P.isReactWarning=!0,Object.defineProperty(p,"ref",{get:P,configurable:!0})}}var ns=function(p,C,P,M,Z,Q,J){var H={$$typeof:a,type:p,key:C,ref:P,props:J,_owner:Q};return H._store={},Object.defineProperty(H._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(H,"_self",{configurable:!1,enumerable:!1,writable:!1,value:M}),Object.defineProperty(H,"_source",{configurable:!1,enumerable:!1,writable:!1,value:Z}),Object.freeze&&(Object.freeze(H.props),Object.freeze(H)),H};function rs(p,C,P,M,Z){{var Q,J={},H=null,fe=null;P!==void 0&&(jr(P),H=""+P),Xi(C)&&(jr(C.key),H=""+C.key),Gi(C)&&(fe=C.ref,Qi(C,Z));for(Q in C)dt.call(C,Q)&&!Zi.hasOwnProperty(Q)&&(J[Q]=C[Q]);if(p&&p.defaultProps){var oe=p.defaultProps;for(Q in oe)J[Q]===void 0&&(J[Q]=oe[Q])}if(H||fe){var ie=typeof p=="function"?p.displayName||p.name||"Unknown":p;H&&es(J,ie),fe&&ts(J,ie)}return ns(p,H,fe,Z,M,Xe.current,J)}}var Vt=x.ReactCurrentOwner,Er=x.ReactDebugCurrentFrame;function Ve(p){if(p){var C=p._owner,P=Me(p.type,p._source,C?C.type:null);Er.setExtraStackFrame(P)}else Er.setExtraStackFrame(null)}var qt;qt=!1;function Ut(p){return typeof p=="object"&&p!==null&&p.$$typeof===a}function Sr(){{if(Vt.current){var p=I(Vt.current.type);if(p)return`

Check the render method of \``+p+"`."}return""}}function as(p){{if(p!==void 0){var C=p.fileName.replace(/^.*[\\\/]/,""),P=p.lineNumber;return`

Check your code at `+C+":"+P+"."}return""}}var Nr={};function os(p){{var C=Sr();if(!C){var P=typeof p=="string"?p:p.displayName||p.name;P&&(C=`

Check the top-level render call using <`+P+">.")}return C}}function Ir(p,C){{if(!p._store||p._store.validated||p.key!=null)return;p._store.validated=!0;var P=os(C);if(Nr[P])return;Nr[P]=!0;var M="";p&&p._owner&&p._owner!==Vt.current&&(M=" It was passed a child from "+I(p._owner.type)+"."),Ve(p),j('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',P,M),Ve(null)}}function Pr(p,C){{if(typeof p!="object")return;if(Dt(p))for(var P=0;P<p.length;P++){var M=p[P];Ut(M)&&Ir(M,C)}else if(Ut(p))p._store&&(p._store.validated=!0);else if(p){var Z=b(p);if(typeof Z=="function"&&Z!==p.entries)for(var Q=Z.call(p),J;!(J=Q.next()).done;)Ut(J.value)&&Ir(J.value,C)}}}function is(p){{var C=p.type;if(C==null||typeof C=="string")return;var P;if(typeof C=="function")P=C.propTypes;else if(typeof C=="object"&&(C.$$typeof===d||C.$$typeof===c))P=C.propTypes;else return;if(P){var M=I(C);Hi(P,p.props,"prop",M,p)}else if(C.PropTypes!==void 0&&!qt){qt=!0;var Z=I(C);j("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",Z||"Unknown")}typeof C.getDefaultProps=="function"&&!C.getDefaultProps.isReactClassApproved&&j("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ss(p){{for(var C=Object.keys(p.props),P=0;P<C.length;P++){var M=C[P];if(M!=="children"&&M!=="key"){Ve(p),j("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",M),Ve(null);break}}p.ref!==null&&(Ve(p),j("Invalid attribute `ref` supplied to `React.Fragment`."),Ve(null))}}function kr(p,C,P,M,Z,Q){{var J=Le(p);if(!J){var H="";(p===void 0||typeof p=="object"&&p!==null&&Object.keys(p).length===0)&&(H+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var fe=as(Z);fe?H+=fe:H+=Sr();var oe;p===null?oe="null":Dt(p)?oe="array":p!==void 0&&p.$$typeof===a?(oe="<"+(I(p.type)||"Unknown")+" />",H=" Did you accidentally export a JSX literal instead of a component?"):oe=typeof p,j("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",oe,H)}var ie=rs(p,C,P,Z,Q);if(ie==null)return ie;if(J){var ye=C.children;if(ye!==void 0)if(M)if(Dt(ye)){for(var qe=0;qe<ye.length;qe++)Pr(ye[qe],p);Object.freeze&&Object.freeze(ye)}else j("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Pr(ye,p)}return p===o?ss(ie):is(ie),ie}}function ls(p,C,P){return kr(p,C,P,!0)}function cs(p,C,P){return kr(p,C,P,!1)}var us=cs,ds=ls;We.Fragment=o,We.jsx=us,We.jsxs=ds}()),We}process.env.NODE_ENV==="production"?pt.exports=Ar():pt.exports=Br();var r=pt.exports,He={},Ke=Rr;if(process.env.NODE_ENV==="production")He.createRoot=Ke.createRoot,He.hydrateRoot=Ke.hydrateRoot;else{var Qe=Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;He.createRoot=function(e,a){Qe.usingClientEntryPoint=!0;try{return Ke.createRoot(e,a)}finally{Qe.usingClientEntryPoint=!1}},He.hydrateRoot=function(e,a,t){Qe.usingClientEntryPoint=!0;try{return Ke.hydrateRoot(e,a,t)}finally{Qe.usingClientEntryPoint=!1}}}const Jt=({shape:e})=>{const[a,t]=L.useState(!1),o=L.useRef(null),[i,s]=L.useState(0);L.useEffect(()=>{o.current&&o.current.focus({cursor:"end"})}),L.useEffect(()=>{e.page.addEventListener("TOOL_MENU_CHANGE",m=>{e.type==="endNodeEnd"&&s(m[0])})},[]);const l=()=>{o.current.input.value!==""&&(e.text=o.current.input.value,t(!1))},n=m=>{e.getToolMenus().find(f=>f.key===m.key).action(t)},d=()=>a?r.jsx(r.Fragment,{children:r.jsx(v.Form.Item,{name:"title",rules:[{required:!0,message:"请输入名称"}],initialValue:e.text,children:r.jsx(v.Input,{onBlur:m=>l(),ref:o,placeholder:"请输入名称",style:{height:"24px",borderColor:e.focusBorderColor}})})}):r.jsx("p",{style:{margin:0},children:r.jsx("span",{children:e.text})}),u=()=>{if(e.getToolMenus().length>0){const m=e.getToolMenus().map(c=>({key:c.key,label:c.label}));return r.jsx(r.Fragment,{children:r.jsx("div",{children:r.jsx(v.Dropdown,{menu:{items:m,onClick:c=>n(c)},placement:"bottomRight",children:r.jsx(v.Button,{type:"text",size:"small",style:{margin:0,padding:0,width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",children:r.jsx("path",{fill:"#1C1D23",fillOpacity:"0.8",d:"M3.667 7.833a1.167 1.167 0 1 1-2.334 0 1.167 1.167 0 0 1 2.334 0ZM9.15 7.833a1.167 1.167 0 1 1-2.333 0 1.167 1.167 0 0 1 2.333 0ZM14.667 7.833a1.167 1.167 0 1 1-2.334 0 1.167 1.167 0 0 1 2.334 0Z"})})})})})})}return r.jsx(r.Fragment,{})};return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"react-node-header",children:[r.jsxs("div",{className:"react-node-toolbar",style:{alignItems:"center"},children:[r.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.getHeaderIcon()}),r.jsx("div",{className:"react-node-toolbar-name",children:d()}),u()]}),r.jsx("span",{className:"react-node-header-description",children:e.description})]})})},Yt=L.createContext(null),Zt=L.createContext(null),Gt=L.createContext(null),Xt=L.createContext(null),$r=({shape:e,component:a})=>{const[t,o]=L.useReducer(a.reducers,a.getJadeConfig()),i="react-root-"+e.id,[s]=v.Form.useForm();return e.getLatestJadeConfig=()=>JSON.parse(JSON.stringify(t)),e.validateForm=()=>s.validateFields(),L.useEffect(()=>{e.observe()},[]),L.useEffect(()=>{e.graph.onChangeCallback&&e.graph.onChangeCallback()},[t]),r.jsx(r.Fragment,{children:r.jsx("div",{id:i,style:{display:"block"},children:r.jsxs(v.Form,{form:s,name:`form-${e.id}`,layout:"vertical",className:"jade-form",children:[e.getHeaderComponent(),r.jsx(Xt.Provider,{value:s,children:r.jsx(Zt.Provider,{value:e,children:r.jsx(Yt.Provider,{value:t,children:r.jsx(Gt.Provider,{value:o,children:r.jsx("div",{className:"react-node-content",style:{borderRadius:e.borderRadius+"px"},children:a.getReactComponents()})})})})})]})})})};function te(){return L.useContext(Yt)}function ue(){return L.useContext(Zt)}function re(){return L.useContext(Gt)}function _e(){return L.useContext(Xt)}let et;const Dr=new Uint8Array(16);function zr(){if(!et&&(et=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!et))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return et(Dr)}const le=[];for(let e=0;e<256;++e)le.push((e+256).toString(16).slice(1));function Vr(e,a=0){return le[e[a+0]]+le[e[a+1]]+le[e[a+2]]+le[e[a+3]]+"-"+le[e[a+4]]+le[e[a+5]]+"-"+le[e[a+6]]+le[e[a+7]]+"-"+le[e[a+8]]+le[e[a+9]]+"-"+le[e[a+10]]+le[e[a+11]]+le[e[a+12]]+le[e[a+13]]+le[e[a+14]]+le[e[a+15]]}const Qt={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function F(e,a,t){if(Qt.randomUUID&&!a&&!e)return Qt.randomUUID();e=e||{};const o=e.random||(e.rng||zr)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,a){t=t||0;for(let i=0;i<16;++i)a[t+i]=o[i];return a}return Vr(o)}const pe=(e,a,t,o,i,s,l)=>{const n=ne.node(e,a,t,o,i,s,!1,l||Ur);n.type="jadeNode",n.serializedFields.batchAdd("toolConfigs","componentName","flowMeta"),n.eventType="jadeEvent",n.hideText=!0,n.autoHeight=!0,n.width=360,n.borderColor="rgba(28,31,35,.08)",n.mouseInBorderColor="rgba(28,31,35,.08)",n.shadow="0 2px 4px 0 rgba(0,0,0,.1)",n.focusShadow="0 0 1px rgba(0,0,0,.3),0 4px 14px rgba(0,0,0,.1)",n.borderWidth=1,n.focusBorderWidth=2,n.dashWidth=0,n.backColor="white",n.focusBackColor="white",n.borderRadius=8,n.cornerRadius=8,n.enableAnimation=!1,n.modeRegion.visible=!1,n.flowMeta={triggerMode:"auto",jober:{type:"general_jober",name:"",fitables:[],converter:{type:"mapping_converter"}}};const d=[];n.getToolMenus=()=>[{key:"1",label:"复制",action:()=>{n.duplicate()}},{key:"2",label:"删除",action:()=>{n.remove()}},{key:"3",label:"重命名",action:h=>{h(!0)}}];const u=n.initConnectors;n.initConnectors=()=>{u.apply(n),n.connectors.remove(h=>h.direction.key===ne.DIRECTION.S.key||h.direction.key===ne.DIRECTION.N.key||h.direction.key==="ROTATE"),n.connectors.forEach(h=>{h.isSolid=!0,h.direction.key===ne.DIRECTION.W.key&&(h.allowFromLink=!1),h.direction.key===ne.DIRECTION.E.key&&(h.allowToLink=!1)})},n.getPreNodeInfos=()=>{if(!n.allowToLink)return[];const h=n.page.shapes.filter(N=>N.type==="jadeEvent"),b=[],x=new Set,j=N=>{if(x.has(N))return;x.add(N);const R=n.page.getShapeById(N);if(!R)return;b.push({id:R.id,node:R,name:R.text,observableList:R.page.getObservableList(R.id)});const w=h.filter(ae=>ae.toShape===N);for(const ae of w)j(ae.fromShape)};return j(n.id),b.shift(),b},n.observe=()=>{n.drawer.observe()},n.getHeaderComponent=()=>r.jsx(Jt,{shape:n}),n.getComponent=()=>n.graph.plugins[n.componentName](n.flowMeta.jober.converter.entity),n.emit=(h,{value:b,type:x})=>{const j=n.page.getObservable(n.id,h);j&&(j.observers.forEach(N=>{N.status==="enable"&&N.observe({value:b??j.value,type:x??j.type})}),b!=null&&(j.value=b),x!=null&&(j.type=x))};const m=n.remove;n.remove=h=>{const x=n.page.shapes.filter(N=>N.isTypeof("jadeEvent")).filter(N=>N.fromShape===n.id||N.toShape===n.id).flatMap(N=>N.remove()),j=m.apply(n,[h]);return n.cleanObservables(),[...j,...x]},n.duplicate=()=>{const h=JSON.stringify([n.serialize()]);ne.CopyPasteHelpers.pasteShapes(h,"",n.page)};const c=n.serialize;n.serialize=()=>(n.getLatestJadeConfig&&n.serializerJadeConfig(),c.apply(n)),n.serializerJadeConfig=()=>{n.flowMeta.jober.converter.entity=n.getLatestJadeConfig()},n.addDetection(["componentName"],(h,b,x)=>{b!==x&&(n.drawer.unmountReact(),n.invalidateAlone())});const f=h=>{typeof h=="object"&&h!==null&&(Array.isArray(h)?h.forEach(b=>{f(b)}):Object.keys(h).forEach(b=>{b==="id"?h[b]=F():f(h[b])}))};n.pasted=()=>{f(n.getEntity())},n.getEntity=()=>n.flowMeta.jober.converter.entity,n.getHeaderIcon=()=>{},n.observeTo=(h,b,x)=>{const j=n.getPreNodeInfos(),N=new Set(j.map(ae=>ae.id)),R=qr(h,b,x);R.status=N.has(h)?"enable":"disable",d.push(R),n.page.observeTo(h,b,R);const w=n.page.getObservable(h,b);return R.observe({value:w.value,type:w.type}),()=>{const ae=d.findIndex(he=>he===R);d.splice(ae,1),n.page.stopObserving(h,b,R)}},n.offConnect=()=>{const h=n.getPreNodeInfos(),b=new Set(h.map(j=>j.id));d.filter(j=>j.status==="enable").filter(j=>!b.has(j.nodeId)).forEach(j=>{j.observe({value:null,type:null}),j.status="disable"});const x=g();x.length>0&&x.forEach(j=>j.offConnect())},n.onConnect=()=>{const h=n.getPreNodeInfos(),b=new Set(h.map(j=>j.id));d.filter(j=>j.status==="disable").filter(j=>b.has(j.nodeId)).forEach(j=>{j.status="enable";const N=n.page.getObservable(j.nodeId,j.observableId);j.observe({value:N.value,type:N.type})});const x=g();x.length>0&&x.forEach(j=>j.onConnect())},n.cleanObservables=()=>{n.page.removeObservable(n.id),d.forEach(h=>n.page.stopObserving(h.nodeId,h.observableId,h))};const g=()=>{const h=n.page.shapes.filter(b=>b.type==="jadeEvent").filter(b=>b.fromShape===n.id);return!h||h.length===0?[]:n.page.shapes.filter(b=>b.type!=="jadeEvent").filter(b=>h.some(x=>x.toShape===b.id))};n.validate=()=>new Promise((h,b)=>{try{const x=n.getPreNodeInfos(),j=new Set(x.map(N=>N.id));d.forEach(N=>{const R=n.page.getShapeById(N.nodeId);if(!R)throw new Error("节点["+N.nodeId+"]不存在.");if(!j.has(N.nodeId))throw new Error("节点["+R.text+"]和节点["+n.text+"]未连接.")}),n.validateForm().then(h).catch(b)}catch(x){b(x)}});const y=n.unSelect;return n.unSelect=()=>{y.apply(n),n.validateForm&&n.validateForm()},n},qr=(e,a,t)=>{const o={};return o.nodeId=e,o.observableId=a,o.status="enable",o.origin=t,o.observe=i=>{o.status==="enable"&&o.origin(i)},o},Ur=(e,a,t,o)=>{const i=ne.rectangleDrawer(e,a,t,o);i.reactContainer=null;const s=i.initialize;i.initialize=()=>{s.apply(i),i.reactContainer=document.createElement("div"),i.reactContainer.id="react-container-"+e.id,i.reactContainer.style.padding="12px",i.reactContainer.style.width="100%",i.reactContainer.style.borderRadius=e.borderRadius+"px",i.parent.appendChild(i.reactContainer),i.parent.style.pointerEvents="auto"},i.unmountReact=()=>{i.root&&(i.root.unmount(),i.root=null)},i.processMetaData=u=>{},i.drawStatic=()=>{!e.componentName||i.root||(i.root=He.createRoot(i.reactContainer),i.root.render(r.jsx($r,{shape:e,component:e.getComponent()})))},i.drawFocusFrame=()=>{};const l=i.drawBorder;i.drawBorder=()=>{l.apply(i),e.isFocused?(i.parent.style.border="",i.parent.style.border=e.borderWidth+"px solid "+e.borderColor,i.parent.style.outline=e.focusBorderWidth+"px solid "+e.getBorderColor()):i.parent.style.outline=""};const n=i.beforeRemove;i.beforeRemove=()=>{n.apply(i),i.unmountReact()};let d=0;return i.observe=()=>{new ResizeObserver(u=>{d!==i.parent.offsetHeight&&e.container!==""&&(e.resize(e.width,i.parent.offsetHeight),d=i.parent.offsetHeight)}).observe(i.parent)},i};function Wr(){const e=te();return r.jsx("ul",{children:e.map(a=>r.jsx("li",{children:r.jsx(Hr,{task:a})},a.id))})}function Hr({task:e}){const[a,t]=L.useState(!1),o=re();let i;return a?i=r.jsxs(r.Fragment,{children:[r.jsx("input",{value:e.text,onChange:s=>{o({type:"changed",task:{...e,text:s.target.value}})}}),r.jsx("button",{onClick:()=>t(!1),children:"Save"})]}):i=r.jsxs(r.Fragment,{children:[e.text,r.jsx("button",{onClick:()=>t(!0),children:"Edit"})]}),r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:e.done,onChange:s=>{o({type:"changed",task:{...e,done:s.target.checked}})}}),i,r.jsx("button",{onClick:()=>{o({type:"deleted",id:e.id})},children:"Delete"})]})}function Kr(){const[e,a]=L.useState(""),t=re(),o=ue();return r.jsxs(r.Fragment,{children:[r.jsx("input",{placeholder:"Add task",value:e,onChange:i=>a(i.target.value)}),r.jsx("button",{onClick:()=>{a(""),console.log(o.serialize()),t({type:"added",id:Jr++,text:e})},children:"Add"})]})}let Jr=3;var Yr=L.createContext({});const en=Yr;function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Se.apply(this,arguments)}function Zr(e){if(Array.isArray(e))return e}function Gr(e,a){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var o,i,s,l,n=[],d=!0,u=!1;try{if(s=(t=t.call(e)).next,a===0){if(Object(t)!==t)return;d=!1}else for(;!(d=(o=s.call(t)).done)&&(n.push(o.value),n.length!==a);d=!0);}catch(m){u=!0,i=m}finally{try{if(!d&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw i}}return n}}function tn(e,a){(a==null||a>e.length)&&(a=e.length);for(var t=0,o=new Array(a);t<a;t++)o[t]=e[t];return o}function Xr(e,a){if(e){if(typeof e=="string")return tn(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tn(e,a)}}function Qr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nn(e,a){return Zr(e)||Gr(e,a)||Xr(e,a)||Qr()}function Oe(e){"@babel/helpers - typeof";return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Oe(e)}function ea(e,a){if(Oe(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var o=t.call(e,a||"default");if(Oe(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function ta(e){var a=ea(e,"string");return Oe(a)=="symbol"?a:a+""}function mt(e,a,t){return a=ta(a),a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function na(e,a){if(e==null)return{};var t={},o=Object.keys(e),i,s;for(s=0;s<o.length;s++)i=o[s],!(a.indexOf(i)>=0)&&(t[i]=e[i]);return t}function rn(e,a){if(e==null)return{};var t=na(e,a),o,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)o=s[i],!(a.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(t[o]=e[o])}return t}var an={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var a={}.hasOwnProperty;function t(){for(var s="",l=0;l<arguments.length;l++){var n=arguments[l];n&&(s=i(s,o(n)))}return s}function o(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var l="";for(var n in s)a.call(s,n)&&s[n]&&(l=i(l,n));return l}function i(s,l){return l?s?s+" "+l:s+l:s}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(an);var ra=an.exports;const aa=Wt(ra);function ge(e,a){oa(e)&&(e="100%");var t=ia(e);return e=a===360?e:Math.min(a,Math.max(0,parseFloat(e))),t&&(e=parseInt(String(e*a),10)/100),Math.abs(e-a)<1e-6?1:(a===360?e=(e<0?e%a+a:e%a)/parseFloat(String(a)):e=e%a/parseFloat(String(a)),e)}function oa(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function ia(e){return typeof e=="string"&&e.indexOf("%")!==-1}function sa(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function tt(e){return e<=1?"".concat(Number(e)*100,"%"):e}function ht(e){return e.length===1?"0"+e:String(e)}function la(e,a,t){return{r:ge(e,255)*255,g:ge(a,255)*255,b:ge(t,255)*255}}function gt(e,a,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(a-e)*(6*t):t<1/2?a:t<2/3?e+(a-e)*(2/3-t)*6:e}function ca(e,a,t){var o,i,s;if(e=ge(e,360),a=ge(a,100),t=ge(t,100),a===0)i=t,s=t,o=t;else{var l=t<.5?t*(1+a):t+a-t*a,n=2*t-l;o=gt(n,l,e+1/3),i=gt(n,l,e),s=gt(n,l,e-1/3)}return{r:o*255,g:i*255,b:s*255}}function ua(e,a,t){e=ge(e,255),a=ge(a,255),t=ge(t,255);var o=Math.max(e,a,t),i=Math.min(e,a,t),s=0,l=o,n=o-i,d=o===0?0:n/o;if(o===i)s=0;else{switch(o){case e:s=(a-t)/n+(a<t?6:0);break;case a:s=(t-e)/n+2;break;case t:s=(e-a)/n+4;break}s/=6}return{h:s,s:d,v:l}}function da(e,a,t){e=ge(e,360)*6,a=ge(a,100),t=ge(t,100);var o=Math.floor(e),i=e-o,s=t*(1-a),l=t*(1-i*a),n=t*(1-(1-i)*a),d=o%6,u=[t,l,s,s,n,t][d],m=[n,t,t,l,s,s][d],c=[s,s,n,t,t,l][d];return{r:u*255,g:m*255,b:c*255}}function fa(e,a,t,o){var i=[ht(Math.round(e).toString(16)),ht(Math.round(a).toString(16)),ht(Math.round(t).toString(16))];return o&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function on(e){return me(e)/255}function me(e){return parseInt(e,16)}var sn={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Je(e){var a={r:0,g:0,b:0},t=1,o=null,i=null,s=null,l=!1,n=!1;return typeof e=="string"&&(e=ha(e)),typeof e=="object"&&(we(e.r)&&we(e.g)&&we(e.b)?(a=la(e.r,e.g,e.b),l=!0,n=String(e.r).substr(-1)==="%"?"prgb":"rgb"):we(e.h)&&we(e.s)&&we(e.v)?(o=tt(e.s),i=tt(e.v),a=da(e.h,o,i),l=!0,n="hsv"):we(e.h)&&we(e.s)&&we(e.l)&&(o=tt(e.s),s=tt(e.l),a=ca(e.h,o,s),l=!0,n="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(t=e.a)),t=sa(t),{ok:l,format:e.format||n,r:Math.min(255,Math.max(a.r,0)),g:Math.min(255,Math.max(a.g,0)),b:Math.min(255,Math.max(a.b,0)),a:t}}var pa="[-\\+]?\\d+%?",ma="[-\\+]?\\d*\\.\\d+%?",Ne="(?:".concat(ma,")|(?:").concat(pa,")"),vt="[\\s|\\(]+(".concat(Ne,")[,|\\s]+(").concat(Ne,")[,|\\s]+(").concat(Ne,")\\s*\\)?"),yt="[\\s|\\(]+(".concat(Ne,")[,|\\s]+(").concat(Ne,")[,|\\s]+(").concat(Ne,")[,|\\s]+(").concat(Ne,")\\s*\\)?"),xe={CSS_UNIT:new RegExp(Ne),rgb:new RegExp("rgb"+vt),rgba:new RegExp("rgba"+yt),hsl:new RegExp("hsl"+vt),hsla:new RegExp("hsla"+yt),hsv:new RegExp("hsv"+vt),hsva:new RegExp("hsva"+yt),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function ha(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var a=!1;if(sn[e])e=sn[e],a=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t=xe.rgb.exec(e);return t?{r:t[1],g:t[2],b:t[3]}:(t=xe.rgba.exec(e),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=xe.hsl.exec(e),t?{h:t[1],s:t[2],l:t[3]}:(t=xe.hsla.exec(e),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=xe.hsv.exec(e),t?{h:t[1],s:t[2],v:t[3]}:(t=xe.hsva.exec(e),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=xe.hex8.exec(e),t?{r:me(t[1]),g:me(t[2]),b:me(t[3]),a:on(t[4]),format:a?"name":"hex8"}:(t=xe.hex6.exec(e),t?{r:me(t[1]),g:me(t[2]),b:me(t[3]),format:a?"name":"hex"}:(t=xe.hex4.exec(e),t?{r:me(t[1]+t[1]),g:me(t[2]+t[2]),b:me(t[3]+t[3]),a:on(t[4]+t[4]),format:a?"name":"hex8"}:(t=xe.hex3.exec(e),t?{r:me(t[1]+t[1]),g:me(t[2]+t[2]),b:me(t[3]+t[3]),format:a?"name":"hex"}:!1)))))))))}function we(e){return!!xe.CSS_UNIT.exec(String(e))}var nt=2,ln=.16,ga=.05,va=.05,ya=.15,cn=5,un=4,ba=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function dn(e){var a=e.r,t=e.g,o=e.b,i=ua(a,t,o);return{h:i.h*360,s:i.s,v:i.v}}function rt(e){var a=e.r,t=e.g,o=e.b;return"#".concat(fa(a,t,o,!1))}function xa(e,a,t){var o=t/100,i={r:(a.r-e.r)*o+e.r,g:(a.g-e.g)*o+e.g,b:(a.b-e.b)*o+e.b};return i}function fn(e,a,t){var o;return Math.round(e.h)>=60&&Math.round(e.h)<=240?o=t?Math.round(e.h)-nt*a:Math.round(e.h)+nt*a:o=t?Math.round(e.h)+nt*a:Math.round(e.h)-nt*a,o<0?o+=360:o>=360&&(o-=360),o}function pn(e,a,t){if(e.h===0&&e.s===0)return e.s;var o;return t?o=e.s-ln*a:a===un?o=e.s+ln:o=e.s+ga*a,o>1&&(o=1),t&&a===cn&&o>.1&&(o=.1),o<.06&&(o=.06),Number(o.toFixed(2))}function mn(e,a,t){var o;return t?o=e.v+va*a:o=e.v-ya*a,o>1&&(o=1),Number(o.toFixed(2))}function bt(e){for(var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],o=Je(e),i=cn;i>0;i-=1){var s=dn(o),l=rt(Je({h:fn(s,i,!0),s:pn(s,i,!0),v:mn(s,i,!0)}));t.push(l)}t.push(rt(o));for(var n=1;n<=un;n+=1){var d=dn(o),u=rt(Je({h:fn(d,n),s:pn(d,n),v:mn(d,n)}));t.push(u)}return a.theme==="dark"?ba.map(function(m){var c=m.index,f=m.opacity,g=rt(xa(Je(a.backgroundColor||"#141414"),Je(t[c]),f*100));return g}):t}var xt={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},at={},jt={};Object.keys(xt).forEach(function(e){at[e]=bt(xt[e]),at[e].primary=at[e][5],jt[e]=bt(xt[e],{theme:"dark",backgroundColor:"#141414"}),jt[e].primary=jt[e][5]});var ja=at.blue;function hn(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,o)}return t}function je(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?hn(Object(t),!0).forEach(function(o){mt(e,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):hn(Object(t)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))})}return e}function Ca(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function wa(e,a){if(!e)return!1;if(e.contains)return e.contains(a);for(var t=a;t;){if(t===e)return!0;t=t.parentNode}return!1}var gn="data-rc-order",vn="data-rc-priority",Ea="rc-util-key",Ct=new Map;function yn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=e.mark;return a?a.startsWith("data-")?a:"data-".concat(a):Ea}function wt(e){if(e.attachTo)return e.attachTo;var a=document.querySelector("head");return a||document.body}function Sa(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function Et(e){return Array.from((Ct.get(e)||e).children).filter(function(a){return a.tagName==="STYLE"})}function bn(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ca())return null;var t=a.csp,o=a.prepend,i=a.priority,s=i===void 0?0:i,l=Sa(o),n=l==="prependQueue",d=document.createElement("style");d.setAttribute(gn,l),n&&s&&d.setAttribute(vn,"".concat(s)),t!=null&&t.nonce&&(d.nonce=t==null?void 0:t.nonce),d.innerHTML=e;var u=wt(a),m=u.firstChild;if(o){if(n){var c=(a.styles||Et(u)).filter(function(f){if(!["prepend","prependQueue"].includes(f.getAttribute(gn)))return!1;var g=Number(f.getAttribute(vn)||0);return s>=g});if(c.length)return u.insertBefore(d,c[c.length-1].nextSibling),d}u.insertBefore(d,m)}else u.appendChild(d);return d}function Na(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=wt(a);return(a.styles||Et(t)).find(function(o){return o.getAttribute(yn(a))===e})}function Ia(e,a){var t=Ct.get(e);if(!t||!wa(document,t)){var o=bn("",a),i=o.parentNode;Ct.set(e,i),e.removeChild(o)}}function Pa(e,a){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=wt(t),i=Et(o),s=je(je({},t),{},{styles:i});Ia(o,s);var l=Na(a,s);if(l){var n,d;if((n=s.csp)!==null&&n!==void 0&&n.nonce&&l.nonce!==((d=s.csp)===null||d===void 0?void 0:d.nonce)){var u;l.nonce=(u=s.csp)===null||u===void 0?void 0:u.nonce}return l.innerHTML!==e&&(l.innerHTML=e),l}var m=bn(e,s);return m.setAttribute(yn(s),a),m}function xn(e){var a;return e==null||(a=e.getRootNode)===null||a===void 0?void 0:a.call(e)}function ka(e){return xn(e)instanceof ShadowRoot}function Oa(e){return ka(e)?xn(e):null}var St={},Nt=[],Ra=function(a){Nt.push(a)};function Ta(e,a){if(process.env.NODE_ENV!=="production"&&!e&&console!==void 0){var t=Nt.reduce(function(o,i){return i(o??"","warning")},a);t&&console.error("Warning: ".concat(t))}}function Fa(e,a){if(process.env.NODE_ENV!=="production"&&!e&&console!==void 0){var t=Nt.reduce(function(o,i){return i(o??"","note")},a);t&&console.warn("Note: ".concat(t))}}function La(){St={}}function jn(e,a,t){!a&&!St[t]&&(e(!1,t),St[t]=!0)}function ot(e,a){jn(Ta,e,a)}function Ma(e,a){jn(Fa,e,a)}ot.preMessage=Ra,ot.resetWarned=La,ot.noteOnce=Ma;function _a(e){return e.replace(/-(.)/g,function(a,t){return t.toUpperCase()})}function Aa(e,a){ot(e,"[@ant-design/icons] ".concat(a))}function Cn(e){return Oe(e)==="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(Oe(e.icon)==="object"||typeof e.icon=="function")}function wn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(a,t){var o=e[t];switch(t){case"class":a.className=o,delete a.class;break;default:delete a[t],a[_a(t)]=o}return a},{})}function It(e,a,t){return t?L.createElement(e.tag,je(je({key:a},wn(e.attrs)),t),(e.children||[]).map(function(o,i){return It(o,"".concat(a,"-").concat(e.tag,"-").concat(i))})):L.createElement(e.tag,je({key:a},wn(e.attrs)),(e.children||[]).map(function(o,i){return It(o,"".concat(a,"-").concat(e.tag,"-").concat(i))}))}function En(e){return bt(e)[0]}function Sn(e){return e?Array.isArray(e)?e:[e]:[]}var Ba=`
.anticon {
  display: inline-flex;
  alignItems: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,$a=function(a){var t=L.useContext(en),o=t.csp,i=t.prefixCls,s=Ba;i&&(s=s.replace(/anticon/g,i)),L.useEffect(function(){var l=a.current,n=Oa(l);Pa(s,"@ant-design-icons",{prepend:!0,csp:o,attachTo:n})},[])},Da=["icon","className","onClick","style","primaryColor","secondaryColor"],Ye={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function za(e){var a=e.primaryColor,t=e.secondaryColor;Ye.primaryColor=a,Ye.secondaryColor=t||En(a),Ye.calculated=!!t}function Va(){return je({},Ye)}var it=function(a){var t=a.icon,o=a.className,i=a.onClick,s=a.style,l=a.primaryColor,n=a.secondaryColor,d=rn(a,Da),u=E.useRef(),m=Ye;if(l&&(m={primaryColor:l,secondaryColor:n||En(l)}),$a(u),Aa(Cn(t),"icon should be icon definiton, but got ".concat(t)),!Cn(t))return null;var c=t;return c&&typeof c.icon=="function"&&(c=je(je({},c),{},{icon:c.icon(m.primaryColor,m.secondaryColor)})),It(c.icon,"svg-".concat(c.name),je(je({className:o,onClick:i,style:s,"data-icon":c.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},d),{},{ref:u}))};it.displayName="IconReact",it.getTwoToneColors=Va,it.setTwoToneColors=za;const Pt=it;function Nn(e){var a=Sn(e),t=nn(a,2),o=t[0],i=t[1];return Pt.setTwoToneColors({primaryColor:o,secondaryColor:i})}function qa(){var e=Pt.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}var Ua=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];Nn(ja.primary);var st=E.forwardRef(function(e,a){var t=e.className,o=e.icon,i=e.spin,s=e.rotate,l=e.tabIndex,n=e.onClick,d=e.twoToneColor,u=rn(e,Ua),m=E.useContext(en),c=m.prefixCls,f=c===void 0?"anticon":c,g=m.rootClassName,y=aa(g,f,mt(mt({},"".concat(f,"-").concat(o.name),!!o.name),"".concat(f,"-spin"),!!i||o.name==="loading"),t),h=l;h===void 0&&n&&(h=-1);var b=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,x=Sn(d),j=nn(x,2),N=j[0],R=j[1];return E.createElement("span",Se({role:"img","aria-label":o.name},u,{ref:a,tabIndex:h,onClick:n,className:y}),E.createElement(Pt,{icon:o,primaryColor:N,secondaryColor:R,style:b}))});st.displayName="AntdIcon",st.getTwoToneColor=qa,st.setTwoToneColor=Nn;const Ze=st;var Wa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}},{tag:"path",attrs:{d:"M376.9 656.4c1.8-33.5 15.7-64.7 39.5-88.6 25.4-25.5 60-39.8 96-39.8 36.2 0 70.3 14.1 96 39.8 1.4 1.4 2.7 2.8 4.1 4.3l-25 19.6a8 8 0 003 14.1l98.2 24c5 1.2 9.9-2.6 9.9-7.7l.5-101.3c0-6.7-7.6-10.5-12.9-6.3L663 532.7c-36.6-42-90.4-68.6-150.5-68.6-107.4 0-195 85.1-199.4 191.7-.2 4.5 3.4 8.3 8 8.3H369c4.2-.1 7.7-3.4 7.9-7.7zM703 664h-47.9c-4.2 0-7.7 3.3-8 7.6-1.8 33.5-15.7 64.7-39.5 88.6-25.4 25.5-60 39.8-96 39.8-36.2 0-70.3-14.1-96-39.8-1.4-1.4-2.7-2.8-4.1-4.3l25-19.6a8 8 0 00-3-14.1l-98.2-24c-5-1.2-9.9 2.6-9.9 7.7l-.4 101.4c0 6.7 7.6 10.5 12.9 6.3l23.2-18.2c36.6 42 90.4 68.6 150.5 68.6 107.4 0 195-85.1 199.4-191.7.2-4.5-3.4-8.3-8-8.3z"}}]},name:"cloud-sync",theme:"outlined"};const Ha=Wa;var Ka=function(a,t){return E.createElement(Ze,Se({},a,{ref:t,icon:Ha}))},In=E.forwardRef(Ka);process.env.NODE_ENV!=="production"&&(In.displayName="CloudSyncOutlined");const Ae=In;var Ja={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};const Ya=Ja;var Za=function(a,t){return E.createElement(Ze,Se({},a,{ref:t,icon:Ya}))},Pn=E.forwardRef(Za);process.env.NODE_ENV!=="production"&&(Pn.displayName="DeleteOutlined");const Ga=Pn;var Xa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};const Qa=Xa;var eo=function(a,t){return E.createElement(Ze,Se({},a,{ref:t,icon:Qa}))},kn=E.forwardRef(eo);process.env.NODE_ENV!=="production"&&(kn.displayName="InfoCircleOutlined");const Ce=kn;var to={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};const no=to;var ro=function(a,t){return E.createElement(Ze,Se({},a,{ref:t,icon:no}))},On=E.forwardRef(ro);process.env.NODE_ENV!=="production"&&(On.displayName="MinusCircleOutlined");const lt=On;var ao={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"};const oo=ao;var io=function(a,t){return E.createElement(Ze,Se({},a,{ref:t,icon:oo}))},Rn=E.forwardRef(io);process.env.NODE_ENV!=="production"&&(Rn.displayName="PlusOutlined");const Be=Rn,so=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="taskNode",n.text="LLM",n.width=700,n.jadeConfig=[{id:0,text:"Philosopher’s Path",done:!0},{id:1,text:"Visit the temple",done:!1},{id:2,text:"Drink matcha",done:!1}],n.getReactComponents=()=>r.jsxs(r.Fragment,{children:[r.jsx("h1",{children:"Day off in Kyoto"}),r.jsx(Kr,{}),r.jsx(Wr,{})]}),n.getHeaderIcon=()=>r.jsx(Ae,{}),n.reducers=(d,u)=>{switch(u.type){case"added":return[...d,{id:u.id,text:u.text,done:!1}];case"changed":return d.map(m=>m.id===u.task.id?u.task:m);case"deleted":return d.filter(m=>m.id!==u.id);default:throw Error("Unknown action: "+u.type)}},n},lo=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null,E.createElement("clipPath",{id:"clip4_13285"},E.createElement("rect",{id:"\\u56FE\\u6807/16/\\u5F00\\u59CB\\uFF0C\\u8D77\\u70B9\\uFF0C\\u7AEF\\u70B9",width:16,height:16,transform:"matrix(-1 0 0 1 20 4)",fill:"white",fillOpacity:0}))),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,transform:"matrix(-1 0 0 1 24 0)",fill:"#5E7CE0",fillOpacity:1}),E.createElement("g",{clipPath:"url(#clip4_13285)"},E.createElement("path",{id:"path",d:"M7.41 11.52L5.83 11.52L5.83 6.31L12.53 6.31C15.64 6.37 18.16 8.89 18.16 11.99C18.16 15.1 15.64 17.62 12.53 17.67L5.83 17.67L5.83 12.46L10.92 12.46L10.92 13.52L13.91 13.52L13.91 10.47L10.92 10.47L10.92 11.53L7.41 11.53L7.41 11.52Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),co=({shape:e})=>{const[a,t]=L.useState(0);return L.useEffect(()=>{e.page.addEventListener("TOOL_MENU_CHANGE",o=>{t(o[0])})},[]),r.jsx(r.Fragment,{children:r.jsx(Jt,{shape:e})})},uo=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);n.type="endNodeEnd",n.backColor="white",n.pointerEvents="auto",n.text="结束",n.componentName="endComponent",n.flowMeta={triggerMode:"auto",callback:{type:"general_callback",name:"通知回调",fitables:["com.huawei.fit.jober.aipp.fitable.AippFlowEndCallback"],converter:{type:"mapping_converter"}}};const d=n.getToolMenus;n.getToolMenus=()=>n.page.shapes.filter(f=>f.type===n.type).length===1?[{key:"1",label:"复制",action:()=>{n.duplicate()}},{key:"2",label:"重命名",action:f=>{f(!0)}}]:d.apply(n);const u=n.remove;n.remove=f=>{if(n.page.shapes.filter(b=>b.type==="endNodeEnd").length<=1&&n.type==="endNodeEnd")return[];const y=u.apply(n,[f]);return n.page.shapes.filter(b=>b.type==="endNodeEnd").length===1&&n.page.triggerEvent({type:"TOOL_MENU_CHANGE",value:[1]}),y};const m=n.initConnectors;n.initConnectors=()=>{m.apply(n),n.connectors.remove(f=>f.direction.key===ne.DIRECTION.E.key)},n.serializerJadeConfig=()=>{n.flowMeta.callback.converter.entity=n.getLatestJadeConfig()},n.getComponent=()=>n.graph.plugins[n.componentName](n.flowMeta.callback.converter.entity),n.getEntity=()=>n.flowMeta.callback.converter.entity,n.getHeaderComponent=()=>r.jsx(co,{shape:n}),n.getHeaderIcon=()=>r.jsx(r.Fragment,{children:r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(lo,{})})});const c=n.created;return n.created=()=>{c.apply(n),n.page.shapes.filter(g=>g.type===n.type).length===2&&n.page.triggerEvent({type:"TOOL_MENU_CHANGE",value:[n.page.shapes.filter(g=>g.type==="endNodeEnd").length]})},n},Re=({reference:e,onReferencedValueChange:a,onReferencedKeyChange:t,rules:o,className:i,...s})=>{const l=ue(),n=_e(),d=L.useRef(null),[u,m]=L.useState([]),c=`reference-${e.id}`,f=`jade-tree-select ${i||""}`.trim(),g=x=>{if(!x)return;d.current&&d.current();const j=new Map(u.map(w=>[w.id,w])),N=j.get(x),R=y(j,N);d.current=l.observeTo(N.nId,N.value,w=>b(w.value,w.type)),t({referenceNode:N.nId,referenceId:N.value,value:R})},y=(x,j)=>{const N=[];N.unshift(j.title);let R=j.pId;for(;R;){const w=x.get(R);if(!w||w.pId===0)break;N.unshift(w.title),R=w.pId}return N},h=()=>{const j=l.getPreNodeInfos().map(N=>{const R=[];return R.push({id:N.id,pId:0,value:N.id,title:N.name,selectable:!1}),N.observableList.forEach(w=>{w.parentId||(w.parentId=N.id);const ae={nId:N.id,id:w.observableId,pId:w.parentId,value:w.observableId,title:w.value};R.push(ae)}),R}).flatMap(N=>N);m(j)};L.useEffect(()=>(e.referenceNode&&e.referenceId&&(d.current=l.observeTo(e.referenceNode,e.referenceId,x=>b(x.value,x.type))),()=>{d.current&&d.current()}),[]);const b=(x,j)=>{n.setFieldsValue({[c]:x}),a(x,j)};return r.jsx(r.Fragment,{children:r.jsx(v.Form.Item,{id:`reference-id-${e.id}`,name:[c],initialValue:e.referenceKey,rules:o,validateTrigger:"onBlur",children:r.jsx(v.TreeSelect,{...s,className:f,treeDataSimpleMode:!0,dropdownStyle:{maxHeight:400,overflow:"auto",minWidth:250},placeholder:"请选择",onChange:g,treeData:u,onDropdownVisibleChange:h,treeDefaultExpandAll:!1,onMouseDown:x=>x.stopPropagation()})})})};function fo({item:e,handleItemChange:a}){const t=`value-${e.id}`,o=_e(),i=d=>{a(e.id,[{key:"referenceKey",value:d}])},s=d=>{a(e.id,[{key:"referenceNode",value:d.referenceNode},{key:"referenceId",value:d.referenceId},{key:"value",value:d.value}])},l=()=>d=>{d.target.value&&a(e.id,[{key:"value",value:d.target.value}])},n=d=>{switch(d){case"Reference":return r.jsx(r.Fragment,{children:r.jsx(Re,{reference:e,onReferencedValueChange:i,onReferencedKeyChange:s,style:{fontSize:"12px"},placeholder:"请选择",onMouseDown:u=>u.stopPropagation(),showSearch:!0,className:"value-custom jade-select",dropdownStyle:{maxHeight:400,overflow:"auto"},value:e.value,rules:[{required:!0,message:"字段值不能为空"}]})});case"String":return r.jsx(r.Fragment,{children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},id:`value-${e.id}`,name:`value-${e.id}`,rules:[{required:!0,message:"字段值不能为空"}],validateTrigger:"onBlur",children:r.jsx(v.Input,{className:"value-custom jade-input",style:{fontSize:"12px"},placeholder:"请输入",value:e.value,onBlur:l})})});default:return null}};return r.jsxs(v.Row,{gutter:16,children:[r.jsx(v.Col,{span:8,style:{display:"flex",paddingTop:"5px"},children:r.jsx("span",{className:"end-starred-text",children:"finalOutput"})}),r.jsx(v.Col,{span:6,style:{paddingRight:0},children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},id:`valueSource-${e.id}`,initialValue:"Reference",children:r.jsx(v.Select,{onMouseDown:d=>d.stopPropagation(),id:`valueSource-select-${e.id}`,className:"value-source-custom jade-select",style:{width:"100%"},onChange:d=>{o.resetFields([`reference-${e.id}`,t]);let u=[{key:"from",value:d},{key:"value",value:""}];d==="String"&&(u=[{key:"from",value:d},{key:"value",value:""},{key:"referenceNode",value:""},{key:"referenceId",value:""},{key:"referenceKey",value:""}]),a(e.id,u)},options:[{value:"Reference",label:"引用"},{value:"String",label:"输入"}],value:e.from})})}),r.jsx(v.Col,{span:10,style:{paddingLeft:0},children:n(e.from)})]},`output-variable-${e.id}`)}const{Panel:po}=v.Collapse;function mo(){const e=re(),a=te(),t=()=>a&&a.inputParams,o=(s,l)=>{e({type:"editOutputVariable",id:s,changes:l})},i=r.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[r.jsx("p",{children:"这些变量将在机器人完成工作流调用后输出。"}),r.jsx("p",{children:"在“返回变量”模式下，这些变量将由机器人汇总并回复给用户；"}),r.jsx("p",{children:"在“直接回答”模式下，机器人将只回复配置卡时可以使用的变量"})]});return r.jsx("div",{children:r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",style:{marginTop:"10px",marginBottom:8,borderRadius:"8px",width:"100%"},defaultActiveKey:["Output variable"],children:r.jsxs(po,{style:{marginBottom:8,borderRadius:"8px",width:"100%"},header:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[r.jsx("span",{className:"jade-panel-header-font",children:"输出"}),r.jsx(v.Popover,{content:i,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:[r.jsxs(v.Row,{gutter:16,children:[r.jsx(v.Col,{span:8,children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"字段名称"})})}),r.jsx(v.Col,{span:16,children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"字段值"})})})]}),r.jsx(fo,{item:t()[0],handleItemChange:o})]},"Output variable")})})}function ho(){return r.jsx("div",{style:{backgroundColor:"white"},children:r.jsx(mo,{})})}const go=e=>{const a={};return a.getJadeConfig=()=>e||{inputParams:[{id:F(),name:"finalOutput",type:"String",from:"Reference",referenceNode:"",referenceId:"",referenceKey:"",value:[]}],outputParams:[{}]},a.getReactComponents=()=>r.jsx(ho,{}),a.reducers=(t,o)=>{const i=()=>{const l=s.inputParams.find(n=>n.name==="finalOutput");o.changes.forEach(n=>{l[n.key]=n.value})},s={...t};switch(o.type){case"editOutputVariable":return i(),s;default:throw Error("Unknown action: "+o.type)}},a},vo=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null,E.createElement("clipPath",{id:"clip4_13287"},E.createElement("rect",{id:"\\u56FE\\u6807/16/\\u6570\\u636E\\u68C0\\u7D22\\uFF0C\\u67E5\\u627E",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#50D4AB",fillOpacity:1}),E.createElement("g",{clipPath:"url(#clip4_13287)"},E.createElement("path",{id:"path",d:"M12.11 10.24C15.33 10.24 18.03 9.02 18.03 7.62C18.03 6.14 15.42 5.01 12.11 5.01C8.8 5.01 6.19 6.23 6.19 7.62C6.19 9.1 8.8 10.24 12.11 10.24ZM12.11 13.02L12.37 13.02C12.89 11.8 14.11 11.02 15.59 11.02C16.29 11.02 16.9 11.19 17.51 11.54C17.86 11.19 18.12 10.85 18.12 10.41L18.12 8.32C18.12 9.8 15.51 10.93 12.2 10.93C8.97 10.93 6.27 9.71 6.27 8.32L6.27 10.32C6.19 11.8 8.8 13.02 12.11 13.02ZM12.11 15.72L12.28 15.72C12.11 15.38 12.02 14.94 12.02 14.5C12.02 14.24 12.02 13.98 12.11 13.72C8.89 13.72 6.19 12.5 6.19 11.11L6.19 13.11C6.19 14.59 8.8 15.72 12.11 15.72ZM14.55 17.81C13.77 17.55 13.07 17.12 12.63 16.42L12.11 16.42C8.89 16.42 6.19 15.2 6.19 13.81L6.19 15.81C6.19 17.29 8.8 18.42 12.11 18.42C12.98 18.42 13.85 18.34 14.64 18.16C14.55 18.08 14.55 17.99 14.55 17.81ZM19.69 17.9L17.86 16.07L17.77 15.99C18.03 15.55 18.21 15.03 18.21 14.42C18.21 12.85 16.9 11.54 15.33 11.54C13.77 11.54 12.46 12.85 12.46 14.42C12.46 15.99 13.77 17.29 15.33 17.29C15.86 17.29 16.29 17.12 16.73 16.94C16.73 16.94 16.73 17.03 16.81 17.03L18.64 18.86C18.82 19.03 19.25 19.03 19.52 18.77C19.86 18.42 19.86 18.08 19.69 17.9ZM13.33 14.42C13.33 13.28 14.29 12.33 15.42 12.33C16.55 12.33 17.51 13.28 17.51 14.42C17.51 15.55 16.55 16.51 15.42 16.51C14.2 16.51 13.33 15.55 13.33 14.42Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),de=e=>{const{onMouseDown:a,...t}=e,o=i=>{a&&a(i),i.stopPropagation()};return r.jsx(r.Fragment,{children:r.jsx(v.Select,{onMouseDown:i=>o(i),...t})})},{Panel:yo}=v.Collapse;function Tn(){const e=re(),a=te(),t=a&&a.inputParams.find(c=>c.name==="query"),o=_e(),i=`input-${t.id}`,s=(c,f)=>{e({type:"editInput",id:c,changes:f})},l=(c,f)=>{s(c.id,[{key:"referenceKey",value:f}])},n=(c,f)=>{s(c.id,[{key:"referenceNode",value:f.referenceNode},{key:"referenceId",value:f.referenceId},{key:"value",value:f.value}])},d=c=>f=>{f.target.value&&s(c.id,[{key:"value",value:f.target.value}])},u=c=>{switch(c.from){case"Reference":return r.jsx(r.Fragment,{children:r.jsx(Re,{reference:c,onReferencedValueChange:f=>l(c,f),onReferencedKeyChange:f=>n(c,f),style:{fontSize:"12px"},placeholder:"请选择",onMouseDown:f=>f.stopPropagation(),showSearch:!0,className:"value-custom jade-select",dropdownStyle:{maxHeight:400,overflow:"auto"},rules:[{required:!0,message:"字段值不能为空"}]})});case"Input":return r.jsx(r.Fragment,{children:r.jsx(v.Form.Item,{id:`input-${c.id}`,name:`input-${c.id}`,rules:[{required:!0,message:"字段值不能为空"},{pattern:/^[^\s]*$/,message:"禁止输入空格"}],initialValue:c.value,validateTrigger:"onBlur",children:r.jsx(v.Input,{className:"value-custom jade-input",placeholder:"清输入",value:c.value,onBlur:d(c)})})});default:return null}},m=r.jsx("div",{className:"jade-font-size",children:r.jsx("p",{children:"输入需要从知识库中匹配的关键信息"})});return r.jsx("div",{children:r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["Input"],children:r.jsxs(yo,{header:r.jsxs("div",{className:"panel-header",children:[r.jsx("span",{className:"jade-panel-header-font",children:"输入"}),r.jsx(v.Popover,{content:m,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:[r.jsxs(v.Row,{children:[r.jsx(v.Col,{span:8,children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"字段名称"})})}),r.jsx(v.Col,{span:16,children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"字段值"})})})]}),r.jsxs(v.Row,{children:[r.jsx(v.Col,{span:8,style:{display:"flex",paddingTop:"5px"},children:r.jsx("span",{className:"retrieval-starred-text",children:"query"})}),r.jsx(v.Col,{span:8,style:{paddingRight:0},children:r.jsx(v.Form.Item,{id:"valueSource",initialValue:"Reference",children:r.jsx(de,{id:`valueSource-select-${t.id}`,className:"value-source-custom jade-select",style:{width:"100%"},onChange:c=>{let f=[{key:"from",value:c},{key:"value",value:""}];c==="Input"&&(f=[{key:"from",value:c},{key:"value",value:""},{key:"referenceNode",value:""},{key:"referenceId",value:""},{key:"referenceKey",value:""}]),s(t.id,f),o.resetFields([`reference-${t.id}`,i])},options:[{value:"Reference",label:"引用"},{value:"Input",label:"输入"}],value:t.from})})}),r.jsxs(v.Col,{span:8,style:{paddingLeft:0},children:[u(t)," "]})]})]},"Input")})})}function bo(){const e=re(),a=te(),t=a&&a.inputParams.find(s=>s.name==="maximum").value,o=r.jsx("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:r.jsx("p",{children:"从知识返回到模型的最大段落数。数字越大，返回的内容越多。"})}),i={1:"1",3:"默认",10:"10"};return r.jsxs(v.Row,{className:"jade-row",children:[r.jsx(v.Col,{span:12,className:"jade-column",children:r.jsxs(v.Form.Item,{children:[r.jsx("span",{style:{fontSize:"12px",fontFamily:"SF Pro Display",letterSpacing:"0.12px",lineHeight:"16px",alignItems:"center",userSelect:"none",marginRight:"4px",color:"rgba(28, 29, 35, 0.35)"},children:"返回最大值"}),r.jsx(v.Popover,{content:o,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})})]})}),r.jsx(v.Col,{span:12,children:r.jsx(v.Form.Item,{style:{marginBottom:"0"},id:"valueSource",initialValue:"Reference",children:r.jsx(v.Slider,{className:"jade-slider",style:{width:"90%"},min:1,max:10,step:1,marks:i,defaultValue:3,value:t,onChange:s=>e({type:"changeMaximum",key:"maximum",value:s})})})})]})}const xo=(e={})=>{const a=Tr.create({withCredentials:!0,timeout:1e4,headers:{"Content-Type":"application/json",...e}});return a.interceptors.request.use(t=>t,t=>Promise.reject(t)),a.interceptors.response.use(t=>t.data,t=>Promise.reject(t)),a},ct=(e,a,t,o,i=()=>{},s=()=>{})=>{xo(t).request({method:e,url:a,data:o}).then(n=>{i(n)}).catch(n=>{s(n)})},Te={get:(e,a=new Map,t,o)=>{ct("Get",e,a,{},t,o)},post:(e,a,t=new Map,o,i)=>{ct("Post",e,t,a,o,i)},put:(e,a,t=new Map,o,i)=>{ct("Put",e,t,a,o,i)},del:(e,a=new Map,t,o)=>{ct("Delete",e,a,{},t,o)}};function kt(e){const[a,t]=L.useState([]),[o,i]=L.useState(!1),[s,l]=L.useState(1),{buildUrl:n,onChange:d,getOptions:u,disabled:m,dealResponse:c,...f}=e,g=n(s),y=async x=>{x&&a.length===0&&(i(!0),Te.get(g,void 0,j=>{const N=c(j);N&&t(N),i(!1)},j=>{console.error("Error fetching options:",j),i(!1)}))},h=async x=>{const{target:j}=x;if(j.scrollTop+j.clientHeight!==j.scrollHeight)return;console.log("Scroll to bottom. Loading new page...");const N=s;l(s+1),i(!0),Te.get(g,void 0,R=>{const w=R.data;w&&t([...a,...w]),i(!1)},R=>{console.error("Error fetching options:",R),i(!1),l(N)})},b=x=>{d(x,a)};return r.jsx(de,{className:"jade-select",style:{width:"100%"},onPopupScroll:h,onDropdownVisibleChange:y,onChange:b,disabled:m||!1,options:u(a),loading:o,mode:"single",...f})}const{Panel:jo}=v.Collapse;function Fn(){const e=re(),a=te(),t=ue(),o=a&&[...a.inputParams.find(h=>h.name==="knowledge").value],i=t.graph.configs&&t.graph.configs.find(h=>h.node==="knowledgeState").urls.knowledgeUrl,s=h=>i+"?pageNum="+h+"&pageSize=10",l=()=>o.length<=1,n=h=>{e({type:"addKnowledge",id:F()}),h.stopPropagation()},d=(h,b,x,j)=>{e({type:"editKnowledge",id:h,key:b,value:j.find(N=>N.id===x)})},u=h=>{e({type:"clearKnowledge",id:h})},m=h=>{e({type:"deleteKnowledge",id:h})},c=h=>h.data.items,f=h=>h.map(b=>({value:b.id,label:b.name})),g=h=>h.value&&h.value.length!==0?h.value.find(b=>b.name==="name").value:"",y=r.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[r.jsx("p",{children:"选择需要匹配的知识范围，"}),r.jsx("p",{children:"仅从所选知识中调出信息"})]});return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",style:{marginTop:"10px",marginBottom:8,borderRadius:"8px",width:"100%"},defaultActiveKey:["Knowledge"],children:r.jsxs(jo,{style:{marginBottom:8,borderRadius:"8px",width:"100%"},header:r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("span",{className:"jade-panel-header-font",children:"知识库"}),r.jsx(v.Popover,{content:y,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})}),r.jsx(v.Button,{type:"text",className:"icon-button",onClick:h=>n(h),style:{height:"22px",marginLeft:"auto"},children:r.jsx(Be,{})})]}),className:"jade-panel",children:[o.map(h=>r.jsxs(v.Row,{gutter:16,children:[r.jsx(v.Col,{span:22,children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},id:`knowledge-${h.id}`,children:r.jsx(kt,{allowClear:!0,placeholder:"选择知识库",id:`valueSource-select-${h.id}`,onClear:()=>u(h.id),onChange:(b,x)=>d(h.id,"value",b,x),buildUrl:s,disabled:!1,getOptions:f,dealResponse:c,value:g(h)})},`knowledge-${h.id}`)}),r.jsx(v.Col,{span:2,style:{paddingLeft:"2px"},children:r.jsx(v.Form.Item,{style:{marginBottom:"8px"},children:r.jsx(v.Button,{disabled:l(),type:"text",className:"icon-button",style:{alignItems:"center",marginLeft:"auto"},onClick:()=>m(h.id),children:r.jsx(lt,{})})},`button-${h.id}`)})]},`knowledgeRow-${h.id}`)),r.jsx(bo,{})]},"Knowledge")})}const Ge=({data:e})=>{if(!Array.isArray(e))throw new Error("data must be array.");const[a,t]=L.useState(null),o=ue();L.useEffect(()=>{const n=e.map(d=>s(d,null));return t(n),()=>{n&&i(n,d=>{o.page.removeObservable(o.id,d.key)})}},[]);const i=(n,d)=>{n.forEach(u=>{u.children&&i(u.children,d),d(u)})},s=(n,d)=>(o.page.registerObservable(o.id,n.id,n.name,n.type,d?d.id:null),n.type==="Object"?{title:n.name,type:n.type,key:n.id,children:n.value.map(u=>s(u,n))}:{title:n.name,type:n.type,key:n.id,isLeaf:!0}),l=n=>r.jsx(r.Fragment,{children:r.jsx("div",{className:"jade-observable-tree-node-div",children:r.jsxs("div",{style:{display:"flex"},children:[r.jsx("span",{className:"jade-observable-tree-node-title",children:n.title}),r.jsx("div",{className:"jade-observable-tree-node-type-div",children:r.jsx("span",{className:"jade-observable-tree-node-type-name",children:n.type})})]})})});return r.jsx(r.Fragment,{children:r.jsx(v.Tree,{treeData:a,titleRender:n=>l(n),showLine:!0,selectable:!1})})},{Panel:Co}=v.Collapse;function Ln(){const e=te();ue();const a=e&&e.outputParams,t=r.jsx("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:r.jsx("p",{children:"输出列表是与输入参数最匹配的信息，从所有选定的知识库中调用"})});return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",style:{marginTop:"10px",marginBottom:8,borderRadius:"8px",width:"100%"},defaultActiveKey:["Output"],children:r.jsx(Co,{header:r.jsxs("div",{style:{display:"flex",alignItems:"center",paddingLeft:"-16px"},children:[r.jsx("span",{className:"jade-panel-header-font",children:"输出"}),r.jsx(v.Popover,{content:t,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:r.jsx(Ge,{data:a})},"Output")})}const wo=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="retrievalNodeState",n.backColor="white",n.pointerEvents="auto",n.text="普通检索",n.componentName="retrievalComponent",n.flowMeta.jober.fitables.push("com.huawei.fit.jober.aipp.fitable.NaiveRAGComponent"),n.flowMeta.triggerMode="auto",n.getReactComponents=()=>r.jsxs(r.Fragment,{children:[r.jsx(Tn,{}),r.jsx(Fn,{}),r.jsx(Ln,{})]}),n.getHeaderIcon=()=>r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(vo,{})}),n},Eo=e=>{const a={};return a.getJadeConfig=()=>e||{inputParams:[{id:"query_"+F(),name:"query",type:"String",from:"Reference",referenceNode:"",referenceId:"",referenceKey:"",value:[]},{id:"knowledge_"+F(),name:"knowledge",type:"Array",from:"Expand",value:[{id:F(),type:"Object",from:"Expand",value:[]}]},{id:"maximum_"+F(),name:"maximum",type:"Integer",from:"Input",value:3}],outputParams:[{id:"output_"+F(),name:"output",type:"Object",from:"Expand",value:[{id:F(),name:"retrievalOutput",type:"String",from:"Input",value:"String"}]}]},a.getReactComponents=()=>r.jsxs(r.Fragment,{children:[r.jsx(Tn,{}),r.jsx(Fn,{}),r.jsx(Ln,{})]}),a.reducers=(t,o)=>{const i=()=>{const f=c.inputParams.find(g=>g.name==="query");o.changes.map(g=>{f[g.key]=g.value})},s=()=>{u().push({id:o.id,name:"",type:"Object",from:"Expand",value:[]})},l=()=>{const f=u(),g=f.findIndex(y=>y.id===o.id);g!==-1&&f.splice(g,1)},n=()=>{if(!o.value)return;const f=o.value.id,g=o.value.name,y=u().find(h=>h.id===o.id).value;y.length===0?(y.push({id:F(),name:"id",from:"Input",type:"String",value:f}),y.push({id:F(),name:"name",from:"Input",type:"String",value:g})):y.forEach(h=>{h.name==="id"&&(h.value=f),h.name==="name"&&(h.value=g)})},d=()=>{c.inputParams.filter(f=>f.name==="maximum").forEach(f=>{f.value=o.value})},u=()=>c.inputParams.find(f=>f.name==="knowledge").value,m=()=>{u().find(f=>f.id===o.id).value=[]};let c={...t};switch(o.type){case"editInput":return i(),c;case"addKnowledge":return s(),c;case"deleteKnowledge":return l(),c;case"editKnowledge":return n(),c;case"changeMaximum":return d(),c;case"clearKnowledge":return m(),c;default:throw Error("Unknown action: "+o.type)}},a},So=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="listener1Node",n.text="被监听者",n.componentName="listener1Component",n.getHeaderIcon=()=>r.jsx(Ae,{}),n},Ot=e=>{const{onChange:a,onBlur:t,...o}=e;if(!o.id)throw new Error("JadeObservableInput requires an id property.");const i=ue();if(!i)throw new Error("JadeObservableInput must be wrapped by ShapeContext.");const s=n=>{a&&a(n),i.emit(o.id,{value:n.target.value})},l=n=>{t&&t(n)};return L.useEffect(()=>(i.page.registerObservable(i.id,o.id,o.value,o.type,o.parent),()=>{i.page.removeObservable(i.id,o.id)}),[]),L.useEffect(()=>{i.emit(o.id,{type:o.type})},[o.type]),r.jsx(r.Fragment,{children:r.jsx(v.Input,{...o,onChange:n=>s(n),onBlur:l})})},No=e=>{const a={};return a.getJadeConfig=()=>e||[{id:"listener1-name",name:"name",type:"String",value:"请输入一个名字"},{id:"listener1-firstName",name:"firstName",type:"String",value:"请输入第一名字"}],a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(Io,{})}),a.reducers=(t,o)=>{switch(o.type){case"updateName":return t.map(i=>i.id===o.id?{...i,name:o.name}:i);default:throw Error("Unknown action: "+o.type)}},a},Io=()=>{const e=te(),a=re(),t=(o,i)=>{a({type:"updateName",id:o,name:i.target.value})};return r.jsx(r.Fragment,{children:r.jsxs("div",{children:[r.jsx(Ot,{id:e[0].id,value:e[0].name,onChange:o=>t(e[0].id,o)}),r.jsx(Ot,{id:e[1].id,parent:e[0].id,value:e[1].name,onChange:o=>t(e[1].id,o)})]})})},Po=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="listener2Node",n.text="监听者",n.componentName="listener2Component",n.getHeaderIcon=()=>r.jsx(Ae,{}),n},ko=e=>{const a={};return a.getJadeConfig=()=>e||[{id:"123456",name:"zzzzz",type:"Reference",value:[],referenceNode:"",referenceId:"",referenceKey:""}],a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(Oo,{})}),a.reducers=(t,o)=>{switch(o.type){case"updateValue":return t.map(i=>i.id===o.id?{...i,referenceKey:o.referenceKey}:i);case"update":return t.map(i=>i.id===o.id?{...i,referenceNode:o.referenceNode,referenceId:o.referenceId,value:o.value}:i);default:throw Error("Unknown action: "+o.type)}},a},Oo=()=>{const e=re(),a=te();return r.jsx(r.Fragment,{children:r.jsx(Re,{reference:a[0],onReferencedValueChange:t=>{e({type:"updateValue",id:a[0].id,referenceKey:t})},onReferencedKeyChange:t=>{e({type:"update",id:a[0].id,referenceNode:t.referenceNode,referenceId:t.referenceId,value:t.value})}})})},Ro=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="listener3Node",n.text="被监听者",n.componentName="listener3Component",n.getHeaderIcon=()=>r.jsx(Ae,{}),n},To=e=>{const a={};return a.getJadeConfig=()=>e||{output:[{id:"uuid1",name:"person",type:"Object",value:[{id:"uuid2",name:"name",type:"String"},{id:"uuid3",name:"age",type:"Integer"}]}]},a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(Fo,{})}),a.reducers=()=>{},a},Fo=()=>{const e=te();return r.jsx(r.Fragment,{children:r.jsx("div",{children:r.jsx(Ge,{data:e.output})})})},Lo=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="jadeInputTreeNode",n.text="被监听者",n.componentName="jadeInputTreeComponent",n.width=360,n.getHeaderIcon=()=>r.jsx(Ae,{}),n};var Rt={exports:{}},ut={exports:{}},G={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mn;function Mo(){if(Mn)return G;Mn=1;var e=typeof Symbol=="function"&&Symbol.for,a=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,n=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,m=e?Symbol.for("react.forward_ref"):60112,c=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,g=e?Symbol.for("react.memo"):60115,y=e?Symbol.for("react.lazy"):60116,h=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,x=e?Symbol.for("react.responder"):60118,j=e?Symbol.for("react.scope"):60119;function N(w){if(typeof w=="object"&&w!==null){var ae=w.$$typeof;switch(ae){case a:switch(w=w.type,w){case d:case u:case o:case s:case i:case c:return w;default:switch(w=w&&w.$$typeof,w){case n:case m:case y:case g:case l:return w;default:return ae}}case t:return ae}}}function R(w){return N(w)===u}return G.AsyncMode=d,G.ConcurrentMode=u,G.ContextConsumer=n,G.ContextProvider=l,G.Element=a,G.ForwardRef=m,G.Fragment=o,G.Lazy=y,G.Memo=g,G.Portal=t,G.Profiler=s,G.StrictMode=i,G.Suspense=c,G.isAsyncMode=function(w){return R(w)||N(w)===d},G.isConcurrentMode=R,G.isContextConsumer=function(w){return N(w)===n},G.isContextProvider=function(w){return N(w)===l},G.isElement=function(w){return typeof w=="object"&&w!==null&&w.$$typeof===a},G.isForwardRef=function(w){return N(w)===m},G.isFragment=function(w){return N(w)===o},G.isLazy=function(w){return N(w)===y},G.isMemo=function(w){return N(w)===g},G.isPortal=function(w){return N(w)===t},G.isProfiler=function(w){return N(w)===s},G.isStrictMode=function(w){return N(w)===i},G.isSuspense=function(w){return N(w)===c},G.isValidElementType=function(w){return typeof w=="string"||typeof w=="function"||w===o||w===u||w===s||w===i||w===c||w===f||typeof w=="object"&&w!==null&&(w.$$typeof===y||w.$$typeof===g||w.$$typeof===l||w.$$typeof===n||w.$$typeof===m||w.$$typeof===b||w.$$typeof===x||w.$$typeof===j||w.$$typeof===h)},G.typeOf=N,G}var X={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _n;function _o(){return _n||(_n=1,process.env.NODE_ENV!=="production"&&function(){var e=typeof Symbol=="function"&&Symbol.for,a=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,n=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,m=e?Symbol.for("react.forward_ref"):60112,c=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,g=e?Symbol.for("react.memo"):60115,y=e?Symbol.for("react.lazy"):60116,h=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,x=e?Symbol.for("react.responder"):60118,j=e?Symbol.for("react.scope"):60119;function N(k){return typeof k=="string"||typeof k=="function"||k===o||k===u||k===s||k===i||k===c||k===f||typeof k=="object"&&k!==null&&(k.$$typeof===y||k.$$typeof===g||k.$$typeof===l||k.$$typeof===n||k.$$typeof===m||k.$$typeof===b||k.$$typeof===x||k.$$typeof===j||k.$$typeof===h)}function R(k){if(typeof k=="object"&&k!==null){var ve=k.$$typeof;switch(ve){case a:var ze=k.type;switch(ze){case d:case u:case o:case s:case i:case c:return ze;default:var Me=ze&&ze.$$typeof;switch(Me){case n:case m:case y:case g:case l:return Me;default:return ve}}case t:return ve}}}var w=d,ae=u,he=n,Fe=l,Ie=a,Le=m,Pe=o,ke=y,I=g,T=t,_=s,$=i,ee=c,se=!1;function De(k){return se||(se=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),S(k)||R(k)===d}function S(k){return R(k)===u}function O(k){return R(k)===n}function q(k){return R(k)===l}function V(k){return typeof k=="object"&&k!==null&&k.$$typeof===a}function B(k){return R(k)===m}function K(k){return R(k)===o}function D(k){return R(k)===y}function z(k){return R(k)===g}function U(k){return R(k)===t}function Y(k){return R(k)===s}function W(k){return R(k)===i}function ce(k){return R(k)===c}X.AsyncMode=w,X.ConcurrentMode=ae,X.ContextConsumer=he,X.ContextProvider=Fe,X.Element=Ie,X.ForwardRef=Le,X.Fragment=Pe,X.Lazy=ke,X.Memo=I,X.Portal=T,X.Profiler=_,X.StrictMode=$,X.Suspense=ee,X.isAsyncMode=De,X.isConcurrentMode=S,X.isContextConsumer=O,X.isContextProvider=q,X.isElement=V,X.isForwardRef=B,X.isFragment=K,X.isLazy=D,X.isMemo=z,X.isPortal=U,X.isProfiler=Y,X.isStrictMode=W,X.isSuspense=ce,X.isValidElementType=N,X.typeOf=R}()),X}var An;function Bn(){return An||(An=1,process.env.NODE_ENV==="production"?ut.exports=Mo():ut.exports=_o()),ut.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Tt,$n;function Ao(){if($n)return Tt;$n=1;var e=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function o(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}function i(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var l={},n=0;n<10;n++)l["_"+String.fromCharCode(n)]=n;var d=Object.getOwnPropertyNames(l).map(function(m){return l[m]});if(d.join("")!=="0123456789")return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function(m){u[m]=m}),Object.keys(Object.assign({},u)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return Tt=i()?Object.assign:function(s,l){for(var n,d=o(s),u,m=1;m<arguments.length;m++){n=Object(arguments[m]);for(var c in n)a.call(n,c)&&(d[c]=n[c]);if(e){u=e(n);for(var f=0;f<u.length;f++)t.call(n,u[f])&&(d[u[f]]=n[u[f]])}}return d},Tt}var Ft,Dn;function Lt(){if(Dn)return Ft;Dn=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ft=e,Ft}var Mt,zn;function Vn(){return zn||(zn=1,Mt=Function.call.bind(Object.prototype.hasOwnProperty)),Mt}var _t,qn;function Bo(){if(qn)return _t;qn=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var a=Lt(),t={},o=Vn();e=function(s){var l="Warning: "+s;typeof console<"u"&&console.error(l);try{throw new Error(l)}catch{}}}function i(s,l,n,d,u){if(process.env.NODE_ENV!=="production"){for(var m in s)if(o(s,m)){var c;try{if(typeof s[m]!="function"){var f=Error((d||"React class")+": "+n+" type `"+m+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof s[m]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw f.name="Invariant Violation",f}c=s[m](l,m,d,n,null,a)}catch(y){c=y}if(c&&!(c instanceof Error)&&e((d||"React class")+": type specification of "+n+" `"+m+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof c+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),c instanceof Error&&!(c.message in t)){t[c.message]=!0;var g=u?u():"";e("Failed "+n+" type: "+c.message+(g??""))}}}}return i.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(t={})},_t=i,_t}var At,Un;function $o(){if(Un)return At;Un=1;var e=Bn(),a=Ao(),t=Lt(),o=Vn(),i=Bo(),s=function(){};process.env.NODE_ENV!=="production"&&(s=function(n){var d="Warning: "+n;typeof console<"u"&&console.error(d);try{throw new Error(d)}catch{}});function l(){return null}return At=function(n,d){var u=typeof Symbol=="function"&&Symbol.iterator,m="@@iterator";function c(S){var O=S&&(u&&S[u]||S[m]);if(typeof O=="function")return O}var f="<<anonymous>>",g={array:x("array"),bigint:x("bigint"),bool:x("boolean"),func:x("function"),number:x("number"),object:x("object"),string:x("string"),symbol:x("symbol"),any:j(),arrayOf:N,element:R(),elementType:w(),instanceOf:ae,node:Le(),objectOf:Fe,oneOf:he,oneOfType:Ie,shape:ke,exact:I};function y(S,O){return S===O?S!==0||1/S===1/O:S!==S&&O!==O}function h(S,O){this.message=S,this.data=O&&typeof O=="object"?O:{},this.stack=""}h.prototype=Error.prototype;function b(S){if(process.env.NODE_ENV!=="production")var O={},q=0;function V(K,D,z,U,Y,W,ce){if(U=U||f,W=W||z,ce!==t){if(d){var k=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw k.name="Invariant Violation",k}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var ve=U+":"+z;!O[ve]&&q<3&&(s("You are manually calling a React.PropTypes validation function for the `"+W+"` prop on `"+U+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),O[ve]=!0,q++)}}return D[z]==null?K?D[z]===null?new h("The "+Y+" `"+W+"` is marked as required "+("in `"+U+"`, but its value is `null`.")):new h("The "+Y+" `"+W+"` is marked as required in "+("`"+U+"`, but its value is `undefined`.")):null:S(D,z,U,Y,W)}var B=V.bind(null,!1);return B.isRequired=V.bind(null,!0),B}function x(S){function O(q,V,B,K,D,z){var U=q[V],Y=$(U);if(Y!==S){var W=ee(U);return new h("Invalid "+K+" `"+D+"` of type "+("`"+W+"` supplied to `"+B+"`, expected ")+("`"+S+"`."),{expectedType:S})}return null}return b(O)}function j(){return b(l)}function N(S){function O(q,V,B,K,D){if(typeof S!="function")return new h("Property `"+D+"` of component `"+B+"` has invalid PropType notation inside arrayOf.");var z=q[V];if(!Array.isArray(z)){var U=$(z);return new h("Invalid "+K+" `"+D+"` of type "+("`"+U+"` supplied to `"+B+"`, expected an array."))}for(var Y=0;Y<z.length;Y++){var W=S(z,Y,B,K,D+"["+Y+"]",t);if(W instanceof Error)return W}return null}return b(O)}function R(){function S(O,q,V,B,K){var D=O[q];if(!n(D)){var z=$(D);return new h("Invalid "+B+" `"+K+"` of type "+("`"+z+"` supplied to `"+V+"`, expected a single ReactElement."))}return null}return b(S)}function w(){function S(O,q,V,B,K){var D=O[q];if(!e.isValidElementType(D)){var z=$(D);return new h("Invalid "+B+" `"+K+"` of type "+("`"+z+"` supplied to `"+V+"`, expected a single ReactElement type."))}return null}return b(S)}function ae(S){function O(q,V,B,K,D){if(!(q[V]instanceof S)){var z=S.name||f,U=De(q[V]);return new h("Invalid "+K+" `"+D+"` of type "+("`"+U+"` supplied to `"+B+"`, expected ")+("instance of `"+z+"`."))}return null}return b(O)}function he(S){if(!Array.isArray(S))return process.env.NODE_ENV!=="production"&&(arguments.length>1?s("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):s("Invalid argument supplied to oneOf, expected an array.")),l;function O(q,V,B,K,D){for(var z=q[V],U=0;U<S.length;U++)if(y(z,S[U]))return null;var Y=JSON.stringify(S,function(ce,k){var ve=ee(k);return ve==="symbol"?String(k):k});return new h("Invalid "+K+" `"+D+"` of value `"+String(z)+"` "+("supplied to `"+B+"`, expected one of "+Y+"."))}return b(O)}function Fe(S){function O(q,V,B,K,D){if(typeof S!="function")return new h("Property `"+D+"` of component `"+B+"` has invalid PropType notation inside objectOf.");var z=q[V],U=$(z);if(U!=="object")return new h("Invalid "+K+" `"+D+"` of type "+("`"+U+"` supplied to `"+B+"`, expected an object."));for(var Y in z)if(o(z,Y)){var W=S(z,Y,B,K,D+"."+Y,t);if(W instanceof Error)return W}return null}return b(O)}function Ie(S){if(!Array.isArray(S))return process.env.NODE_ENV!=="production"&&s("Invalid argument supplied to oneOfType, expected an instance of array."),l;for(var O=0;O<S.length;O++){var q=S[O];if(typeof q!="function")return s("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+se(q)+" at index "+O+"."),l}function V(B,K,D,z,U){for(var Y=[],W=0;W<S.length;W++){var ce=S[W],k=ce(B,K,D,z,U,t);if(k==null)return null;k.data&&o(k.data,"expectedType")&&Y.push(k.data.expectedType)}var ve=Y.length>0?", expected one of type ["+Y.join(", ")+"]":"";return new h("Invalid "+z+" `"+U+"` supplied to "+("`"+D+"`"+ve+"."))}return b(V)}function Le(){function S(O,q,V,B,K){return T(O[q])?null:new h("Invalid "+B+" `"+K+"` supplied to "+("`"+V+"`, expected a ReactNode."))}return b(S)}function Pe(S,O,q,V,B){return new h((S||"React class")+": "+O+" type `"+q+"."+V+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+B+"`.")}function ke(S){function O(q,V,B,K,D){var z=q[V],U=$(z);if(U!=="object")return new h("Invalid "+K+" `"+D+"` of type `"+U+"` "+("supplied to `"+B+"`, expected `object`."));for(var Y in S){var W=S[Y];if(typeof W!="function")return Pe(B,K,D,Y,ee(W));var ce=W(z,Y,B,K,D+"."+Y,t);if(ce)return ce}return null}return b(O)}function I(S){function O(q,V,B,K,D){var z=q[V],U=$(z);if(U!=="object")return new h("Invalid "+K+" `"+D+"` of type `"+U+"` "+("supplied to `"+B+"`, expected `object`."));var Y=a({},q[V],S);for(var W in Y){var ce=S[W];if(o(S,W)&&typeof ce!="function")return Pe(B,K,D,W,ee(ce));if(!ce)return new h("Invalid "+K+" `"+D+"` key `"+W+"` supplied to `"+B+"`.\nBad object: "+JSON.stringify(q[V],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(S),null,"  "));var k=ce(z,W,B,K,D+"."+W,t);if(k)return k}return null}return b(O)}function T(S){switch(typeof S){case"number":case"string":case"undefined":return!0;case"boolean":return!S;case"object":if(Array.isArray(S))return S.every(T);if(S===null||n(S))return!0;var O=c(S);if(O){var q=O.call(S),V;if(O!==S.entries){for(;!(V=q.next()).done;)if(!T(V.value))return!1}else for(;!(V=q.next()).done;){var B=V.value;if(B&&!T(B[1]))return!1}}else return!1;return!0;default:return!1}}function _(S,O){return S==="symbol"?!0:O?O["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&O instanceof Symbol:!1}function $(S){var O=typeof S;return Array.isArray(S)?"array":S instanceof RegExp?"object":_(O,S)?"symbol":O}function ee(S){if(typeof S>"u"||S===null)return""+S;var O=$(S);if(O==="object"){if(S instanceof Date)return"date";if(S instanceof RegExp)return"regexp"}return O}function se(S){var O=ee(S);switch(O){case"array":case"object":return"an "+O;case"boolean":case"date":case"regexp":return"a "+O;default:return O}}function De(S){return!S.constructor||!S.constructor.name?f:S.constructor.name}return g.checkPropTypes=i,g.resetWarningCache=i.resetWarningCache,g.PropTypes=g,g},At}var Bt,Wn;function Do(){if(Wn)return Bt;Wn=1;var e=Lt();function a(){}function t(){}return t.resetWarningCache=a,Bt=function(){function o(l,n,d,u,m,c){if(c!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}o.isRequired=o;function i(){return o}var s={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:i,element:o,elementType:o,instanceOf:i,node:o,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:a};return s.PropTypes=s,s},Bt}if(process.env.NODE_ENV!=="production"){var zo=Bn(),Vo=!0;Rt.exports=$o()(zo.isElement,Vo)}else Rt.exports=Do()();var qo=Rt.exports;const A=Wt(qo),Hn=(e,a)=>{if(e.from==="Expand")return{id:e.id,title:e.name,type:e.type,key:e.id,level:a,from:e.from,children:e.value.map(t=>Hn(t,a+1))};{const t={id:e.id,title:e.name,type:e.type,key:e.id,level:a,value:e.value,from:e.from,referenceKey:e.referenceKey,referenceNode:e.referenceNode,referenceId:e.referenceId,isLeaf:!0};return e.generic&&(t.generic=e.generic),e.type==="Object"&&(t.props=e.props),t}};Kn.propTypes={data:A.array.isRequired,updateItem:A.func.isRequired};const Uo=110,Wo=24;function Kn({data:e,updateItem:a}){const t=e.map(u=>Hn(u,0)),o=(u,m,c)=>{a(u,[{key:m,value:c.target.value}])},i=(u,m)=>{a(u,[{key:"referenceKey",value:m}])},s=(u,m)=>{a(u,[{key:"referenceNode",value:m.referenceNode},{key:"referenceId",value:m.referenceId},{key:"value",value:m.value}])},l=u=>u.from==="Input"?r.jsx(v.Input,{className:"jade-input",style:{borderRadius:"0px 8px 8px 0px"},placeholder:"请输入",value:u.value,onChange:m=>o(u.id,"value",m)}):u.from==="Reference"?r.jsx(Re,{className:"jade-input-tree-title-tree-select jade-select",rules:[{required:!0,message:"字段值不能为空"}],reference:u,onReferencedKeyChange:m=>s(u.id,m),onReferencedValueChange:m=>i(u.id,m)}):null,n=u=>{switch(u.type){case"Object":return u.hasOwnProperty("generic")?[{value:"Reference",label:"引用"}]:[{value:"Reference",label:"引用"},{value:"Expand",label:"展开"}];case"Array":return[{value:"Reference",label:"引用"}];default:return[{value:"Reference",label:"引用"}]}},d=u=>{const m=Uo-u.level*Wo;return r.jsx(r.Fragment,{children:r.jsx("div",{className:"jade-input-tree-title",children:r.jsxs(v.Row,{wrap:!1,children:[r.jsx(v.Col,{flex:"0 0 "+m+"px",children:r.jsx(v.Form.Item,{name:`property-${u.id}`,children:r.jsx("div",{className:"jade-input-tree-title-child",style:{display:"flex",alignItems:"center"},children:r.jsx("span",{children:u.title})})})}),r.jsx(v.Col,{flex:"0 0 70px",style:{paddingRight:0},children:r.jsx(v.Form.Item,{name:`value-select-${u.id}`,children:r.jsx("div",{className:"jade-input-tree-title-child",children:r.jsx(Ho,{node:u,options:n(u),updateItem:a})})})}),r.jsx(v.Col,{children:r.jsx("div",{className:"jade-input-tree-title-child",children:l(u)})})]})})})};return r.jsx(r.Fragment,{children:r.jsx(v.ConfigProvider,{theme:{components:{Tree:{nodeSelectedBg:"transparent",nodeHoverBg:"transparent"}}},children:r.jsx(v.Tree,{blockNode:!0,treeData:t,className:"jade-ant-tree",titleRender:d,showLine:!0})})})}const Ho=({node:e,options:a,updateItem:t})=>{const o=i=>{i==="Expand"?t(e.id,[{key:"from",value:i},{key:"referenceNode",value:null},{key:"referenceId",value:null},{key:"referenceKey",value:null},{key:"value",value:e.props}]):i==="Input"?t(e.id,[{key:"from",value:i},{key:"referenceNode",value:null},{key:"referenceId",value:null},{key:"referenceKey",value:null},{key:"value",value:null}]):t(e.id,[{key:"from",value:i}])};return r.jsx(r.Fragment,{children:r.jsx(de,{style:{background:"#f7f7f7",width:"100%"},placeholder:"请选择",defaultValue:e.from,className:"jade-input-tree-title-select jade-select",onChange:o,options:a})})},{Panel:Ko}=v.Collapse;function Jn({data:e,updateItem:a}){return r.jsx(r.Fragment,{children:r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["jadeInputTreePanel"],children:r.jsx(Ko,{header:r.jsx("div",{children:r.jsx("span",{className:"jade-panel-header-font",children:"输入"})}),className:"jade-panel",children:r.jsx(Kn,{data:e,updateItem:a})},"jadeInputTreePanel")})})}const Jo=e=>{const a={};a.getJadeConfig=()=>e||{input:[{id:"uuid1",name:"person",type:"Object",from:"Expand",value:[{id:"uuid2",name:"name",type:"Object",from:"Expand",value:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}],props:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}]}],props:[{id:"uuid2",name:"name",type:"Object",from:"Expand",value:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}],props:[{id:"uuid3",name:"surname",type:"String",value:null,from:"Input"}]}]},{id:"uuid4",name:"school",type:"Object",from:"Reference",value:[],props:[{id:"uuid5",name:"schoolName",type:"String",value:"绵阳中学",from:"Input"}]}]},a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(Yo,{})});const t=(o,i,s)=>o.map(l=>{const n={...l};return l.id===i?(s.forEach(d=>{n[d.key]=d.value}),n):(n.type==="Object"&&Array.isArray(n.value)&&(n.value=t(n.value,i,s)),n)});return a.reducers=(o,i)=>{switch(i.type){case"update":return{input:t(o.input,i.id,i.changes)};default:throw Error("Unknown action: "+i.type)}},a},Yo=()=>{const e=te(),a=re(),t=(o,i)=>{a({type:"update",id:o,changes:i})};return r.jsx(r.Fragment,{children:r.jsx("div",{children:r.jsx(Jn,{data:e.input,updateItem:t})})})},Zo=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="testNode",n.text="测试组件",n.componentName="testComponent",n.getHeaderIcon=()=>r.jsx(Ae,{}),n},Go=e=>{const a={};return a.getJadeConfig=()=>e||[{name:"description",type:"String",value:"这是一个测试"}],a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(Xo,{})}),a.reducers=(t,o)=>{if(o.type==="update")return[{...t[0],value:o.value}]},a},Xo=e=>{const a=L.useRef(null),t=te(),o=re(),i=()=>{o({type:"update",value:a.current.input.value})};return r.jsxs(r.Fragment,{children:[r.jsx("div",{children:r.jsx(v.Input,{ref:a,value:t[0].value,placeholder:"Basic usage",onChange:()=>i()})}),r.jsx(Qo,{...e})]})},Qo=e=>r.jsxs(r.Fragment,{children:[r.jsx("span",{children:e.a}),r.jsx("span",{children:e.b}),r.jsx("span",{children:e.c})]}),ei=e=>{const a={};return a.getJadeConfig=()=>e||[{name:"description",type:"String",value:"替换之前的输入框"}],a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(ti,{})}),a.reducers=(t,o)=>{if(o.type==="update")return[{...t[0],value:o.value}]},a},ti=()=>{const e=L.useRef(null),a=te(),t=re(),o=()=>{t({type:"update",value:e.current.input.value})};return r.jsx(r.Fragment,{children:r.jsx("div",{children:r.jsx(v.Input,{ref:e,value:a[0].value,placeholder:"Basic usage",onChange:()=>o()})})})},ni=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null,E.createElement("clipPath",{id:"clip4_13280"},E.createElement("rect",{id:"\\u56FE\\u6807/16/\\u5F00\\u59CB\\uFF0C\\u8D77\\u70B9\\uFF0C\\u7AEF\\u70B9",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#5E7CE0",fillOpacity:1}),E.createElement("g",{clipPath:"url(#clip4_13280)"},E.createElement("path",{id:"path",d:"M16.58 11.52L18.16 11.52L18.16 6.31L11.46 6.31C8.35 6.37 5.83 8.89 5.83 11.99C5.83 15.1 8.35 17.62 11.46 17.67L18.16 17.67L18.16 12.46L13.07 12.46L13.07 13.52L10.08 13.52L10.08 10.47L13.07 10.47L13.07 11.53L16.58 11.53L16.58 11.52Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),ri=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);n.type="startNodeStart",n.text="开始",n.pointerEvents="auto",n.componentName="startComponent",n.deletable=!1,n.toolMenus=[{key:"1",label:"重命名",action:u=>{u(!0)}}],n.isUnique=!0,delete n.flowMeta.jober;const d=n.initConnectors;return n.initConnectors=()=>{d.apply(n),n.connectors.remove(u=>u.direction.key===ne.DIRECTION.W.key)},n.getComponent=()=>n.graph.plugins[n.componentName](n.flowMeta.inputParams),n.serializerJadeConfig=()=>{n.flowMeta.inputParams=n.getLatestJadeConfig()},n.getHeaderIcon=()=>r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(ni,{})}),n};Yn.propTypes={itemId:A.string.isRequired,propValue:A.string.isRequired,type:A.string.isRequired,disableModifiable:A.bool.isRequired,onChange:A.func.isRequired};function Yn({itemId:e,propValue:a,type:t,disableModifiable:o,onChange:i}){return r.jsx(v.Form.Item,{className:"jade-form-item",label:"字段名称",name:`name-${e}`,rules:[{required:!0,message:"参数名称不能为空"},{pattern:/^[a-zA-Z_][a-zA-Z0-9_]*$/,message:"只能包含字母、数字或下划线，且必须以字母或下划线开头"}],validateTrigger:"onBlur",initialValue:a,children:r.jsx(Ot,{className:"jade-input",id:e,value:a,type:t,disabled:o,placeholder:"请输入字段名称",showCount:!0,maxLength:20,onChange:s=>i&&i("name",s.target.value)})})}Zn.propTypes={itemId:A.string.isRequired,propValue:A.string.isRequired,disableModifiable:A.bool.isRequired,onChange:A.func.isRequired};function Zn({itemId:e,propValue:a,disableModifiable:t,onChange:o}){const i=l=>{l.stopPropagation()},s=l=>{o("type",l),document.activeElement.blur()};return r.jsx(v.Form.Item,{className:"jade-form-item",label:"字段类型",name:`type-${e}`,initialValue:a,children:r.jsx(de,{className:"jade-select",value:a,disabled:t,style:{width:"100%"},onClick:i,onChange:s,options:[{value:"String",label:"String"},{value:"Integer",label:"Integer"},{value:"Boolean",label:"Boolean"},{value:"Number",label:"Number"}]})})}const{TextArea:ai}=v.Input;Gn.propTypes={propValue:A.string.isRequired,disableModifiable:A.bool.isRequired,onChange:A.func.isRequired};function Gn({itemId:e,propValue:a,disableModifiable:t,onChange:o}){return r.jsx(v.Form.Item,{className:"jade-form-item",label:"字段描述",name:`description-${e}`,rules:[{required:!0,message:"参数描述不能为空"}],initialValue:a,children:r.jsx(ai,{className:"jade-input",value:a,disabled:t,onChange:i=>o("description",i.target.value),placeholder:"请输入字段描述",autoSize:{minRows:4,maxRows:4}})})}Xn.propTypes={item:A.shape({id:A.string.isRequired,name:A.string.isRequired,type:A.string.isRequired,description:A.string.isRequired,from:A.string.isRequired,value:A.string.isRequired}).isRequired};function Xn({item:e}){const a=re(),t=e.id,o=(i,s)=>{a({actionType:"changeInputParam",id:t,type:i,value:s})};return r.jsxs(r.Fragment,{children:[r.jsx(Yn,{itemId:e.id,propValue:e.name,type:e.type,disableModifiable:e.disableModifiable,onChange:o}),r.jsx(Zn,{itemId:e.id,propValue:e.type,disableModifiable:e.disableModifiable,onChange:o}),r.jsx(Gn,{itemId:e.id,propValue:e.description,disableModifiable:e.disableModifiable,onChange:o})]})}Qn.propTypes={propValue:A.string.isRequired,onValueChange:A.func.isRequired};function Qn({propValue:e,onValueChange:a}){const t=parseInt(e),o={1:"1",3:"默认",10:"10"};return r.jsx("div",{style:{display:"flex",alignItems:"center"},children:r.jsx(v.Slider,{style:{width:"95%"},min:1,max:10,defaultValue:3,marks:o,step:1,onChange:i=>a("Integer",i.toString()),value:isNaN(t)?3:t})})}er.propTypes={propValue:A.string.isRequired,onValueChange:A.func.isRequired};function er({propValue:e,onValueChange:a}){const t=parseFloat(e);return r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx(v.Slider,{style:{width:"90%"},min:1,max:100,defaultValue:20,step:1,onChange:o=>a("Integer",o.toString()),value:isNaN(t)?20:t}),r.jsx("span",{style:{marginLeft:"8px"},children:t})]})}tr.propTypes={propValue:A.string.isRequired,onValueChange:A.func.isRequired};function tr({propValue:e,onValueChange:a}){const t=parseInt(e),o=i=>{const s=Math.floor(i);a("Integer",s.toString())};return r.jsx("div",{style:{display:"flex",alignItems:"center"},children:r.jsx(v.InputNumber,{style:{width:"100%"},min:1,max:1e4,step:100,onChange:o,stringMode:!0,value:isNaN(t)?1e3:t})})}nr.propTypes={propValue:A.string.isRequired,onValueChange:A.func.isRequired};function nr({propValue:e,onValueChange:a}){const t=e,o=l=>{l.stopPropagation()},i=(l,n)=>((n==null?void 0:n.label)??"").toLowerCase().includes(l.toLowerCase()),s=l=>{a("String",l),document.activeElement.blur()};return r.jsx(r.Fragment,{children:r.jsx(de,{showSearch:!0,className:"jade-select",style:{width:"100%"},onClick:o,onChange:s,filterOption:i,options:[{value:"oneHour",label:"近1小时"},{value:"sixHour",label:"近6小时"},{value:"twelveHour",label:"近12小时"},{value:"oneDay",label:"近1天"},{value:"twoDays",label:"近2天"},{value:"oneWeek",label:"近1周"}],value:t})})}rr.propTypes={propValue:A.oneOfType([A.string,A.oneOf([null])]),onValueChange:A.func.isRequired,config:A.object.isRequired};function rr({propValue:e,onValueChange:a,config:t}){const o=e,[i,s]=L.useState([]),l=u=>{u.stopPropagation()},n=(u,m)=>((m==null?void 0:m.label)??"").toLowerCase().includes(u.toLowerCase()),d=u=>{a("String",u),document.activeElement.blur()};return L.useEffect(()=>{Te.get(t.urls.customHistoryUrl,{},u=>s(u.data.map(m=>({value:m.fitableId,label:m.name}))))},[]),r.jsx(r.Fragment,{children:r.jsx(de,{allowClear:!0,showSearch:!0,className:"jade-select",style:{width:"100%"},onClick:l,onChange:d,filterOption:n,placeholder:"选择合适的获取历史记录服务",options:i,value:o})})}ar.propTypes={config:A.object.isRequired};function ar({config:e}){const a=re(),t=te(),o=t.find(u=>u.name==="memory").value.find(u=>u.name==="type").value,i=t.find(u=>u.name==="memory").value.find(u=>u.name==="value").value,s=u=>{u.stopPropagation()},l=(u,m)=>{a({actionType:"changeMemory",memoryType:o,memoryValueType:u,memoryValue:m})},n=()=>{switch(o){case"ByConversationTurn":return r.jsx(Qn,{propValue:i,onValueChange:l});case"ByNumber":return r.jsx(er,{propValue:i,onValueChange:l});case"ByTokenSize":return r.jsx(tr,{propValue:i,onValueChange:l});case"ByTime":return r.jsx(nr,{propValue:i,onValueChange:l});case"Customizing":return r.jsx(rr,{propValue:i,onValueChange:l,config:e});case"UserSelect":return null;case"NotUseMemory":return null;default:return null}},d=u=>{let m="",c=null;switch(u){case"ByConversationTurn":m="Integer",c="3";break;case"ByNumber":m="Integer",c="20";break;case"ByTokenSize":m="Integer",c="1000";break;case"ByTime":m="String",c="oneHour";break;case"Customizing":m="String";break}a({actionType:"changeMemory",memoryType:u,memoryValueType:m,memoryValue:c}),document.activeElement.blur()};return r.jsxs(r.Fragment,{children:[r.jsx(de,{className:"jade-select",defaultValue:o,style:{width:"100%",marginBottom:"8px",marginTop:"8px"},onClick:s,onChange:u=>d(u),options:[{value:"ByConversationTurn",label:"按对话轮次"},{value:"UserSelect",label:"用户自勾选"},{value:"NotUseMemory",label:"不使用历史记录"}]}),n()," "]})}const{Panel:or}=v.Collapse;function oi(){const e=re(),a=te(),t=ue().graph.configs.find(f=>f.node==="startNodeStart"),i=a.find(f=>f.name==="input").value,[s,l]=L.useState(()=>i.map(f=>f.id)),n=()=>{const f="input_"+F();l([...s,f]),e({actionType:"addInputParam",id:f})},d=()=>{var g,y;const f=(y=(g=a.find(h=>h.name==="input"))==null?void 0:g.config)==null?void 0:y.find(h=>h.hasOwnProperty("allowAdd"));if(f&&f.allowAdd)return r.jsx(v.Button,{type:"text",className:"icon-button",onClick:n,style:{height:"32px",marginLeft:"auto",marginRight:"12px"},children:r.jsx(Be,{})})},u=f=>{if(!f.disableModifiable)return r.jsx(v.Button,{type:"text",className:"icon-button",style:{height:"22px",marginLeft:"auto"},onClick:()=>m(f.id),children:r.jsx(Ga,{})})},m=f=>{const g=s.filter(y=>y!==f);l(g),e({actionType:"deleteInputParam",id:f})},c=r.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[r.jsx("p",{children:"定义启动工作流所需的输入参数，这些内容将由"}),r.jsx("p",{children:"大模型在机器人对话过程中读取，允许大模型"}),r.jsx("p",{children:"在适当的时间启动工作流并填写正确的信息。"})]});return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px",paddingLeft:"8px",paddingRight:"4px",height:"32px"},children:[r.jsx("div",{className:"jade-panel-header-font",children:"输入"}),r.jsx(v.Popover,{content:c,children:r.jsx(Ce,{className:"jade-top-header-popover-content"})}),d()]}),r.jsx(v.Collapse,{bordered:!1,activeKey:s,onChange:f=>l(f),className:"jade-collapse-custom-background-color",children:i.map(f=>r.jsx(or,{header:r.jsxs("div",{className:"panel-header",children:[r.jsx("span",{className:"jade-panel-header-font",children:f.name})," ",u(f)]}),className:"jade-panel",style:{marginBottom:8,borderRadius:"8px",width:"100%"},children:r.jsx(Xn,{item:f})},f.id))}),r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["historicalRecordsPanel"],children:r.jsx(or,{header:r.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:r.jsx("span",{className:"jade-panel-header-font",children:"历史记录"})}),className:"jade-panel",style:{width:"100%"},children:r.jsx(ar,{config:t})},"historicalRecordsPanel")})]})}const ii=e=>{const a={};return a.getJadeConfig=()=>e||[{id:F(),name:"input",type:"Object",from:"Expand",value:[{id:"input_"+F(),name:"Question",type:"String",from:"Input",description:"这是用户输入的问题",value:"",disableModifiable:!0}]},{id:F(),name:"memory",type:"Object",from:"Expand",value:[{id:F(),name:"type",type:"String",from:"Input",value:"ByConversationTurn"},{id:F(),name:"value",type:"Integer",from:"Input",value:"3"}]}],a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(si,{})}),a.reducers=(t,o)=>{function i(){return t.map(d=>d.name==="input"?{...d,value:[...d.value,{id:o.id,name:"",type:"String",from:"Input",description:"",value:"",disableModifiable:!1}]}:d)}function s(){return t.map(d=>d.name==="input"?{...d,value:d.value.map(u=>u.id===o.id?{...u,[o.type]:o.value}:u)}:d)}function l(){return t.map(d=>d.name==="memory"?{...d,value:d.value.map(u=>u.name==="type"?{...u,value:o.memoryType}:u.name==="value"?{...u,type:o.memoryValueType,value:o.memoryValue}:u)}:d)}function n(){return t.map(d=>d.name==="input"?{...d,value:d.value.filter(u=>u.id!==o.id)}:d)}switch(o.actionType){case"addInputParam":return i();case"changeInputParam":return s();case"changeMemory":return l();case"deleteInputParam":return n();default:throw Error("Unknown action: "+o.type)}},a},si=()=>r.jsx(r.Fragment,{children:r.jsx(oi,{})}),li=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null,E.createElement("clipPath",{id:"clip4_13238"},E.createElement("rect",{id:"\\u56FE\\u6807/16/\\u5927\\u6A21\\u578B",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#047BFC",fillOpacity:1}),E.createElement("g",{clipPath:"url(#clip4_13238)"},E.createElement("path",{id:"path",d:"M12 4.66L18.33 8.33L18.33 15.66L11.99 19.33L5.66 15.66L5.66 8.33L12 4.66ZM8.33 10.64L11.33 12.38L11.33 15.75L12.66 15.75L12.66 12.38L15.66 10.64L15 9.49L12 11.23L9 9.49L8.33 10.64Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}))),ci=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="llmNodeState",n.text="大模型",n.pointerEvents="auto",n.componentName="llmComponent",n.flowMeta.jober.fitables.push("com.huawei.fit.jober.aipp.fitable.LLMComponent"),n.flowMeta.jober.isAsync="true",n.getHeaderIcon=()=>r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(li,{})}),n},{TextArea:ui}=v.Input,{Panel:di}=v.Collapse;ir.propTypes={modelOptions:A.array.isRequired};function ir({shapeId:e,modelOptions:a}){const t=te(),o=re();_e();const i=t.inputParams.find(g=>g.name==="model"),s=t.inputParams.find(g=>g.name==="temperature"),l=t.inputParams.filter(g=>g.name==="prompt").flatMap(g=>g.value).find(g=>g.name==="template"),n=g=>{g.stopPropagation()},d=r.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[r.jsx("p",{children:"用于控制生成文本的大型模型的随机性。"}),r.jsx("p",{children:"当设置较高时，模型将生成更多样化的文本，增加不确定性；"}),r.jsx("p",{children:"当设置较低时，模型将生成高概率词，减少不确定性。"})]}),u=r.jsxs("div",{className:"jade-font-size",style:{lineHeight:"1.2"},children:[r.jsx("p",{children:"编辑大模型的提示词，实现相应的功能。"}),r.jsxs("p",{children:["可以使用","{{变量名}}","从输入参数中引入变量。"]})]}),m=(g,{input:y,userTyping:h})=>h?y:g===0?"0":g===1?"1":g,c=g=>{g.target.value!==""&&o({actionType:"changeConfig",id:s.id,value:g.target.value})},f=g=>{g.target.value!==""&&o({actionType:"changePrompt",id:l.id,value:g.target.value})};return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["modelPanel"],children:r.jsxs(di,{header:r.jsx("div",{className:"panel-header",children:r.jsx("span",{className:"jade-panel-header-font",children:"大模型"})}),className:"jade-panel",children:[r.jsxs(v.Row,{gutter:16,children:[r.jsx(v.Col,{span:12,children:r.jsx(v.Form.Item,{className:"jade-form-item",name:`model-${e}`,label:"模型",rules:[{required:!0,message:"请选择使用的模型"}],initialValue:i.value,children:r.jsx(de,{className:"jade-select",onClick:n,onChange:g=>o({actionType:"changeConfig",id:i.id,value:g}),options:a,validateTrigger:"onBlur"})})}),r.jsx(v.Col,{span:12,children:r.jsx(v.Form.Item,{className:"jade-form-item",name:`temperature-${e}`,label:r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("span",{className:"jade-second-title",children:"温度"}),r.jsx(v.Popover,{content:d,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})})]}),rules:[{required:!0,message:"请输入0-1之间的参数!"}],initialValue:s.value,validateTrigger:"onBlur",children:r.jsx(v.InputNumber,{formatter:m,className:"jade-input",style:{width:"100%"},min:0,max:1,step:.1,onBlur:c,stringMode:!0})})})]}),r.jsx(v.Row,{gutter:16,children:r.jsx(v.Col,{span:24,children:r.jsx(v.Form.Item,{className:"jade-form-item",name:`propmt-${e}`,label:r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("span",{className:"jade-second-title",children:"提示词模板"}),r.jsx(v.Popover,{content:[u],children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})})]}),rules:[{required:!0,message:"参数不能为空"}],initialValue:l.value,validateTrigger:"onBlur",children:r.jsx(ui,{className:"jade-input jade-font-size",onBlur:g=>f(g),placeholder:"你可以用{{variable name}}来关联输入中的变量名",autoSize:{minRows:4,maxRows:4}})})})})]},"modelPanel")})}const{Panel:fi}=v.Collapse;sr.propTypes={items:A.array.isRequired,addItem:A.func.isRequired,updateItem:A.func.isRequired,deleteItem:A.func.isRequired};function sr({items:e,addItem:a,updateItem:t,deleteItem:o}){const i=_e(),s=()=>{a(F())},l=(g,y,h)=>{const b=[{key:g,value:y}];g==="from"&&(b.push({key:"value",value:""}),b.push({key:"referenceNode",value:""}),b.push({key:"referenceId",value:""}),b.push({key:"referenceKey",value:""}),document.activeElement.blur(),i.setFieldsValue({[`value-${h}`]:void 0}),i.setFieldsValue({[`reference-${h}`]:void 0})),t(h,b)},n=(g,y)=>{t(g.id,[{key:"referenceKey",value:y}])},d=(g,y)=>{t(g.id,[{key:"referenceNode",value:y.referenceNode},{key:"referenceId",value:y.referenceId},{key:"value",value:y.value}])},u=g=>{o(g)},m=r.jsx("div",{children:r.jsx("p",{children:"输入需要添加到提示词模板中的信息，可被提示词模板引用"})}),c=g=>{g.stopPropagation()},f=g=>{switch(g.from){case"Reference":return r.jsx(r.Fragment,{children:r.jsx(Re,{rules:[{required:!0,message:"字段值不能为空"}],className:"value-custom jade-select",reference:g,onReferencedValueChange:y=>n(g,y),onReferencedKeyChange:y=>d(g,y)})});case"Input":return r.jsx(v.Form.Item,{id:`value-${g.id}`,name:`value-${g.id}`,rules:[{required:!0,message:"字段值不能为空"},{pattern:/^[^\s]*$/,message:"禁止输入空格"}],initialValue:g.value,validateTrigger:"onBlur",children:r.jsx(v.Input,{className:"value-custom jade-input",value:g.value,onChange:y=>l("value",y.target.value,g.id)})});default:return r.jsx(r.Fragment,{})}};return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["inputPanel"],children:r.jsxs(fi,{header:r.jsxs("div",{className:"panel-header",children:[r.jsx("span",{className:"jade-panel-header-font",children:"输入"}),r.jsx(v.Popover,{content:m,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})}),r.jsx(v.Button,{type:"text",className:"icon-button jade-panel-header-icon-position",onClick:g=>{s(),c(g)},children:r.jsx(Be,{})})]}),className:"jade-panel",children:[r.jsxs(v.Row,{gutter:16,children:[r.jsx(v.Col,{span:8,children:r.jsx(v.Form.Item,{children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"字段名称"})})}),r.jsx(v.Col,{span:16,children:r.jsx(v.Form.Item,{children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"字段值"})})})]}),e.map(g=>r.jsxs(v.Row,{gutter:16,children:[r.jsx(v.Col,{span:8,children:r.jsx(v.Form.Item,{id:`name-${g.id}`,name:`name-${g.id}`,rules:[{required:!0,message:"字段值不能为空"},{pattern:/^[a-zA-Z_][a-zA-Z0-9_]*$/,message:"只能包含字母、数字或下划线，且必须以字母或下划线开头"}],initialValue:g.name,children:r.jsx(v.Input,{className:"jade-input",placeholder:"请输入字段名称",style:{paddingRight:"12px"},value:g.name,onChange:y=>l("name",y.target.value,g.id)})})}),r.jsx(v.Col,{span:6,style:{paddingRight:0},children:r.jsx(v.Form.Item,{id:`from-${g.id}`,initialValue:"Reference",children:r.jsx(de,{id:`from-select-${g.id}`,className:"value-source-custom jade-select",style:{width:"100%"},onChange:y=>l("from",y,g.id),options:[{value:"Reference",label:"引用"},{value:"Input",label:"输入"}],value:g.from})})}),r.jsxs(v.Col,{span:8,style:{paddingLeft:0},children:[f(g)," "]}),r.jsx(v.Col,{span:2,style:{paddingLeft:0},children:r.jsx(v.Form.Item,{children:r.jsx(v.Button,{type:"text",className:"icon-button",style:{height:"100%"},onClick:()=>u(g.id),children:r.jsx(lt,{})})})})]},g.id))]},"inputPanel")})}const{Panel:pi}=v.Collapse;function mi(){const e=ue(),a=te(),o=a.outputParams,i=r.jsx("div",{className:"jade-font-size",children:r.jsx("p",{children:"大模型运行完成后生成的内容。"})});return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["outputPanel"],children:r.jsx(pi,{header:r.jsxs("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[r.jsx("span",{className:"jade-panel-header-font",children:"输出"}),r.jsx(v.Popover,{content:i,children:r.jsx(Ce,{className:"jade-panel-header-popover-content"})})]}),className:"jade-panel",children:r.jsx(v.Form,{name:`outputForm-${e.id}`,layout:"vertical",className:"jade-form",children:r.jsx(Ge,{data:o})})},"outputPanel")})}const{Panel:hi}=v.Collapse;lr.propTypes={toolOptions:A.array.isRequired,workflowOptions:A.array.isRequired,config:A.object.isRequired};function lr({toolOptions:e,workflowOptions:a,config:t}){const o=ue(),i=te(),s=re(),l=i.inputParams.find(c=>c.name==="tools"),n=i.inputParams.find(c=>c.name==="workflows"),d=c=>{!t||!t.params||!t.params.tenantId||!t.params.appId?console.error("Cannot get config.params.tenantId or config.params.appId."):(window.open("/appbuilder/#/aipp/"+t.params.tenantId+"/addFlow/"+t.params.appId,"_blank"),c.stopPropagation())},u=(c,f)=>((f==null?void 0:f.label)??"").toLowerCase().includes(c.toLowerCase()),m=(c,f)=>{s({actionType:"changeSkillConfig",id:c,value:f})};return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["skillPanel"],children:r.jsx(hi,{header:r.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:r.jsx("span",{className:"jade-panel-header-font",children:"技能"})}),className:"jade-panel",children:r.jsxs(v.Form,{name:`skillForm-${o.id}`,layout:"vertical",className:"jade-form",children:[r.jsx(v.Row,{gutter:16,style:{marginBottom:"6px",marginRight:0,marginLeft:"-3%"},children:r.jsx(v.Col,{span:21,children:r.jsx("span",{className:"jade-font-size jade-font-color",style:{marginLeft:"6px"},children:"工具"})})}),r.jsx(v.Form.Item,{children:r.jsx(de,{mode:"multiple",showSearch:!0,allowClear:!0,className:"jade-select",placeholder:"选择合适的工具",filterOption:u,optionFilterProp:"label",value:l.value,onMouseDown:c=>c.stopPropagation(),onChange:c=>m(l.id,c),options:e})}),r.jsxs(v.Row,{gutter:16,style:{marginBottom:"6px",marginRight:0,marginLeft:"-3%"},children:[r.jsx(v.Col,{span:22,children:r.jsx("span",{className:"jade-font-size jade-font-color",style:{marginLeft:"6px"},children:"工具流"})}),r.jsx(v.Col,{span:2,style:{paddingLeft:"3%"},children:r.jsx(v.Button,{type:"text",className:"icon-button",style:{height:"22px"},onClick:c=>{d(c)},children:r.jsx(Be,{})})})]}),r.jsx(v.Form.Item,{children:r.jsx(de,{mode:"multiple",showSearch:!0,allowClear:!0,className:"jade-select",placeholder:"选择合适的工具流",filterOption:u,optionFilterProp:"label",value:n.value,onChange:c=>m(n.id,c),options:a})})]})},"skillPanel")})}function gi(){const e=re(),a=te(),t=ue();let o;!t||!t.graph||!t.graph.configs?console.error("Cannot get shape.graph.configs."):o=t.graph.configs.find(y=>y.node==="llmNodeState");const[i,s]=L.useState([]),[l,n]=L.useState([]),[d,u]=L.useState([]),m=()=>a.inputParams.filter(y=>y.name==="prompt").flatMap(y=>y.value).filter(y=>y.name==="variables").flatMap(y=>y.value),c=y=>{e({actionType:"addInputParam",id:y})},f=(y,h)=>{e({actionType:"changeInputParams",id:y,updateParams:h})},g=y=>{e({actionType:"deleteInputParam",id:y})};return L.useEffect(()=>{!o||!o.urls?console.error("Cannot get config.urls."):(o.urls.llmModelEndpoint?Te.get(o.urls.llmModelEndpoint+"/model-gateway/v1/models",{},y=>s(y.data.map(h=>({value:h.id,label:h.id})))):console.error("Cannot get config.urls.llmModelEndpoint."),o.urls.toolListEndpoint?Te.get(o.urls.toolListEndpoint+"/api/jober/store/platform/jade/categories/TOOL?pageNum=0&pageSize=10&includeTags=FIT",{},y=>n(y.data.map(h=>({value:h.uniqueName,label:h.name})))):console.error("Cannot get config.urls.toolListEndpoint."),o.urls.workflowListEndpoint?Te.get(o.urls.workflowListEndpoint+"/api/jober/store/platform/jade/categories/TOOL?pageNum=0&pageSize=10&includeTags=WATERFLOW",{},y=>u(y.data.map(h=>({value:h.uniqueName,label:h.name})))):console.error("Cannot get config.urls.workflowListEndpoint."))},[]),r.jsxs("div",{children:[r.jsx(sr,{items:m(),addItem:c,updateItem:f,deleteItem:g}),r.jsx(ir,{shapeId:t.id,modelOptions:i}),r.jsx(lr,{toolOptions:l,workflowOptions:d,config:o}),r.jsx(mi,{})]})}const vi=e=>{const a={};return a.getJadeConfig=()=>e||{inputParams:[{id:F(),name:"model",type:"String",from:"Input",value:""},{id:F(),name:"temperature",type:"Number",from:"Input",value:"0.3"},{id:F(),name:"prompt",type:"Object",from:"Expand",value:[{id:F(),name:"template",type:"String",from:"Input",value:""},{id:F(),name:"variables",type:"Object",from:"Expand",value:[{id:F(),name:void 0,type:"String",from:"Reference",value:"",referenceNode:"",referenceId:"",referenceKey:""}]}]},{id:F(),name:"tools",type:"Array",from:"Input",value:[]},{id:F(),name:"workflows",type:"Array",from:"Input",value:[]},{id:F(),name:"systemPrompt",type:"String",from:"Input",value:""}],outputParams:[{id:F(),name:"output",type:"Object",from:"Expand",value:[{id:F(),name:"llmOutput",type:"string",from:"Input",description:"",value:""}]}]},a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(yi,{})}),a.reducers=(t,o)=>{function i(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="inputParams"?f[g]=y.map(h=>h.name==="prompt"?{...h,value:h.value.map(b=>b.name==="variables"?{...b,value:[...b.value,{id:o.id,name:void 0,type:"String",from:"Reference",value:""}]}:b)}:h):f[g]=y}),f}function s(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="outputParams"?f[g]=y.map(h=>h.name==="output"?{...h,value:[...h.value,{id:o.id,name:"",type:"string",from:"Input",description:"",value:""}]}:h):f[g]=y}),f}function l(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="inputParams"?f[g]=y.map(h=>h.name==="prompt"?{...h,value:h.value.map(b=>b.name==="variables"?{...b,value:b.value.map(x=>{if(x.id===o.id){let j={...x};return o.updateParams.map(N=>{j[N.key]=N.value}),j}else return x})}:b)}:h):f[g]=y}),f}function n(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="inputParams"?f[g]=y.map(h=>h.name==="prompt"?{...h,value:h.value.map(b=>o.id===b.id&&b.name==="template"?{...b,value:o.value}:b)}:h):f[g]=y}),f}function d(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="outputParams"?f[g]=y.map(h=>h.name==="output"?{...h,value:h.value.map(b=>b.id===o.id?{...b,[o.type]:o.value}:b)}:h):f[g]=y}),f}function u(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="inputParams"?f[g]=y.map(h=>h.id===o.id?{...h,value:o.value}:h):f[g]=y}),f}function m(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="inputParams"?f[g]=y.map(h=>h.id===o.id?{...h,value:o.value.map(b=>({id:F(),type:"String",from:"Input",value:b}))}:h):f[g]=y}),f}function c(){const f={};return Object.entries(t).forEach(([g,y])=>{g==="inputParams"?f[g]=y.map(h=>h.name==="prompt"?{...h,value:h.value.map(b=>b.name==="variables"?{...b,value:b.value.filter(x=>x.id!==o.id)}:b)}:h):f[g]=y}),f}switch(o.actionType){case"addInputParam":return i();case"addOutputParam":return s();case"changeInputParams":return l();case"changeOutputParam":return d();case"changeConfig":return u();case"changeSkillConfig":return m();case"changePrompt":return n();case"deleteInputParam":return c();case"deleteOutputParam":return t.filter(f=>f.id!==o.id);default:throw Error("Unknown action: "+o.type)}},a},yi=()=>r.jsx(r.Fragment,{children:r.jsx(gi,{})}),bi=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null,E.createElement("clipPath",{id:"clip4_13297"},E.createElement("rect",{id:"\\u56FE\\u6807/16/\\u68C0\\u67E5\\u5217\\u8868",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#A97AF8",fillOpacity:1}),E.createElement("g",{clipPath:"url(#clip4_13297)"},E.createElement("path",{id:"path",d:"M15 7.68L14.98 7.68C14.78 7.48 14.78 7.17 14.98 6.97C15.17 6.78 15.48 6.78 15.68 6.97L15.68 7L15 7.68ZM18.32 9.64L18.35 9.64C18.55 9.84 18.55 10.15 18.35 10.35C18.15 10.55 17.84 10.55 17.64 10.35L17.64 10.32L18.32 9.64Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M15.33 7.33L18 10",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),E.createElement("path",{id:"path",d:"M15.68 10.32L15.68 10.35C15.48 10.55 15.17 10.55 14.98 10.35C14.78 10.15 14.78 9.84 14.98 9.64L15 9.64L15.68 10.32ZM17.64 7L17.64 6.97C17.84 6.78 18.15 6.78 18.35 6.97C18.55 7.17 18.55 7.48 18.35 7.68L18.32 7.68L17.64 7Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M15.33 10L18 7.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),E.createElement("path",{id:"path",d:"M18.29 13.69L18.29 13.67C18.47 13.46 18.78 13.43 18.99 13.62C19.2 13.8 19.22 14.11 19.04 14.32L19.01 14.33L18.29 13.69ZM14.67 15.68L14.64 15.68C14.44 15.48 14.44 15.17 14.64 14.97C14.84 14.78 15.15 14.78 15.35 14.97L15.35 15L14.67 15.68Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M18.66 14L16.33 16.66L15 15.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),E.createElement("path",{id:"path",d:"M12.66 7.33L5.33 7.33L5.33 10L12.66 10L12.66 7.33Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M5.33 7.33L5.33 10L12.66 10L12.66 7.33L5.33 7.33Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}),E.createElement("path",{id:"path",d:"M12.66 14L5.33 14L5.33 16.66L12.66 16.66L12.66 14Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M5.33 14L5.33 16.66L12.66 16.66L12.66 14L5.33 14Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}))),xi=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);return n.type="manualCheckNodeState",n.text="人工检查",n.pointerEvents="auto",n.componentName="manualCheckComponent",n.flowMeta.triggerMode="manual",n.getHeaderIcon=()=>r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(bi,{})}),n};function ji(){return r.jsx(r.Fragment,{children:r.jsx(v.Empty,{image:v.Empty.PRESENTED_IMAGE_DEFAULT})})}const{Panel:cr}=v.Collapse;function Ci(){const e=ue(),a=re(),t=te(),o=ue().graph.configs.find(c=>c.node==="manualCheckNodeState"),i=t.inputParams.find(c=>c.name==="formName").value,s=t.outputParams,[l,n]=L.useState([]);L.useEffect(()=>{Te.get(o.urls.runtimeFormUrl,{},c=>n(c.data.map(f=>{var g;return{label:f.name,value:`${((g=f.appearance[0])==null?void 0:g.name)||""}|${f.id}`}})))},[]);const d=()=>i&&i.length>0?e.graph.plugins[i]().getReactComponents():r.jsx(ji,{}),u=c=>{let f="",g="",y="";if(c&&c.length>0){const[h,b]=c.split("|");g=h+"Component",y=b;try{f=e.graph.plugins[g]().getJadeConfig()}catch(x){console.error("Error getting JadeConfig:",x)}}a({actionType:"changeFormAndSetOutput",formName:g,formId:y,formOutput:f})},m=()=>!s||!Array.isArray(s)||!s.length>0?null:r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["manualCheckOutputPanel"],children:r.jsx(cr,{header:r.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:r.jsx("span",{className:"jade-panel-header-font",children:"输出"})}),className:"jade-panel",children:r.jsx(Ge,{data:s})},"manualCheckOutputPanel")});return r.jsxs("div",{children:[r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["manualCheckFormPanel"],children:r.jsx(cr,{header:r.jsx("div",{className:"panel-header",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:r.jsx("span",{className:"jade-panel-header-font",children:"表单"})}),className:"jade-panel",style:{marginBottom:8,borderRadius:"8px",width:"100%"},children:r.jsx(v.Form,{name:`manualCheckForm-${e.id}`,layout:"vertical",className:"jade-form",children:r.jsxs(v.Form.Item,{children:[r.jsx(de,{allowClear:!0,className:"jade-select",defaultValue:i,style:{width:"100%",marginBottom:"8px"},onChange:c=>u(c),options:l}),d()," "]})})},"manualCheckFormPanel")}),m()]})}const wi=e=>{const a={};return a.getJadeConfig=()=>e||{inputParams:[{id:F(),name:"formName",type:"String",from:"Input",value:""},{id:F(),name:"formId",type:"String",from:"Input",value:""}],outputParams:[]},a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(Ei,{})}),a.reducers=(t,o)=>{function i(){return{...t,inputParams:t.inputParams.map(s=>s.name==="formName"?{...s,value:o.formName}:s.name==="formId"?{...s,value:o.formId}:s),outputParams:o.formOutput}}switch(o.actionType){case"changeFormAndSetOutput":return i();default:throw Error("Unknown action: "+o.type)}},a},Ei=()=>r.jsx(r.Fragment,{children:r.jsx(Ci,{})}),Si=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#6CBFFF",fillOpacity:1}),E.createElement("path",{id:"path",d:"M12 11.02C12 11.11 11.92 11.18 11.83 11.18L9.73 11.18L9.59 11.81L9.57 11.88C9.06 14.13 8.81 15.18 8.57 16.03C8.16 17.5 7.21 18.36 5.83 18.48C5.77 18.49 5.72 18.49 5.66 18.49C5.57 18.5 5.49 18.43 5.49 18.34L5.49 17.03C5.49 16.94 5.56 16.87 5.64 16.87C5.74 16.86 5.82 16.85 5.87 16.84C6.45 16.73 6.8 16.35 7 15.6C7.23 14.78 7.48 13.74 7.98 11.52L8 11.45L8.06 11.18L6.47 11.18C6.38 11.18 6.3 11.11 6.3 11.02L6.3 9.72C6.3 9.63 6.38 9.56 6.47 9.56L8.44 9.56C8.62 8.75 8.74 8.26 8.87 7.74C9.35 5.87 10.99 5.19 13.44 5.62C13.49 5.63 13.55 5.64 13.62 5.65C13.71 5.67 13.77 5.75 13.75 5.84L13.75 5.84L13.49 7.12C13.47 7.21 13.39 7.26 13.3 7.24C13.22 7.23 13.15 7.22 13.08 7.2C11.44 6.93 10.67 7.27 10.45 8.14C10.35 8.56 10.25 8.97 10.11 9.56L11.83 9.56C11.92 9.56 12 9.63 12 9.72L12 11.02ZM18.5 11.02C18.5 11.11 18.43 11.18 18.34 11.18L17.86 11.18L16.35 12.85L17.16 14.43L17.52 14.43C17.61 14.43 17.69 14.51 17.69 14.6L17.69 15.9C17.69 15.99 17.61 16.06 17.52 16.06L16.17 16.06L15.18 14.14L13.45 16.06L12.16 16.06C12.07 16.06 11.99 15.99 11.99 15.9L11.99 14.6C11.99 14.51 12.07 14.44 12.16 14.44L12.73 14.44L14.39 12.6L13.66 11.18L12.97 11.18C12.88 11.18 12.81 11.11 12.81 11.02L12.81 9.72C12.81 9.63 12.88 9.56 12.97 9.56L14.66 9.56L15.56 11.31L17.14 9.56L18.34 9.56C18.43 9.56 18.5 9.63 18.5 9.72L18.5 11.02Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"})),Ni=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);n.type="fitInvokeNodeState",n.width=360,n.backColor="white",n.pointerEvents="auto",n.text="FIT调用",n.componentName="fitInvokeComponent",n.flowMeta.triggerMode="auto",n.flowMeta.jober.type="GENERICABLE_JOBER";const d={genericable:{id:"",params:[]}},u=n.serializerJadeConfig;return n.serializerJadeConfig=()=>{u.apply(n);const m=n.flowMeta.jober.converter.entity.fitable.value.find(c=>c.name==="id").value;m&&(n.flowMeta.jober.fitables=[m]),d.genericable.params=n.flowMeta.jober.converter.entity.inputParams.map(c=>({name:c.name})),d.genericable.id=n.flowMeta.jober.converter.entity.genericable.value.find(c=>c.name==="id").value,n.flowMeta.jober.entity=d},n.getHeaderIcon=()=>r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(Si,{})}),n};function ur(){const e=re(),a=te(),t=a&&a.inputParams,o=(i,s)=>{e({type:"update",id:i,changes:s})};return r.jsx(Jn,{data:t,updateItem:o})}function Ii(){const e=re(),a=ue(),t=a.graph.configs&&a.graph.configs.find(l=>l.node==="fitInvokeState").urls.serviceListEndpoint,o=l=>t+"?pageNum="+l+"&pageSize=10",i=(l,n)=>{e({type:"selectGenericable",value:l})},s=l=>l.map(n=>({value:n,label:n}));return r.jsx(v.Form.Item,{name:`select-genericable-${a.id}`,label:r.jsx("span",{style:{color:"red"}}),rules:[{required:!0,message:"请选择一个服务"}],colon:!1,children:r.jsx(kt,{className:"jade-select-genericable",placeholder:"请选择一个服务",onChange:i,buildUrl:o,disabled:!1,getOptions:s,dealResponse:l=>l.data})})}function Pi(){const e=re(),a=te(),t=ue(),o=a&&a.genericable.value.find(u=>u.name==="id").value,i=t.graph.configs.find(u=>u.node==="fitInvokeState").urls.fitableMetaInfoUrl,s=o==="",l=u=>i+o+"?pageNum="+u+"&pageSize=10",n=(u,m)=>{e({type:"selectFitable",value:m.find(c=>c.name===u)})},d=u=>u.map(m=>({value:m.name,label:m.name}));return r.jsx(v.Form.Item,{name:`select-fitable-${t.id}`,label:r.jsx("span",{style:{color:"red"}}),rules:[{required:!0,message:"请选择一个服务，再选择实现"}],colon:!1,children:r.jsx(kt,{className:"jade-select-tool",placeholder:"请选择一个服务，再选择实现",onChange:n,buildUrl:l,disabled:s,getOptions:d,dealResponse:u=>u.data})})}const{Panel:ki}=v.Collapse;function Oi(){return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["FitInvokeService"],children:r.jsxs(ki,{className:"jade-panel",header:r.jsx("div",{style:{display:"flex",alignItems:"center"},children:r.jsx("span",{className:"title",children:"FIT服务"})}),children:[r.jsx("div",{style:{marginTop:"8px"},children:r.jsx("span",{className:"select-genericable",children:"选择服务"})}),r.jsx(Ii,{}),r.jsx("div",{style:{marginTop:"8px"},children:r.jsx("span",{className:"select-fitable",children:"选择实现"})}),r.jsx(Pi,{})]},"FitInvokeService")})}const{Panel:Ri}=v.Collapse;function dr(){const e=te(),a=e&&e.outputParams;return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["InvokeOutput"],children:r.jsx(Ri,{className:"jade-panel",header:r.jsx("div",{style:{display:"flex",alignItems:"center"},children:r.jsx("span",{className:"jade-panel-header-font",children:"输出"})}),children:r.jsx(Ge,{data:a})},"InvokeOutput")})}const fr=e=>{const a=(o,i)=>{const s=[];if(i.type==="object")for(const l in i.properties){const n=i.properties[l];n.type==="object"?s.push(...a(l,n)):s.push({id:F(),name:l,type:n.type.capitalize(),value:n.type.capitalize()})}return[{id:"output_"+F(),name:o,type:"Object",value:s}]},t={id:"output_"+F(),name:"output",type:"",value:[]};if(e.type==="object"){if(t.type="Object",e.hasOwnProperty("additionalProperties")&&e.additionalProperties.hasOwnProperty("type"))return t;const i=e.properties;for(const s in i){const l=i[s];l.type==="object"?t.value.push(...a(s,l)):t.value.push({id:F(),name:s,type:l.type.capitalize(),value:l.type.capitalize()})}}else t.type=e.type.capitalize();return t},$t=e=>{const a=e.property.hasOwnProperty("additionalProperties")&&e.property.additionalProperties.hasOwnProperty("type"),t={id:e.propertyName+"_"+F(),name:e.propertyName,type:e.property.type==="object"?"Object":e.property.type.capitalize(),from:e.property.type==="object"?a?"Reference":"Expand":"Reference",referenceNode:"",referenceId:"",referenceKey:"",value:[]};if(a&&(t.generic="Map"),e.property.type==="object"&&!a){const o=e.property.properties;t.value=Object.keys(o).map(i=>$t({propertyName:i,property:o[i]})),t.props=[...t.value]}return t},pr=e=>{const a={};return a.getJadeConfig=()=>e||{inputParams:[],outputParams:[]},a.getReactComponents=()=>r.jsxs(r.Fragment,{children:[r.jsx(ur,{}),r.jsx(dr,{})]}),a.reducers=(t,o)=>{const i=(l,n,d)=>l.map(u=>{const m={...u};return u.id===n?(d.forEach(c=>{m[c.key]=c.value,c.value==="Reference"&&(m.value=[])}),m):(m.from==="Expand"&&(m.value=i(m.value,n,d)),m)});let s={...t};switch(o.type){case"update":return s.inputParams=i(t.inputParams,o.id,o.changes),s;default:throw Error("Unknown action: "+o.type)}},a},Ti=e=>{const a=pr(e);a.getJadeConfig=()=>e||{inputParams:[],genericable:{id:"genericable_"+F(),name:"genericable",type:"Object",from:"Expand",value:[{id:F(),name:"id",type:"String",from:"Input",value:""}]},fitable:{id:"fitable_"+F(),name:"fitable",type:"Object",from:"Expand",value:[{id:F(),name:"id",type:"String",from:"Input",value:""}]},outputParams:[]},a.getReactComponents=()=>r.jsxs(r.Fragment,{children:[r.jsx(ur,{}),r.jsx(Oi,{}),r.jsx(dr,{})]});const t=a.reducers;return a.reducers=(o,i)=>{const s=()=>{u.genericable.value.find(m=>m.name==="id").value=i.value,u.fitable.value.find(m=>m.name==="id").value=""},l=()=>{u.fitable.value.find(m=>m.name==="id").value=i.value.schema.parameters.fitableId},n=()=>{const m=i.value,c=fr(m.schema.return);u.outputParams.push(c)},d=()=>{const m=i.value,c=Object.keys(m.schema.parameters.properties).map(f=>$t({propertyName:f,property:m.schema.parameters.properties[f]}));delete u.inputParams,u.inputParams=c};let u={...o};switch(i.type){case"generateInput":return d(),u;case"selectGenericable":return s(),u;case"selectFitable":return l(),d(),n(),u}return t.apply(a,[o,i])},a},Fi=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null,E.createElement("clipPath",{id:"clip4_13318"},E.createElement("rect",{id:"\\u56FE\\u6807/16/API \\u63A5\\u53E3",width:16,height:16,transform:"translate(4.000000 4.000000)",fill:"white",fillOpacity:0}))),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#FA9941",fillOpacity:1}),E.createElement("g",{clipPath:"url(#clip4_13318)"},E.createElement("path",{id:"path",d:"M16.33 11.33L15.33 12.33L11.66 8.66L12.66 7.66C13.16 7.16 14.99 6.33 16.33 7.66C17.66 9 16.83 10.83 16.33 11.33Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M15.33 12.33L11.66 8.66L12.66 7.66C13.16 7.16 14.99 6.33 16.33 7.66C17.66 9 16.83 10.83 16.33 11.33L15.33 12.33Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}),E.createElement("path",{id:"path",d:"M16.68 7.99L16.68 8.02C16.48 8.21 16.17 8.21 15.98 8.02C15.78 7.82 15.78 7.51 15.98 7.31L16 7.31L16.68 7.99ZM17.64 5.67L17.64 5.64C17.84 5.44 18.15 5.44 18.35 5.64C18.55 5.84 18.55 6.15 18.35 6.35L18.32 6.35L17.64 5.67Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M16.33 7.66L18 5.99",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),E.createElement("path",{id:"path",d:"M7.66 12.66L8.66 11.66L12.33 15.33L11.33 16.33C10.83 16.83 9 17.66 7.66 16.33C6.33 15 7.16 13.16 7.66 12.66Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M8.66 11.66L12.33 15.33L11.33 16.33C10.83 16.83 9 17.66 7.66 16.33C6.33 15 7.16 13.16 7.66 12.66L8.66 11.66Z",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round"}),E.createElement("path",{id:"path",d:"M12.01 14.99L12.01 15.02C11.82 15.21 11.51 15.21 11.31 15.02C11.11 14.82 11.11 14.51 11.31 14.31L11.34 14.31L12.01 14.99ZM12.64 13L12.64 12.97C12.84 12.78 13.15 12.78 13.35 12.97C13.55 13.17 13.55 13.48 13.35 13.68L13.32 13.68L12.64 13Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M11.66 14.66L12.99 13.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),E.createElement("path",{id:"path",d:"M6.35 18.32L6.35 18.35C6.15 18.55 5.84 18.55 5.64 18.35C5.44 18.15 5.44 17.84 5.64 17.64L5.67 17.64L6.35 18.32ZM7.31 16L7.31 15.97C7.51 15.78 7.82 15.78 8.02 15.97C8.21 16.17 8.21 16.48 8.02 16.68L7.99 16.68L7.31 16Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M6 18L7.66 16.33",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}),E.createElement("path",{id:"path",d:"M9.68 12.65L9.68 12.68C9.48 12.88 9.17 12.88 8.98 12.68C8.78 12.48 8.78 12.17 8.98 11.97L9 11.97L9.68 12.65ZM10.31 10.67L10.31 10.64C10.51 10.44 10.82 10.44 11.02 10.64C11.21 10.84 11.21 11.15 11.02 11.35L10.99 11.35L10.31 10.67Z",fill:"#000000",fillOpacity:0,fillRule:"nonzero"}),E.createElement("path",{id:"path",d:"M9.33 12.33L10.66 11",stroke:"#FFFFFF",strokeOpacity:1,strokeWidth:1,strokeLinejoin:"round",strokeLinecap:"round"}))),Li=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);n.type="toolInvokeNodeState",n.width=360,n.backColor="white",n.pointerEvents="auto",n.text="工具调用",n.componentName="toolInvokeComponent",n.flowMeta.triggerMode="auto",n.flowMeta.jober.type="STORE_JOBER";const d={uniqueName:"",params:[],return:{type:""}},u={inputParams:[],outputParams:[]},m=n.serializerJadeConfig;return n.serializerJadeConfig=()=>{m.apply(n),n.flowMeta.jober.entity.params=n.flowMeta.jober.converter.entity.inputParams.map(c=>({name:c.name}))},n.processMetaData=c=>{const f=()=>{y.outputParams.push(fr(c.schema.return))},g=()=>{delete y.inputParams,y.inputParams=Object.keys(c.schema.parameters.properties).map(h=>$t({propertyName:h,property:c.schema.parameters.properties[h]}))},y={...u};g(),f(),n.flowMeta.jober.converter.entity=y,n.flowMeta.jober.entity=d,n.flowMeta.jober.entity.uniqueName=c.uniqueName,n.flowMeta.jober.entity.return.type=c.schema.return.type,n.drawer.unmountReact(),n.invalidateAlone()},n.getHeaderIcon=()=>r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(Fi,{})}),n},Mi=e=>E.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",...e},E.createElement("desc",null,`
			Created with Pixso.
	`),E.createElement("defs",null),E.createElement("rect",{id:"\\u753B\\u677F 856",rx:4,width:24,height:24,fill:"#F3689A",fillOpacity:1}),E.createElement("path",{id:"if",d:"M17.34 9.15L14.45 9.15L14.5 8.77C14.56 8.26 14.7 7.89 14.92 7.65C15.15 7.41 15.51 7.29 16 7.29C16.11 7.29 16.43 7.3 16.97 7.33L17.52 7.36L17.79 5.58Q16.79 5.5 16.03 5.5Q14.47 5.5 13.61 6.27Q12.79 7.01 12.61 8.46L12.52 9.15L10.58 9.15L10.36 10.95L12.31 10.95L11.38 18.5L13.31 18.5L14.24 10.95L17.12 10.95L17.34 9.15ZM7.61 5.88L7.36 7.9L9.55 7.9L9.81 5.88L7.61 5.88ZM6.2 18.5L8.13 18.5L9.29 9.15L7.36 9.15L6.2 18.5Z",fill:"#FFFFFF",fillOpacity:1,fillRule:"evenodd"})),_i=(e,a,t,o,i,s,l)=>{const n=pe(e,a,t,o,i,s,l);n.type="conditionNodeCondition",n.text="条件",n.width=600,n.pointerEvents="auto",n.componentName="conditionComponent",delete n.flowMeta.jober;const d=n.initConnectors;return n.initConnectors=()=>{d.apply(n),n.connectors.remove(u=>u.direction.key===ne.DIRECTION.E.key)},n.getComponent=()=>n.graph.plugins[n.componentName](n.flowMeta.conditionParams),n.serializerJadeConfig=()=>{n.flowMeta.conditionParams=n.getLatestJadeConfig()},n.getHeaderIcon=()=>r.jsx(v.Button,{disabled:!0,className:"jade-node-custom-header-icon",children:r.jsx(Mi,{})}),n},{Panel:Ai}=v.Collapse;function Bi({branch:e,name:a,index:t,totalItemNum:o,deleteBranch:i,changeConditionRelation:s,addCondition:l,deleteCondition:n,changeConditionConfig:d}){const u=_e(),m=["is empty","is not empty","is true","is false"],c=()=>{i(e.id)},f=I=>{n(e.id,I)},g=I=>{s(e.id,I)},y=(I,T)=>{u.setFieldsValue({[`condition-${I}`]:T}),d(e.id,I,[{key:"condition",value:T}])},h=(I,T,_,$)=>{d(e.id,I,[{key:T,value:[{key:"referenceKey",value:_},{key:"type",value:$}]}])},b=(I,T,_)=>{d(e.id,I,[{key:T,value:[{key:"referenceNode",value:_.referenceNode},{key:"referenceId",value:_.referenceId},{key:"value",value:_.value}]}])},x=(I,T,_)=>{d(e.id,I,[{key:T,value:_}])},j=I=>{switch(I){case"String":return[{value:"equal",label:"equal"},{value:"not equal",label:"not equal"},{value:"is empty",label:"is empty"},{value:"is not empty",label:"is not empty"}];case"Boolean":return[{value:"equal",label:"equal"},{value:"not equal",label:"not equal"},{value:"is empty",label:"is empty"},{value:"is not empty",label:"is not empty"},{value:"is true",label:"is true"},{value:"is false",label:"is false"}];case"Integer":case"Number":return[{value:"equal",label:"equal"},{value:"not equal",label:"not equal"},{value:"is empty",label:"is empty"},{value:"is not empty",label:"is not empty"},{value:"greater than",label:"greater than"},{value:"greater than or equal",label:"greater than or equal"},{value:"less than",label:"less than"},{value:"less than or equal",label:"less than or equal"}];case"Array<String>":case"Array<Integer>":case"Array<Boolean>":case"Array<Number>":return[{value:"is empty",label:"is empty"},{value:"is not empty",label:"is not empty"}];default:return[]}},N=()=>o>2?r.jsx("div",{className:"priority-tag",children:r.jsxs("div",{className:"priority-inner-text jade-font-size",children:["Priority ",t+1]})}):null,R=()=>o>2?r.jsx(v.Button,{type:"text",className:"jade-panel-header-icon-position icon-button",onClick:()=>c(),children:r.jsx(lt,{})}):null,w=()=>r.jsx("div",{className:"condition-left-diagram",children:r.jsx(de,{id:`condition-left-select-${e.id}`,className:"jade-select operation",placement:"bottomLeft",popupClassName:"condition-left-drop",onChange:I=>g(I),options:[{value:"and",label:"And"},{value:"or",label:"Or"}],value:e.conditionRelation})}),ae=(I,T)=>{if(I>0)return r.jsx(v.Form.Item,{children:r.jsx(v.Button,{type:"text",className:"icon-button",style:{height:"100%"},onClick:()=>f(T),children:r.jsx(lt,{})})})},he=(I,T)=>m.includes(I)?[{}]:T||[{required:!0,message:"字段值不能为空"}],Fe=(I,T,_,$)=>{switch(T.from){case"Reference":return r.jsx(r.Fragment,{children:r.jsx(Re,{className:"value-custom jade-select",disabled:m.includes($),rules:he($),reference:T,onReferencedValueChange:(ee,se)=>h(I,T.id,ee,se),onReferencedKeyChange:ee=>b(I,T.id,ee)})});case"Input":switch(_){case"String":case"Array<String>":return r.jsx(v.Form.Item,{id:`value-${T.id}`,name:`value-${T.id}`,rules:he($),initialValue:T.value,children:r.jsx(v.Input,{className:"value-custom jade-input",disabled:m.includes($),value:T.value,onChange:ee=>x(I,T.id,[{key:"value",value:ee.target.value}])})});case"Boolean":case"Array<Boolean>":return r.jsx(v.Form.Item,{id:`value-${T.id}`,name:`value-${T.id}`,initialValue:T.value,rules:he($),style:{marginLeft:"8px"},children:r.jsx(v.Switch,{disabled:m.includes($),onChange:ee=>x(I,T.id,[{key:"value",value:ee}]),value:T.value,defaultChecked:!0})});case"Integer":case"Number":case"Array<Number>":case"Array<Integer>":return r.jsx(v.Form.Item,{id:`value-${T.id}`,name:`value-${T.id}`,rules:he($),initialValue:T.value,children:r.jsx(v.InputNumber,{className:"value-custom jade-input",disabled:m.includes($),step:1,onChange:ee=>x(I,T.id,[{key:"value",value:ee}]),stringMode:!0})});default:return r.jsx(v.Form.Item,{id:`value-${T.id}`,name:`value-${T.id}`,rules:he($,[{required:!0,message:"字段值不能为空"},{pattern:/^[^\s]*$/,message:"禁止输入空格"}]),initialValue:T.value,children:r.jsx(v.Input,{className:"value-custom jade-input",disabled:m.includes($),value:T.value,onChange:ee=>x(I,T.id,[{key:"value",value:ee.target.value}])})})}default:return r.jsx(r.Fragment,{})}},Ie=(I,T,_)=>{const $=I.value.find(se=>se.name==="left");if($.type===_&&$.referenceKey===T)return;h(I.id,I.value.find(se=>se.name==="left").id,T,_),y(I.id,null);const ee=_==="Boolean"?!1:"";I.value.find(se=>se.name==="right").from==="Input"&&(u.setFieldsValue({[`value-${I.value.find(se=>se.name==="right").id}`]:ee}),x(I.id,I.value.find(se=>se.name==="right").id,[{key:"value",value:ee}]))},Le=(I,T)=>{const _=I.value.find($=>$.name==="left").type==="Boolean"?!1:"";u.setFieldsValue({[`value-${I.value.find($=>$.name==="right").id}`]:_}),x(I.id,I.value.find($=>$.name==="right").id,[{key:"from",value:T},{key:"type",value:I.value.find($=>$.name==="left").type},{key:"value",value:_},{key:"referenceNode",value:""},{key:"referenceId",value:""},{key:"referenceKey",value:""}])},Pe=(I,T)=>r.jsxs(v.Row,{gutter:16,style:{marginBottom:"6px",marginRight:0},children:[r.jsx(v.Col,{span:6,children:r.jsx(Re,{className:"jade-select",rules:[{required:!0,message:"字段值不能为空"}],reference:I.value.find(_=>_.name==="left"),onReferencedValueChange:(_,$)=>{Ie(I,_,$)},onReferencedKeyChange:_=>b(I.id,I.value.find($=>$.name==="left").id,_)})}),r.jsx(v.Col,{span:6,children:r.jsx(v.Form.Item,{name:`condition-${I.id}`,rules:[{required:!0,message:"字段值不能为空"}],initialValue:I.condition,children:r.jsx(de,{className:"jade-select",style:{width:"100%"},placeholder:"请选择条件",options:j(I.value.find(_=>_.name==="left").type),value:I.condition,onChange:_=>y(I.id,_)})})}),r.jsx(v.Col,{span:4,style:{paddingRight:0},children:r.jsx(v.Form.Item,{children:r.jsx(de,{id:`from-select-${I.id}`,disabled:m.includes(I.condition),className:"value-source-custom jade-select",style:{width:"100%"},onChange:_=>Le(I,_),options:[{value:"Reference",label:"引用"},{value:"Input",label:"输入"}],value:I.value.find(_=>_.name==="right").from})})}),r.jsxs(v.Col,{span:7,style:{paddingLeft:0},children:[Fe(I.id,I.value.find(_=>_.name==="right"),I.value.find(_=>_.name==="left").type,I.condition)," "]}),r.jsx(v.Col,{span:1,style:{paddingLeft:0},children:ae(T,I.id)})]},"row-"+T),ke=()=>r.jsxs("div",{style:{display:"flex"},children:[e.conditions.length>1&&w(),r.jsxs("div",{className:"jade-form condition-right-component",children:[r.jsxs(v.Row,{gutter:16,children:[r.jsx(v.Col,{span:6,children:r.jsx(v.Form.Item,{children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"变量"})})}),r.jsx(v.Col,{span:6,children:r.jsx(v.Form.Item,{children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"条件"})})}),r.jsx(v.Col,{span:12,children:r.jsx(v.Form.Item,{children:r.jsx("span",{className:"jade-font-size jade-font-color",children:"比较对象"})})})]}),e.conditions.map((I,T)=>Pe(I,T)),r.jsx(v.Row,{gutter:16,style:{marginBottom:"6px",marginRight:0},children:r.jsxs(v.Button,{type:"link",className:"icon-button",onClick:()=>l(e.id),style:{height:"32px",paddingLeft:"8px"},children:[r.jsx(Be,{}),r.jsx("span",{children:"添加条件"})]})})]})]});return r.jsx(v.Collapse,{bordered:!1,className:"jade-collapse-custom-background-color",defaultActiveKey:["ifPanel"],children:r.jsx(Ai,{header:r.jsxs("div",{className:"panel-header",children:[r.jsx("span",{className:"jade-panel-header-font",children:a}),N(),R()]}),className:"jade-panel",children:ke()},"ifPanel")})}const{Panel:$i}=v.Collapse;function Di(){return r.jsx($i,{header:r.jsx("div",{className:"panel-header",children:r.jsx("span",{className:"jade-panel-header-font",children:"Else"})}),className:"jade-panel"},"elsePanel")}const mr=({name:e,children:a})=>{const t=ue(),o=L.useRef();L.useEffect(()=>{const s=()=>{const d=o.current,u=t.drawer.parent,m=d.getBoundingClientRect(),c=u.getBoundingClientRect();return(m.right-c.left)/t.page.scaleX},l=()=>{const d=o.current,u=t.drawer.parent,m=d.getBoundingClientRect(),c=u.getBoundingClientRect();return(m.top-c.top+(m.bottom-m.top)/2)/t.page.scaleY},n=ne.connector(t,s,l,()=>({cursor:"crosshair",key:e,color:"white",ax:"x",vector:1,value:ne.DIRECTION.E}),d=>d.visible,()=>!0,()=>!0,()=>{},()=>!1);return n.type="dynamic",t.activeConnector(n),n.isSolid=!0,n.allowToLink=!1,n.allowFromLink=!0,()=>{t.connectors=t.connectors.filter(d=>d.getDirection().key!==e),i()}},[]);const i=()=>{t.page.shapes.filter(l=>l.fromShape===t.id||l.toShape===t.id).filter(l=>l.definedFromConnector===e).forEach(l=>l.remove())};return r.jsx(r.Fragment,{children:r.jsx("div",{id:"connector-provider-"+t.id,ref:o,children:a})})};function zi(){const e=re(),t=te().branches,o=()=>{e({actionType:"addBranch"})},i=u=>{e({actionType:"deleteBranch",branchId:u})},s=(u,m)=>{e({actionType:"changeConditionRelation",branchId:u,conditionRelation:m})},l=u=>{e({actionType:"addCondition",branchId:u})},n=(u,m)=>{e({actionType:"deleteCondition",branchId:u,conditionId:m})},d=(u,m,c)=>{e({actionType:"changeConditionConfig",branchId:u,conditionId:m,updateParams:c})};return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px",paddingLeft:"8px",paddingRight:"4px"},children:[r.jsx("div",{className:"jade-panel-header-font",children:"条件分支"}),r.jsxs(v.Button,{type:"link",className:"icon-button",onClick:o,style:{height:"32px",marginLeft:"auto"},children:[r.jsx(Be,{}),r.jsx("span",{children:"添加分支"})]})]}),t.map((u,m)=>r.jsx(mr,{name:"dynamic-"+m,children:r.jsx(Bi,{branch:u,index:m,name:m===0?"If":"Else if",totalItemNum:t.length+1,deleteBranch:i,changeConditionRelation:s,addCondition:l,deleteCondition:n,changeConditionConfig:d},u.id)},"dynamic-"+m)),r.jsx(mr,{name:`dynamic-${t.length+1}`,children:r.jsx(Di,{})})]})}const Vi=e=>{const a={};return a.getJadeConfig=()=>e||{branches:[{id:F(),conditionRelation:"and",conditions:[{id:F(),condition:void 0,value:[{id:F(),name:"left",type:"",from:"Reference",value:"",referenceNode:"",referenceId:"",referenceKey:""},{id:F(),name:"right",type:"",from:"Reference",value:"",referenceNode:"",referenceId:"",referenceKey:""}]}]}]},a.getReactComponents=()=>r.jsx(r.Fragment,{children:r.jsx(Ui,{})}),a.reducers=(t,o)=>{const i=()=>new $e(t).updateBranch(o,m=>m.updateCondition(o)),s=()=>new $e(t).deleteBranch(o.branchId),l=()=>new $e(t).updateBranch(o,m=>m.changeConditionRelation(o.conditionRelation)),n=()=>{const m={id:F(),condition:void 0,value:[{id:F(),name:"left",type:"",from:"Reference",value:[],referenceNode:""},{id:F(),name:"right",type:"",from:"Reference",value:[],referenceNode:""}]};return new $e(t).updateBranch(o,c=>c.addCondition(m))},d=()=>new $e(t).updateBranch(o,m=>m.deleteCondition(o.conditionId)),u=()=>new $e(t).addBranch();switch(o.actionType){case"addBranch":return u();case"deleteBranch":return s();case"changeConditionRelation":return l();case"addCondition":return n();case"deleteCondition":return d();case"changeConditionConfig":return i();default:throw Error("Unknown action: "+o.type)}},a};class qi{constructor(a){this.condition={...a}}updateValue(a){this.condition.value=this.condition.value.map(t=>a.key===t.id?{...t,...Object.fromEntries(a.value.map(o=>[o.key,o.value]))}:t)}update(a){return a.forEach(t=>{t.key==="condition"?this.condition[t.key]=t.value:this.updateValue(t)}),this.condition}}class hr{constructor(a){this.branch={...a}}static createNewBranch(){return{id:F(),conditionRelation:"and",conditions:[{id:F(),condition:"",value:[{id:F(),name:"left",type:"",from:"Reference",value:[],referenceNode:""},{id:F(),name:"right",type:"",from:"Reference",value:[],referenceNode:""}]}]}}updateCondition(a){return this.branch.conditions=this.branch.conditions.map(t=>t.id===a.conditionId?new qi(t).update(a.updateParams):t),this.branch}deleteCondition(a){return this.branch.conditions=this.branch.conditions.filter(t=>t.id!==a),this.branch}addCondition(a){return this.branch.conditions.push(a),this.branch}changeConditionRelation(a){return this.branch.conditionRelation=a,this.branch}}class $e{constructor(a){this.data={...a}}updateBranch(a,t){return this.data.branches=this.data.branches.map(o=>o.id===a.branchId?t(new hr(o)):o),this.data}deleteBranch(a){return this.data.branches=this.data.branches.filter(t=>t.id!==a),this.data}addBranch(){const a=hr.createNewBranch();return this.data.branches.push(a),this.data}}const Ui=()=>r.jsx(r.Fragment,{children:r.jsx(zi,{})}),gr=(e,a)=>{const t=ne.defaultGraph(e,a);t.type="jadeFlowGraph",t.pageType="jadeFlowPage",t.enableText=!1,t.flowMeta={exceptionFitables:["com.huawei.fit.jober.aipp.fitable.AippFlowExceptionHandler"]},t.setting.borderColor="#047bfc",t.setting.focusBorderColor="#047bfc",t.setting.mouseInBorderColor="#047bfc";const o=t.serialize;t.serialize=()=>{const l=o.apply(t);return l.flowMeta=t.flowMeta,l};const i=t.initialize;t.initialize=async()=>(t.registerPlugin("jadeFlowPage",Lr),t.registerPlugin("jadeEvent",_r),t.registerPlugin("taskNode",so),t.registerPlugin("endNodeEnd",uo),t.registerPlugin("endComponent",go),t.registerPlugin("retrievalNodeState",wo),t.registerPlugin("retrievalComponent",Eo),t.registerPlugin("listener1Node",So),t.registerPlugin("listener1Component",No),t.registerPlugin("listener2Node",Po),t.registerPlugin("listener2Component",ko),t.registerPlugin("listener3Node",Ro),t.registerPlugin("listener3Component",To),t.registerPlugin("jadeInputTreeNode",Lo),t.registerPlugin("jadeInputTreeComponent",Jo),t.registerPlugin("testNode",Zo),t.registerPlugin("testComponent",Go),t.registerPlugin("replaceComponent",ei),t.registerPlugin("startNodeStart",ri),t.registerPlugin("startComponent",ii),t.registerPlugin("llmNodeState",ci),t.registerPlugin("llmComponent",vi),t.registerPlugin("manualCheckNodeState",xi),t.registerPlugin("manualCheckComponent",wi),t.registerPlugin("fitInvokeNodeState",Ni),t.registerPlugin("toolInvokeNodeState",Li),t.registerPlugin("fitInvokeComponent",Ti),t.registerPlugin("toolInvokeComponent",pr),t.registerPlugin("conditionNodeCondition",_i),t.registerPlugin("conditionComponent",Vi),i.apply(t)),t.registerPlugin=(l,n,d=null)=>{d?t.plugins[`${d}.${l}`]=n:t.plugins[l]=n};const s=t.dirtied;return t.dirtied=(l,n)=>{s.call(t,l,n),t.onChangeCallback&&t.onChangeCallback()},t},vr=e=>{const a={};return a.graph=e,a.want=(t,o)=>{e.activePage.want(t,o)},a.import=t=>a.graph.staticImport(t),a.serialize=()=>(e.activePage.serialize(),e.serialize()),a.getAvailableNodes=()=>[{type:"retrievalNodeState",name:"数据检索"},{type:"llmNodeState",name:"大模型"},{type:"manualCheckNodeState",name:"人工检查"},{type:"fitInvokeNodeState",name:"FIT调用"}],a.createNode=(t,o,i)=>{console.log("call createNode...");const s=e.activePage.calculatePosition(o);e.activePage.createNew(t,s.x,s.y).processMetaData(i)},a.createNodeByPosition=(t,o,i)=>{console.log("call createNodeByPosition..."),e.activePage.createNew(t,o.x,o.y).processMetaData(i)},a.onChange=t=>{e.onChangeCallback=t},a.getNodeConfigs=()=>e.activePage.shapes.filter(t=>t.isTypeof("jadeNode")).map(t=>({[t.id]:t.getLatestJadeConfig()})),a.validate=async()=>{const o=e.activePage.shapes.filter(l=>l.isTypeof("jadeNode")).map(l=>l.validate().catch(n=>n)),s=(await Promise.all(o)).filter(l=>l.errorFields);return s.length>0?Promise.reject(s):Promise.resolve()},a},Wi=(()=>{const e={};return e.new=async(a,t)=>{const o=gr(a,"jadeFlow");o.configs=t,o.collaboration.mute=!0,await o.initialize();const i=o.addPage("newFlowPage"),s=i.createShape("startNodeStart",100,100),l=i.createShape("endNodeEnd",s.x+s.width+200,100),n=i.createNew("jadeEvent",0,0);return i.reset(),n.connect(s.id,"E",l.id,"W"),i.fillScreen(),vr(o)},e.edit=async(a,t,o,i=[])=>{const s=gr(a,"jadeFlow");s.configs=o,s.collaboration.mute=!0;for(let n=0;n<i.length;n++)await s.dynamicImportStatement(i[n]);await s.initialize(),s.deSerialize(t);const l=s.getPageData(0);return await s.edit(0,a,l.id),vr(s)},e})();be.JadeFlow=Wi,Object.defineProperty(be,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=fit-elsa-react.umd.cjs.map
