{
  "id": "51cc0d62b4534560b4fe5e9cea5679b8",
  "type": "jadeFlowGraph",
  "pages": [
    {
      "x": 297.46031746031747,
      "y": 121.01190476190482,
      "id": "elsa-page:tvp1s6",
      "bold": false,
      "mode": "configuration",
      "text": "newFlowPage",
      "type": "jadeFlowPage",
      "dirty": false,
      "index": 0,
      "width": 1600,
      "hAlign": "left",
      "height": 800,
      "isPage": true,
      "italic": false,
      "scaleX": 0.8,
      "scaleY": 0.8,
      "shapes": [
        {
          "x": 189.1071428571429,
          "y": 383,
          "id": "jade2zanyx",
          "pad": 0,
          "bold": false,
          "text": "",
          "type": "jadeEvent",
          "dirty": true,
          "index": -100,
          "textX": 0,
          "textY": 0,
          "width": 86.642857142857,
          "hAlign": "center",
          "height": 50.857142857142776,
          "italic": false,
          "margin": 20,
          "toShape": "jade0pg2ag",
          "endArrow": true,
          "hideText": true,
          "lineMode": {
            "type": "auto_curve"
          },
          "runnable": true,
          "allowLink": false,
          "backColor": "white",
          "container": "elsa-page:tvp1s6",
          "fromShape": "jade6qm5eg",
          "lineWidth": 2,
          "namespace": "flowable",
          "beginArrow": false,
          "borderColor": "#B1B1B7",
          "borderWidth": 1,
          "curvePoint1": {
            "x": 0,
            "y": 0
          },
          "curvePoint2": {
            "x": 0,
            "y": 0
          },
          "brokenPoints": [
            {
              "x": 50,
              "y": 0
            },
            {
              "x": 50,
              "y": 80
            }
          ],
          "endArrowSize": 4,
          "arrowEndPoint": {
            "x": 96,
            "y": 80,
            "direction": {
              "ax": "x",
              "key": "W",
              "color": "whitesmoke",
              "value": "W",
              "cursor": "ew-resize",
              "vector": -1
            }
          },
          "endArrowEmpty": false,
          "beginArrowSize": 4,
          "arrowBeginPoint": {
            "x": 0,
            "y": 0,
            "direction": {
              "ax": "x",
              "key": "E",
              "color": "whitesmoke",
              "value": "E",
              "cursor": "ew-resize",
              "vector": 1
            }
          },
          "beginArrowEmpty": false,
          "definedToConnector": "W",
          "mouseInBorderColor": "#B1B1B7",
          "allowSwitchLineMode": false,
          "definedFromConnector": "E"
        },
        {
          "x": 635.7499999999999,
          "y": 433.8571428571428,
          "id": "jade5c5urs",
          "pad": 0,
          "bold": false,
          "text": "",
          "type": "jadeEvent",
          "dirty": true,
          "index": -99,
          "textX": 0,
          "textY": 0,
          "width": 83.39285714285722,
          "hAlign": "center",
          "height": -12.571428571428555,
          "italic": false,
          "margin": 20,
          "toShape": "jadewdnjbq",
          "endArrow": true,
          "hideText": true,
          "lineMode": {
            "type": "auto_curve"
          },
          "runnable": true,
          "allowLink": false,
          "backColor": "white",
          "container": "elsa-page:tvp1s6",
          "fromShape": "jade0pg2ag",
          "lineWidth": 2,
          "namespace": "flowable",
          "beginArrow": false,
          "borderColor": "#B1B1B7",
          "borderWidth": 1,
          "curvePoint1": {
            "x": 0,
            "y": 0
          },
          "curvePoint2": {
            "x": 0,
            "y": 0
          },
          "brokenPoints": [
            {
              "x": 50,
              "y": 0
            },
            {
              "x": 50,
              "y": 80
            }
          ],
          "endArrowSize": 4,
          "arrowEndPoint": {
            "x": 96,
            "y": 80,
            "direction": {
              "ax": "x",
              "key": "W",
              "color": "whitesmoke",
              "value": "W",
              "cursor": "ew-resize",
              "vector": -1
            }
          },
          "endArrowEmpty": false,
          "beginArrowSize": 4,
          "arrowBeginPoint": {
            "x": 0,
            "y": 0,
            "direction": {
              "ax": "x",
              "key": "E",
              "color": "whitesmoke",
              "value": "E",
              "cursor": "ew-resize",
              "vector": 1
            }
          },
          "beginArrowEmpty": false,
          "definedToConnector": "W",
          "mouseInBorderColor": "#B1B1B7",
          "allowSwitchLineMode": false,
          "definedFromConnector": "E"
        },
        {
          "x": 1079.142857142857,
          "y": 421.2857142857142,
          "id": "jade1p0cdu",
          "pad": 0,
          "bold": false,
          "text": "",
          "type": "jadeEvent",
          "dirty": true,
          "index": -98,
          "textX": 0,
          "textY": 0,
          "width": 90.32142857142776,
          "hAlign": "center",
          "height": 31.142857142857054,
          "italic": false,
          "margin": 20,
          "toShape": "jadesoux5i",
          "endArrow": true,
          "hideText": true,
          "lineMode": {
            "type": "auto_curve"
          },
          "runnable": true,
          "allowLink": false,
          "backColor": "white",
          "container": "elsa-page:tvp1s6",
          "fromShape": "jadewdnjbq",
          "lineWidth": 2,
          "namespace": "flowable",
          "beginArrow": false,
          "borderColor": "#B1B1B7",
          "borderWidth": 1,
          "curvePoint1": {
            "x": 0,
            "y": 0
          },
          "curvePoint2": {
            "x": 0,
            "y": 0
          },
          "brokenPoints": [
            {
              "x": 50,
              "y": 0
            },
            {
              "x": 50,
              "y": 80
            }
          ],
          "endArrowSize": 4,
          "arrowEndPoint": {
            "x": 96,
            "y": 80,
            "direction": {
              "ax": "x",
              "key": "W",
              "color": "whitesmoke",
              "value": "W",
              "cursor": "ew-resize",
              "vector": -1
            }
          },
          "endArrowEmpty": false,
          "beginArrowSize": 4,
          "arrowBeginPoint": {
            "x": 0,
            "y": 0,
            "direction": {
              "ax": "x",
              "key": "E",
              "color": "whitesmoke",
              "value": "E",
              "cursor": "ew-resize",
              "vector": 1
            }
          },
          "beginArrowEmpty": false,
          "definedToConnector": "W",
          "mouseInBorderColor": "#B1B1B7",
          "allowSwitchLineMode": false,
          "definedFromConnector": "E"
        },
        {
          "x": -170.8928571428571,
          "y": 32.5,
          "id": "jade6qm5eg",
          "pad": 6,
          "bold": false,
          "text": "开始",
          "type": "startNodeStart",
          "dirty": true,
          "index": 103,
          "width": 360,
          "height": 701,
          "italic": false,
          "shadow": "0 2px 4px 0 rgba(0,0,0,.1)",
          "disabled": false,
          "flowMeta": {
            "inputParams": [
              {
                "id": "91138f09-b635-43df-95c6-1fe3d1745829",
                "from": "Expand",
                "name": "input",
                "type": "Object",
                "value": [
                  {
                    "id": "input_ae2ffd6e-2b9e-4e73-9d7f-0e661ec3dbdb",
                    "from": "Input",
                    "name": "Question",
                    "type": "String",
                    "value": "",
                    "description": "这是用户输入的问题。",
                    "disableModifiable": true
                  }
                ],
                "config": [
                  {
                    "allowAdd": true
                  }
                ]
              },
              {
                "id": "4a770dc6-e3c9-475d-84c7-48dacc74a5b6",
                "from": "Expand",
                "name": "memory",
                "type": "Object",
                "value": [
                  {
                    "id": "a7675623-7fc7-468c-8910-e73c70e5e468",
                    "from": "Input",
                    "name": "memorySwitch",
                    "type": "Boolean",
                    "value": true
                  },
                  {
                    "id": "cee9a31b-781c-4835-a616-ceed73be22f2",
                    "from": "Input",
                    "name": "type",
                    "type": "String",
                    "value": "ByConversationTurn"
                  },
                  {
                    "id": "69592622-4291-409d-9d65-9faea83db657",
                    "from": "Input",
                    "name": "value",
                    "type": "Integer",
                    "value": "3"
                  }
                ]
              }
            ],
            "triggerMode": "auto"
          },
          "hideText": true,
          "moveable": true,
          "runnable": true,
          "backColor": "white",
          "container": "elsa-page:tvp1s6",
          "dashWidth": 0,
          "deletable": false,
          "namespace": "flowable",
          "autoHeight": true,
          "emphasized": false,
          "rotateAble": false,
          "borderColor": "rgba(28,31,35,.08)",
          "borderWidth": 1,
          "focusShadow": "0 0 1px rgba(0,0,0,.3),0 4px 14px rgba(0,0,0,.1)",
          "runningTask": 0,
          "triggerMode": "auto",
          "warningTask": 0,
          "cornerRadius": 8,
          "outlineColor": "rgba(74,147,255,0.12)",
          "outlineWidth": 10,
          "completedTask": 0,
          "componentName": "startComponent",
          "focusBackColor": "white",
          "sourcePlatform": "official",
          "enableAnimation": false,
          "mouseInBorderColor": "rgba(28,31,35,.08)"
        },
        {
          "x": 275.7499999999999,
          "y": 192.3571428571428,
          "id": "jade0pg2ag",
          "pad": 6,
          "bold": false,
          "text": "普通检索",
          "type": "retrievalNodeState",
          "dirty": true,
          "index": 104,
          "width": 360,
          "height": 483,
          "italic": false,
          "shadow": "0 2px 4px 0 rgba(0,0,0,.1)",
          "disabled": false,
          "flowMeta": {
            "jober": {
              "name": "",
              "type": "general_jober",
              "fitables": [
                "modelengine.fit.jober.aipp.fitable.NaiveRAGComponent"
              ],
              "converter": {
                "type": "mapping_converter",
                "entity": {
                  "inputParams": [
                    {
                      "id": "query_0ab55575-f21d-4b19-9676-57fcb4b0b783",
                      "from": "Reference",
                      "name": "query",
                      "type": "String",
                      "value": [
                        "Question"
                      ],
                      "referenceId": "input_ae2ffd6e-2b9e-4e73-9d7f-0e661ec3dbdb",
                      "referenceKey": "Question",
                      "referenceNode": "jade6qm5eg"
                    },
                    {
                      "id": "knowledge_01c41edd-a22b-4289-b1cf-8db835833261",
                      "from": "Expand",
                      "name": "knowledge",
                      "type": "Array",
                      "value": [
                        {
                          "id": "55f8e6eb-dab5-435f-94ea-18108eaba982",
                          "from": "Expand",
                          "type": "Object",
                          "value": []
                        }
                      ]
                    },
                    {
                      "id": "maximum_2da115cd-c1ce-485f-ba98-b4c995f3d6ff",
                      "from": "Input",
                      "name": "maximum",
                      "type": "Integer",
                      "value": 3
                    }
                  ],
                  "outputParams": [
                    {
                      "id": "output_cd5cbe89-0d9f-4cf1-9e09-afb325576b84",
                      "from": "Expand",
                      "name": "output",
                      "type": "Object",
                      "value": [
                        {
                          "id": "5c9c6535-c127-445a-862a-966cf1083929",
                          "from": "Input",
                          "name": "retrievalOutput",
                          "type": "String",
                          "value": "String"
                        }
                      ]
                    }
                  ]
                }
              }
            },
            "joberFilter": {
              "type": "MINIMUM_SIZE_FILTER",
              "threshold": 1
            },
            "triggerMode": "auto"
          },
          "hideText": true,
          "moveable": true,
          "runnable": true,
          "backColor": "white",
          "container": "elsa-page:tvp1s6",
          "dashWidth": 0,
          "namespace": "flowable",
          "autoHeight": true,
          "emphasized": false,
          "rotateAble": false,
          "borderColor": "rgba(28,31,35,.08)",
          "borderWidth": 1,
          "focusShadow": "0 0 1px rgba(0,0,0,.3),0 4px 14px rgba(0,0,0,.1)",
          "runningTask": 0,
          "triggerMode": "auto",
          "warningTask": 0,
          "cornerRadius": 8,
          "outlineColor": "rgba(74,147,255,0.12)",
          "outlineWidth": 10,
          "completedTask": 0,
          "componentName": "retrievalComponent",
          "focusBackColor": "white",
          "sourcePlatform": "official",
          "enableAnimation": false,
          "mouseInBorderColor": "rgba(28,31,35,.08)"
        },
        {
          "x": 719.1428571428571,
          "y": -53.21428571428578,
          "id": "jadewdnjbq",
          "pad": 6,
          "bold": false,
          "text": "大模型",
          "type": "llmNodeState",
          "dirty": true,
          "index": 105,
          "width": 360,
          "height": 949,
          "italic": false,
          "shadow": "0 2px 4px 0 rgba(0,0,0,.1)",
          "disabled": false,
          "flowMeta": {
            "jober": {
              "name": "",
              "type": "general_jober",
              "isAsync": "true",
              "fitables": [
                "modelengine.fit.jober.aipp.fitable.LLMComponent"
              ],
              "converter": {
                "type": "mapping_converter",
                "entity": {
                  "inputParams": [
                    {
                      "id": "6c414e75-971e-403a-b2b1-c6850f128cc4",
                      "from": "Input",
                      "name": "model",
                      "type": "String",
                      "value": "Qwen1.5-32B-Chat"
                    },
                    {
                      "id": "db5fdafa-4cbf-44ba-9cca-8a98f1f771f4",
                      "from": "Input",
                      "name": "temperature",
                      "type": "Number",
                      "value": "0.3"
                    },
                    {
                      "id": "88f74d78-4711-4f81-a2e7-74d0034c5e88",
                      "from": "Expand",
                      "name": "prompt",
                      "type": "Object",
                      "value": [
                        {
                          "id": "35a710cf-1b79-4523-b16f-b50878d677fe",
                          "from": "Input",
                          "name": "template",
                          "type": "String",
                          "value": "请按照以下步骤生成您的回复：\n1. 递归地将问题分解为更小的问题。\n2. 对于每个原子问题，从上下文和对话历史记录中选择最相关的信息。\n3. 使用所选信息生成回复草稿。\n4. 删除回复草稿中的重复内容。\n5. 在调整后生成最终答案，以提高准确性和相关性。\n6. 请注意，只需要回复最终答案。\n-------------------------------------\n上下文信息：\n\n{{knowledge}}\n\n问题：{{query}}"
                        },
                        {
                          "id": "38fb27a1-71f4-4fcc-87d5-9d8a880bc04d",
                          "from": "Expand",
                          "name": "variables",
                          "type": "Object",
                          "value": [
                            {
                              "id": "aeba7823-8d14-4750-9723-55265ae71c4e",
                              "from": "Reference",
                              "name": "knowledge",
                              "type": "String",
                              "value": [
                                "output",
                                "retrievalOutput"
                              ],
                              "referenceId": "5c9c6535-c127-445a-862a-966cf1083929",
                              "referenceKey": "retrievalOutput",
                              "referenceNode": "jade0pg2ag"
                            },
                            {
                              "id": "eee66922-4304-4209-89fc-b13ffa101630",
                              "from": "Reference",
                              "name": "query",
                              "type": "String",
                              "value": [
                                "Question"
                              ],
                              "referenceId": "input_ae2ffd6e-2b9e-4e73-9d7f-0e661ec3dbdb",
                              "referenceKey": "Question",
                              "referenceNode": "jade6qm5eg"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "id": "a6865419-867c-4bfb-855c-f5c1876c965a",
                      "from": "Expand",
                      "name": "tools",
                      "type": "Array",
                      "value": []
                    },
                    {
                      "id": "308e2023-a8e9-486e-9784-8680addbb786",
                      "from": "Expand",
                      "name": "workflows",
                      "type": "Array",
                      "value": []
                    },
                    {
                      "id": "68f92923-d5da-42ce-8478-d7ac7d90664e",
                      "from": "Input",
                      "name": "systemPrompt",
                      "type": "String",
                      "value": ""
                    }
                  ],
                  "outputParams": [
                    {
                      "id": "95d84d67-3198-415e-a63c-bc9a2da8d821",
                      "from": "Expand",
                      "name": "output",
                      "type": "Object",
                      "value": [
                        {
                          "id": "272c927a-9e25-48b6-a921-6a8ab20267a4",
                          "from": "Input",
                          "name": "llmOutput",
                          "type": "String",
                          "value": "",
                          "description": ""
                        }
                      ]
                    }
                  ]
                }
              }
            },
            "joberFilter": {
              "type": "MINIMUM_SIZE_FILTER",
              "threshold": 1
            },
            "triggerMode": "auto"
          },
          "hideText": true,
          "moveable": true,
          "runnable": true,
          "backColor": "white",
          "container": "elsa-page:tvp1s6",
          "dashWidth": 0,
          "namespace": "flowable",
          "autoHeight": true,
          "emphasized": false,
          "rotateAble": false,
          "borderColor": "rgba(28,31,35,.08)",
          "borderWidth": 1,
          "focusShadow": "0 0 1px rgba(0,0,0,.3),0 4px 14px rgba(0,0,0,.1)",
          "runningTask": 0,
          "triggerMode": "auto",
          "warningTask": 0,
          "cornerRadius": 8,
          "outlineColor": "rgba(74,147,255,0.12)",
          "outlineWidth": 10,
          "completedTask": 0,
          "componentName": "llmComponent",
          "focusBackColor": "white",
          "sourcePlatform": "official",
          "enableAnimation": false,
          "mouseInBorderColor": "rgba(28,31,35,.08)"
        },
        {
          "x": 1169.4642857142849,
          "y": 306.4285714285713,
          "id": "jadesoux5i",
          "pad": 6,
          "bold": false,
          "text": "结束",
          "type": "endNodeEnd",
          "dirty": true,
          "index": 106,
          "width": 360,
          "height": 292,
          "italic": false,
          "shadow": "0 2px 4px 0 rgba(0,0,0,.1)",
          "disabled": false,
          "flowMeta": {
            "callback": {
              "name": "通知回调",
              "type": "general_callback",
              "fitables": [
                "modelengine.fit.jober.aipp.fitable.AippFlowEndCallback"
              ],
              "converter": {
                "type": "mapping_converter",
                "entity": {
                  "inputParams": [
                    {
                      "id": "ffad80c2-3f60-4d57-93b2-c2362a5dab9c",
                      "from": "Reference",
                      "name": "finalOutput",
                      "type": "String",
                      "value": [
                        "output",
                        "llmOutput"
                      ],
                      "referenceId": "272c927a-9e25-48b6-a921-6a8ab20267a4",
                      "referenceKey": "llmOutput",
                      "referenceNode": "jadewdnjbq"
                    }
                  ],
                  "outputParams": [
                    {}
                  ]
                }
              }
            },
            "triggerMode": "auto"
          },
          "hideText": true,
          "moveable": true,
          "runnable": true,
          "backColor": "white",
          "container": "elsa-page:tvp1s6",
          "dashWidth": 0,
          "deletable": false,
          "namespace": "flowable",
          "autoHeight": true,
          "emphasized": false,
          "rotateAble": false,
          "borderColor": "rgba(28,31,35,.08)",
          "borderWidth": 1,
          "focusShadow": "0 0 1px rgba(0,0,0,.3),0 4px 14px rgba(0,0,0,.1)",
          "runningTask": 0,
          "triggerMode": "auto",
          "warningTask": 0,
          "cornerRadius": 8,
          "outlineColor": "rgba(74,147,255,0.12)",
          "outlineWidth": 10,
          "completedTask": 0,
          "componentName": "endComponent",
          "focusBackColor": "white",
          "sourcePlatform": "official",
          "enableAnimation": false,
          "mouseInBorderColor": "rgba(28,31,35,.08)"
        }
      ],
      "vAlign": "top",
      "itemPad": [
        0,
        0,
        0,
        0
      ],
      "division": -1,
      "dockMode": "none",
      "fontFace": "arial",
      "fontSize": 18,
      "hideText": true,
      "moveable": true,
      "shapesAs": {},
      "backColor": "#fbfbfc",
      "container": "elsa-page:tvp1s6",
      "dockAlign": "top",
      "fontColor": "#ECD0A7",
      "fontStyle": "normal",
      "itemSpace": 5,
      "namespace": "jadeFlow",
      "fontWeight": "bold",
      "itemScroll": {
        "x": 0,
        "y": 0
      },
      "borderColor": "white",
      "focusBackColor": "#fbfbfc"
    }
  ],
  "title": "51cc0d62b4534560b4fe5e9cea5679b8",
  "source": "elsa",
  "tenant": "31f20efc7e0848deab6a6bc10fc3021e",
  "setting": {
    "pad": 10,
    "tag": {},
    "code": "",
    "pDock": "none",
    "hAlign": "center",
    "margin": 25,
    "shadow": "",
    "shared": false,
    "vAlign": "top",
    "itemPad": [
      5,
      5,
      5,
      5
    ],
    "visible": true,
    "autoText": false,
    "dockMode": "none",
    "dragable": true,
    "editable": true,
    "fontFace": "arial",
    "fontSize": 12,
    "infoType": {
      "name": "none",
      "next": "INFORMATION"
    },
    "moveable": true,
    "priority": 0,
    "allowLink": true,
    "autoWidth": false,
    "backAlpha": 0.15,
    "backColor": "whitesmoke",
    "dashWidth": 0,
    "deletable": true,
    "fontColor": "steelblue",
    "fontStyle": "normal",
    "headColor": "steelblue",
    "lineWidth": 2,
    "underline": false,
    "autoHeight": false,
    "emphasized": false,
    "fontWeight": "lighter",
    "itemScroll": {
      "x": 0,
      "y": 0
    },
    "lineHeight": 1.5,
    "resizeable": true,
    "rotateAble": true,
    "scrollLock": {
      "x": false,
      "y": false
    },
    "selectable": true,
    "shadowData": "2px 2px 4px",
    "borderColor": "#047bfc",
    "borderWidth": 1,
    "bulletSpeed": 1,
    "focusMargin": 0,
    "focusShadow": "",
    "globalAlpha": 1,
    "outstanding": false,
    "bulletedList": false,
    "cornerRadius": 4,
    "enableSocial": true,
    "mouseInColor": "orange",
    "numberedList": false,
    "outlineColor": "rgba(74,147,255,0.12)",
    "outlineWidth": 10,
    "rotateDegree": 0,
    "captionhAlign": "center",
    "strikethrough": false,
    "focusBackColor": "whitesmoke",
    "focusFontColor": "darkorange",
    "progressStatus": {
      "name": "NONE",
      "next": "UNKNOWN",
      "color": "gray"
    },
    "showedProgress": false,
    "captionfontFace": "arial black",
    "captionfontSize": 14,
    "enableAnimation": false,
    "progressPercent": 0.65,
    "captionfontColor": "whitesmoke",
    "captionfontStyle": "normal",
    "focusBorderColor": "#047bfc",
    "focusBorderWidth": 1,
    "mouseInBackColor": "whitesmoke",
    "mouseInFontColor": "orange",
    "captionfontWeight": "lighter",
    "captionlineHeight": 1,
    "mouseInBorderColor": "#047bfc"
  },
  "flowMeta": {
    "callback": {
      "name": "通知回调",
      "type": "general_callback",
      "fitables": [
        "modelengine.fit.jober.fitable.FlowInfoCallback"
      ]
    },
    "enableOutputScope": true,
    "exceptionFitables": [
      "modelengine.fit.jober.aipp.fitable.AippFlowExceptionHandler",
      "modelengine.fit.jober.fitable.FlowInfoException"
    ]
  },
  "enableText": false
}